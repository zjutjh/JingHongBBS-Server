(window.webpackJsonp=window.webpackJsonp||[]).push([[28,8,9],{1091:function(t,e,r){"use strict";var n=r(939);r.n(n).a},1174:function(t,e,r){"use strict";r.r(e);r(52),r(28);var n=r(85),o=(r(36),r(722),r(17),r(11),r(39),r(27),r(69),r(9)),c=(r(32),r(8)),l=r(748),head=r(733),d=r.n(head),h=r(869),m=r.n(h),f=r(732),v=r.n(f),_=r(180);function y(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function C(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var w="user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio",$={layout:"custom_layout",name:"Index",mixins:[d.a,v.a,m.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function r(){var n,o,c,l,d,h,m,f,v,y,$,k,j,P,A;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.store,o=t.params,_.a.isSpider||e(null,{}),c={"filter[isSticky]":"yes","filter[isApproved]":1,"filter[isDeleted]":"no","filter[categoryId]":o.id,"page[number]":1,include:"firstPost"},l={include:w,"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[categoryId]":o.id,"page[number]":1,"page[limit]":10},d={include:"groups",limit:4},r.prev=5,h={},r.next=9,n.dispatch("jv/get",["threads",{params:c}]);case 9:return m=r.sent,r.next=12,n.dispatch("jv/get",["threads",{params:l}]);case 12:return f=r.sent,r.next=15,n.dispatch("jv/get",["categories",{}]);case 15:return v=r.sent,r.next=18,n.dispatch("jv/get",["users/recommended",{params:d}]);case 18:y=r.sent,Array.isArray(m)?h.threadsStickyData=m:m&&m._jv&&m._jv.json&&(($=m._jv.json.data||[]).forEach((function(t,e){$[e]=C(C(C({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,jv:{id:t.id}})})),h.threadsStickyData=$),Array.isArray(f)?(h.threadsData=f,f.forEach((function(t){t.id=t._jv&&t._jv.id}))):f&&f._jv&&f._jv.json&&((k=f._jv.json.data||[]).forEach((function(t,e){k[e]=C(C(C({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),h.threadsData=k),Array.isArray(v)?(h.categoryData=v,(j=v.find((function(t){return t._jv&&t._jv.id===o.id})))&&(h.title=j.name||"分类")):v&&v._jv&&v._jv.json&&((P=v._jv.json.data||[]).forEach((function(t,e){P[e]=C(C(C({},t),t.attributes),{},{_jv:{id:t.id}}),t.id===o.id&&(h.title=t.attributes.name||"分类")})),h.categoryData=P),Array.isArray(y)?h.recommendUserData=y:y&&y._jv&&y._jv.json&&((A=y._jv.json.data||[]).forEach((function(t,e){A[e]=C(C({},t),t.attributes)})),h.recommendUserData=A),e(null,h),r.next=29;break;case 26:r.prev=26,r.t0=r.catch(5),e(null,{_error__abc:{error_keys:Object.keys(r.t0),error:String(r.t0),errno:r.t0.errno,code:r.t0.code,syscall:r.t0.syscall,address:r.t0.address,port:r.t0.port,config:r.t0.config,request_domain:(r.t0.request||{}).domain,request_keys:Object.keys(r.t0.request||{}),response_keys:Object.keys(r.t0.response||{})}});case 29:case"end":return r.stop()}}),r,null,[[5,26]])})))()},data:function(){return{isSpider:_.a.isSpider,loading:!1,threadsStickyData:[],threadsData:[],categoryData:[],recommendUserData:[],pageNum:1,pageSize:10,categoryId:0,threadType:"",sort:"",threadEssence:"",fromUserId:"",hasMore:!1,timer:null,threadCount:0,total:0,currentAudioId:"",showVideoPop:!1,threadVideo:{},threadIdSet:new Set}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")},forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this;this.$route.params.id&&(this.categoryId=this.$route.params.id,this.getCategoryList()),0===this.threadsStickyData.length&&this.getThreadsSticky(),0===this.threadsData.length?this.getThreadsList():(this.threadsData.length===this.pageSize&&(this.hasMore=!0),this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){t.autoLoadThreads()}),3e4))},destroyed:function(){clearInterval(this.timer)},methods:{getThreadsSticky:function(){var t=this;this.threadsStickyData=[];var e={"filter[isSticky]":"yes","filter[isApproved]":1,"filter[isDeleted]":"no","filter[categoryId]":this.categoryId,include:["firstPost"]};this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(data){t.threadsStickyData=Object(n.a)(data)}))},getThreadsList:function(){var t=this;this.loading=!0;var e={include:w,"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[categoryId]":this.categoryId,"filter[type]":this.threadType,"filter[isEssence]":this.threadEssence,"filter[fromUserId]":this.fromUserId,sort:this.sort,"page[number]":this.pageNum,"page[limit]":this.pageSize};null!==this.threadType&&(e["filter[type]"]=this.threadType),this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(data){t.handleThreadList(data,"threadsData"),t.timer&&clearInterval(t.timer),t.timer=setInterval((function(){t.autoLoadThreads()}),3e4)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},getCategoryList:function(){var t=this;this.$store.dispatch("jv/get",["categories",{}]).then((function(e){var r=Object(n.a)(e)||[];t.categoryData=r;var o=r.find((function(e){return e._jv&&+e._jv.id==+t.categoryId}));o&&(t.title=o.name)}),(function(e){t.handleError(e)}))},loadMore:function(){this.getThreadsList()},autoLoadThreads:function(){var t=this,e={"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[categoryId]":this.categoryId,"filter[type]":this.threadType,"filter[isEssence]":this.threadEssence,"filter[fromUserId]":this.fromUserId,"page[limit]":1};this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(data){if(data&&data._jv){var e=data._jv.json&&data._jv.json.meta&&data._jv.json.meta.threadCount||0;t.threadCount>0&&(t.total=e-t.threadCount>0?e-t.threadCount:0)}}))},reloadThreadsList:function(){this.pageNum=1,this.total=0,this.threadsData=[],this.getThreadsList()},onChangeCategory:function(t){0!==t?this.$router.push("/category/".concat(t)):this.$router.push("/")},onChangeFilter:function(t){this.threadEssence="",this.fromUserId="","isEssence"===t?this.threadEssence="yes":"followed"===t&&(this.fromUserId=this.userId),this.reloadThreadsList()},onChangeType:function(t){this.threadType=t,this.reloadThreadsList()},onChangeSort:function(t){this.sort=t,this.reloadThreadsList()},formatRichText:function(html){return l.a.parse(html)},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)]&&this.$refs["audio".concat(this.currentAudioId)].pause(),this.currentAudioId=t},showVideoFn:function(video){this.threadVideo=video,this.showVideoPop=!0}}},k=(r(1091),r(12)),component=Object(k.a)($,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("main",{staticClass:"cont-left"},[r("index-filter",{on:{onChangeFilter:t.onChangeFilter,onChangeType:t.onChangeType,onChangeSort:t.onChangeSort}}),t._v(" "),t.threadsStickyData.length>0?r("div",{staticClass:"list-top"},t._l(t.threadsStickyData,(function(e,n){return r("div",{key:n,staticClass:"list-top-item"},[r("div",{staticClass:"top-label"},[t._v(t._s(t.$t("home.sticky")))]),t._v(" "),r("nuxt-link",{staticClass:"top-title",attrs:{to:"/thread/"+(e._jv&&e._jv.id),target:"_blank"}},[1===e.type?[t._v("\n            "+t._s(e.title)+"\n          ")]:r("div",{domProps:{innerHTML:t._s(t.$xss(t.formatRichText(e.firstPost&&e.firstPost.summary)))}})],2)],1)})),0):t._e(),t._v(" "),t.total>0?r("div",{staticClass:"new-post"},[r("div",{staticClass:"new-post-cont"},[t._v("\n        "+t._s(t.$t("home.hasNewContent",{total:t.total}))+"\n        "),r("span",{staticClass:"refresh",on:{click:t.reloadThreadsList}},[t._v(t._s(t.$t("home.clickRefresh")))])])]):t._e(),t._v(" "),t.isSpider?r("div",{staticClass:"post-list"},[t._l(t.threadsData,(function(e,n){return[4===e.type?r("post-item",{key:n,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e},on:{audioPlay:t.audioPlay}}):r("post-item",{key:n,attrs:{item:e}})]}))],2):r("dynamic-scroller",{attrs:{items:t.threadsData,"min-item-size":120,"page-mode":""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.item,o=e.index,c=e.active;return[r("dynamic-scroller-item",{attrs:{item:n,active:c,"data-index":o}},[4===n.type?r("post-item",{key:o,ref:"audio"+(n&&n.threadAudio&&n.threadAudio._jv&&n.threadAudio._jv.id),attrs:{item:n,lazy:!1},on:{audioPlay:t.audioPlay}}):r("post-item",{key:o,attrs:{item:n,lazy:!1},on:{showVideoFn:t.showVideoFn}})],1)]}},{key:"after",fn:function(){return[r("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.threadsData.length},on:{loadMore:t.loadMore}})]},proxy:!0}])})],1),t._v(" "),r("aside",{staticClass:"cont-right"},[r("div",{staticClass:"category background-color"},[r("category",{attrs:{list:t.categoryData},on:{onChange:t.onChangeCategory}})],1),t._v(" "),r("div",{staticClass:"background-color"},[r("advertising")],1),t._v(" "),r("div",{staticClass:"recommend-user background-color"},[r("recommend-user",{attrs:{list:t.recommendUserData}})],1),t._v(" "),r("copyright",{attrs:{forums:t.forums}})],1),t._v(" "),t.showVideoPop?r("video-pop",{attrs:{"cover-url":t.threadVideo.cover_url,url:t.threadVideo.media_url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e()],1)}),[],!1,null,"3cc1f091",null);e.default=component.exports;installComponents(component,{IndexFilter:r(965).default,PostItem:r(776).default,ListLoadMore:r(772).default,Category:r(860).default,Advertising:r(778).default,RecommendUser:r(817).default,Copyright:r(779).default,VideoPop:r(744).default})},733:function(t,e){t.exports={data:function(){return{title:"‎"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},head:function(){return{title:"‎"!==this.title&&this.forums&&this.forums.set_site&&this.forums.set_site.site_name?"".concat(this.title," - ").concat(this.forums.set_site.site_name):this.title}}}},734:function(t,e,r){},735:function(t,e,r){},736:function(t,e,r){},737:function(t,e,r){"use strict";r.r(e);var n={name:"Cover",mounted:function(){var t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0, 0, 0, .4)",t.style.zIndex="10",t.id="cover",document.querySelector("body").appendChild(t)},destroyed:function(){var t=document.querySelector("#cover");t.parentNode.removeChild(t)},render:function(){return""}},o=r(12),component=Object(o.a)(n,void 0,void 0,!1,null,null,null);e.default=component.exports},738:function(t,e,r){},739:function(t,e,r){},740:function(t,e,r){},741:function(t,e,r){},742:function(t,e,r){"use strict";r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return o})),r.d(e,"a",(function(){return c}));r(177),r(51);var n=function(time){var t=(window.currentTime||new Date)-new Date(time);return parseInt(parseInt(t/1e3,0)/60,0)<60?"".concat(Math.ceil(t/1e3/60)>0?Math.ceil(t/1e3/60):1,"分钟前"):parseInt(parseInt(parseInt(t/1e3,0)/60,0)/60,0)<16?"".concat(Math.ceil(t/1e3/60/60)>0?Math.ceil(t/1e3/60/60):1,"小时前"):time.replace(/T/," ").replace(/Z/,"").substring(0,16)},o=function(t){var e=t-Math.round(new Date/1e3);return parseInt(e/86400,0)},c=function(t){var e=Math.round(new Date(t)/1e3),r=Math.round(new Date/1e3)-e,n=parseInt(r/86400,0);if(n>365){var o=parseInt(r/86400/365,0);return"".concat(o,"年")}return"".concat(n,"天")}},743:function(t,e,r){},744:function(t,e,r){"use strict";r.r(e);var n=r(801),o={name:"VideoPop",props:{url:{type:String,default:""},coverUrl:{type:String,default:""}},data:function(){return{options:{autoplay:!0,controls:!0},player:null}},mounted:function(){document.addEventListener("click",this.removeVideoPop),this.initVideoJs()},methods:{initVideoJs:function(){var t=this;this.player=Object(n.a)("videoPlayer",this.options,(function(){var e=this;n.a.log("Your player is ready!"),this.play(),this.on("error",(function(){e.errorDisplay.close(),e.createModal(t.$t("core.videoError"))}))}))},removeVideoPop:function(t){var e=!0;(t.path||t.composedPath&&t.composedPath()).forEach((function(t){"video-pop"===t.id&&(e=!1),t.classList&&t.classList.contains("svg-icon-video-play")&&(e=!1)})),e&&(this.$emit("remove"),this.player.dispose(),document.removeEventListener("click",this.removeVideoPop))}}},c=(r(749),r(12)),component=Object(c.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video-pop",attrs:{id:"video-pop"}},[e("Cover"),this._v(" "),e("video",{staticClass:"video-js",attrs:{id:"videoPlayer",controls:"",width:"800px",height:"600px",preload:"auto","data-setup":"{}"}},[e("source",{attrs:{src:this.url}}),this._v(" "),e("source",{attrs:{src:this.url,type:"video/webm"}})])],1)}),[],!1,null,"625079a2",null);e.default=component.exports;installComponents(component,{Cover:r(737).default})},745:function(t,e){e.extensionList=["7Z","AI","APK","CAD","CDR","DOC","DOCX","EPS","EXE","IPA","MP3","MP4","PDF","PPT","PSD","RAR","TXT","XLS","XLSX","ZIP","JPG","WAV"]},748:function(t,e,r){"use strict";r(39);var n=r(23),o=(r(37),r(28),r(17),r(11),r(36),r(716),r(177),r(51),r(717)),c=(r(719),r(179),r(718));function l(t,e){l=function(t,e){return new m(t,void 0,e)};var r=Object(c.a)(RegExp),d=RegExp.prototype,h=new WeakMap;function m(t,e,n){var o=r.call(this,t,e);return h.set(o,n||h.get(t)),o}function f(t,e){var g=h.get(e);return Object.keys(g).reduce((function(e,r){return e[r]=t[g[r]],e}),Object.create(null))}return Object(o.a)(m,r),m.prototype.exec=function(t){var e=d.exec.call(this,t);return e&&(e.groups=f(e,this)),e},m.prototype[Symbol.replace]=function(t,e){if("string"==typeof e){var r=h.get(this);return d[Symbol.replace].call(this,t,e.replace(/\$<([^>]+)>/g,(function(t,e){return"$"+r[e]})))}if("function"==typeof e){var o=this;return d[Symbol.replace].call(this,t,(function(){var t=[];return t.push.apply(t,arguments),"object"!==Object(n.a)(t[t.length-1])&&t.push(f(t,o)),e.apply(this,t)}))}return d[Symbol.replace].call(this,t,e)},l.apply(this,arguments)}var d={topic:function(text){if(text){var t=l(/<[s\u017F]pan[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*id="topic"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*value="([0-9A-Z_a-z\u017F\u212A]+)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*>((?:(?!<)[\s\S])+)<\/[s\u017F]pan>/gim,{value:1,string:2});return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){var e="/topic/".concat(t);return'<a href="'.concat(e,'" class="content-topic a-blue">').concat(text,"</a> ")}))}))}},usermention:function(text){if(text){var t=l(/<[s\u017F]pan[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*id="member"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*value="([0-9A-Z_a-z\u017F\u212A]+)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*>((?:(?!<)[\s\S])+)<\/[s\u017F]pan>/gim,{value:1,string:2});return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){var e="/user/".concat(t);return'<a href="'.concat(e,'" class="content-member a-blue">').concat(text,"</a> ")}))}))}},parseHtml1:function(text){if(text){var t=/&lt;/gim;return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){return"<"}))}))}},parseHtml2:function(text){if(text){var t=/&gt;/gim;return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){return">"}))}))}}};e.a={parse:function(text){for(var t in d)text=d[t](text);return text}}},749:function(t,e,r){"use strict";var n=r(734);r.n(n).a},754:function(t,e,r){},755:function(t,e,r){},756:function(t,e,r){"use strict";var n=r(735);r.n(n).a},757:function(t,e,r){"use strict";var n=r(736);r.n(n).a},773:function(t,e,r){"use strict";r.r(e);var n={name:"ProductItem",props:{item:{type:Object,default:function(){}}},data:function(){return{}}},o=(r(756),r(12)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.item?r("a",{staticClass:"product-container",attrs:{href:t.item.detail_content,target:"_blank",el:"nofollow"}},[r("el-image",{staticClass:"image",attrs:{src:t.item.image_path,alt:t.item.title,fit:"cover"}},[r("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[r("i",{staticClass:"el-icon-loading"})])]),t._v(" "),r("div",{staticClass:"info"},[r("div",{staticClass:"info-header"},[r("div",{staticClass:"title"},[t._v(t._s(t.item.title))]),t._v(" "),t.item.price>0?r("div",{staticClass:"price"},[t._v(t._s(t.$t("post.yuanItem")+t.item.price+t.$t("post.yuan")))]):t._e()]),t._v(" "),r("div",{staticClass:"btn"},[r("svg-icon",{staticClass:"icon",attrs:{type:"product-icon"}}),t._v(t._s(t.$t("post.buyProudct")))],1)])],1):t._e()}),[],!1,null,"14d72f28",null);e.default=component.exports;installComponents(component,{SvgIcon:r(60).default})},774:function(t,e,r){"use strict";r.r(e);r(30),r(11);var n={name:"AudioPlayer",props:{file:{type:Object,default:function(){}},currentAudio:{type:Object,default:function(){}}},data:function(){return{onDragging:!1,delta:0}},computed:{currentFile:function(){return this.currentAudio.id===this.file._jv.id},playing:function(){return this.currentAudio.currentTime&&this.currentAudio.duration}},methods:{formatDuration:function(t){var e=Math.floor(t/60),r=(t-60*e).toString().substr(0,2);return"."===r[1]&&(r="0".concat(r[0])),"".concat(e,":").concat(r)},formatCurrentTime:function(t){var e=parseInt(t/60)%60,r=(t%60).toFixed(),n=e<10?"0".concat(e):e,s=r<10?"0".concat(r):r;return"".concat(n,":").concat(s)},convertToPercentage:function(){return this.currentAudio.currentTime/this.currentAudio.duration*100},onmousedown:function(){window.document.addEventListener("mousemove",this.dragging),window.document.addEventListener("mouseup",this.onMouseUp)},dragging:function(t){this.delta=t.clientX-this.$refs.progress.getBoundingClientRect().x,this.delta<0&&(this.delta=0),this.delta>290&&(this.delta=290);var time=this.delta/290*this.currentAudio.duration;this.$emit("seeking",time)},onMouseUp:function(){var time=this.delta/290*this.currentAudio.duration;this.$emit("seek",time),window.document.removeEventListener("mousemove",this.dragging),window.document.removeEventListener("mouseup",this.onMouseUp)}}},o=(r(757),r(12)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"audio"},[t.currentFile&&t.currentAudio.isLoading?r("div",{staticClass:"control"},[r("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"loading",rotate:""}})],1):t.currentFile&&t.currentAudio.isPlay?r("div",{staticClass:"control",on:{click:function(e){return t.$emit("pause")}}},[r("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"audio-pause"}})],1):r("div",{staticClass:"control",on:{click:function(e){return t.$emit("play",t.file)}}},[r("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"audio-play"}})],1),t._v(" "),r("div",{staticClass:"info"},[r("div",{staticClass:"title"},[r("span",{staticClass:"title-audio"},[t._v(t._s(t.file.fileName||t.file.file_name))]),t._v(" "),t.currentFile&&t.playing?r("span",{staticClass:"duration-audio"},[t._v("\n        "+t._s(t.formatCurrentTime(t.currentAudio.currentTime))+" /\n        "+t._s(t.formatDuration(t.currentAudio.duration))+"\n      ")]):r("span",{staticClass:"duration-audio"},[t._v("--:--")])]),t._v(" "),t.currentFile&&t.playing?r("div",{ref:"progress",staticClass:"progress",attrs:{id:"progress"}},[r("div",{staticClass:"progress-item",style:{width:t.convertToPercentage()+"%"}}),t._v(" "),r("div",{staticClass:"control-ball",style:{left:t.convertToPercentage()+"%"},attrs:{id:"control-ball"},on:{mousedown:t.onmousedown}})]):t._e()])])}),[],!1,null,"1e22faf0",null);e.default=component.exports;installComponents(component,{SvgIcon:r(60).default})},776:function(t,e,r){"use strict";r.r(e);r(27),r(11);var n=r(748),time=r(742),o=r(745),c=r(732),l=r.n(c),d=r(178),h=r.n(d),m={name:"PostItem",filters:{formatDate:function(t){return Object(time.b)(t)}},mixins:[l.a,h.a],props:{item:{type:Object,default:function(){}},showShare:{type:Boolean,default:!0},lazy:{type:Boolean,default:!0},infoimage:{type:Boolean,default:!1},canDetail:{type:Boolean,default:!1}},data:function(){return{loading:!1,showVideoPop:!1,isLiked:!1,currentAudio:{id:"",url:"",currentTime:"",duration:"",audio:"",seeking:!1,isPlay:!1,isLoading:!1}}},computed:{unpaid:function(){return!(this.item.paid||0===parseFloat(this.item.price))},forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{item:{handler:function(t){this.isLiked=t.firstPost&&t.firstPost.isLiked,this.likeCount=t.firstPost&&t.firstPost.likeCount},deep:!0,immediate:!0}},mounted:function(){this.currentAudio.audio=document.getElementById("audio-player".concat(this.item&&this.item._jv&&this.item._jv.id))},methods:{handleLike:function(){var t=this;if(this.$store.getters["session/get"]("isLogin")){if(this.loading)return;if(!this.item.firstPost.canLike)return void this.$message.error(this.$t("topic.noThreadLikePermission"));this.loading=!0;var e=!this.isLiked,r={_jv:{type:"posts",id:this.item.firstPost&&this.item.firstPost._jv&&this.item.firstPost._jv.id},isLiked:e};return this.$store.dispatch("jv/patch",r).then((function(){t.$message.success(e?t.$t("discuzq.msgBox.likeSuccess"):t.$t("discuzq.msgBox.cancelLikeSuccess")),e?t.likeCount+=1:t.likeCount-=1,t.isLiked=e,t.$emit("change")}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))}this.$message.warning("请登录"),window.setTimeout((function(){t.headerTologin()}),1e3)},toDetail:function(){this.canViewPostsFn()&&this.routerLink()},onClickImage:function(){this.unpaid&&this.canViewPostsFn()&&this.routerLink()},openVideo:function(){this.canViewPostsFn()&&(this.unpaid?this.routerLink():"/"===this.$route.path||"/site/search"===this.$route.path||"category-id"===this.$route.name?this.$emit("showVideoFn",this.item.threadVideo):this.showVideoPop=!0)},routerLink:function(){window.open("/thread/".concat(this.item._jv&&this.item._jv.id),"_blank")},onClickContent:function(t){var e=t||window.event;"a"!==(e.target||e.srcElement).nodeName.toLocaleLowerCase()&&this.toDetail()},canViewPostsFn:function(){var t=this;return this.item.canViewPosts?!this.canDetail||(this.$message.warning(this.$t("topic.joinAfterView")),!1):(this.$store.getters["session/get"]("isLogin")?this.$message.warning(this.$t("home.noPostingTopic")):(this.$message.warning(this.$t("core.not_authenticated")),window.setTimeout((function(){t.headerTologin()}),1e3)),!1)},formatTopicHTML:function(html){return n.a.parse(html)},extensionValidate:function(t){return o.extensionList.indexOf(t.toUpperCase())>0?t.toUpperCase():"UNKNOWN"},play:function(t){var e=this;this.unpaid?this.routerLink():this.canViewPostsFn()&&this.currentAudio.audio&&(this.currentAudio.id!==t._jv.id&&(this.resetAudio(this.currentAudio.audio),this.currentAudio.url=t.url||t.media_url,this.currentAudio.id=t._jv.id,this.currentAudio.audio.src=this.currentAudio.url,this.currentAudio.isLoading=!0,this.currentAudio.audio.load()),window.setTimeout((function(){e.currentAudio.audio.play(),e.currentAudio.isPlay=!0,e.currentAudio.audio.addEventListener("timeupdate",e.onProgressing),e.currentAudio.audio.addEventListener("ended",e.onEnded),e.$emit("audioPlay",e.currentAudio.id)}),0))},onProgressing:function(){this.currentAudio.seeking||(this.currentAudio.isLoading=!1,this.currentAudio.duration=this.currentAudio.audio.duration,this.currentAudio.currentTime=this.currentAudio.audio.currentTime)},onEnded:function(){this.resetAudio(this.currentAudio.audio)},resetAudio:function(audio){audio&&(audio.removeEventListener("timeupdate",this.onProgressing),audio.removeEventListener("ended",this.onEnded),this.currentAudio.isPlay=!1,this.currentAudio.duration="",this.currentAudio.currentTime="")},pause:function(){this.currentAudio.audio&&(this.currentAudio.isLoading=!1,this.currentAudio.isPlay=!1,this.currentAudio.audio.pause())},seek:function(time){this.currentAudio.audio&&(this.currentAudio.seeking=!1,this.currentAudio.currentTime=time,this.currentAudio.audio.currentTime=time)},seeking:function(time){this.currentAudio.seeking=!0,this.currentAudio.currentTime=time}}},f=(r(788),r(12)),component=Object(f.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"post-container"},[t.item.isEssence?r("div",{staticClass:"essence"},[r("svg-icon",{attrs:{type:"index-essence"}})],1):t._e(),t._v(" "),5===t.item.type&&t.item.question&&1===t.item.question.is_answer&&t.item.question.beUser?r("avatar",{staticClass:"avatar",attrs:{user:{id:t.item.question.beUser.id,username:t.item.question.beUser.username,avatarUrl:t.item.question.beUser.avatarUrl,isReal:t.item.question.beUser.isReal},"prevent-jump":t.canDetail}}):t.item.user?r("avatar",{staticClass:"avatar",attrs:{user:{id:t.item.user.id,username:t.item.user.username,avatarUrl:t.item.user.avatarUrl,isReal:t.item.user.isReal},"prevent-jump":t.canDetail}}):t._e(),t._v(" "),r("div",{staticClass:"main-cont"},[r("div",{staticClass:"top-flex"},[5===t.item.type&&t.item.question&&1===t.item.question.is_answer&&t.item.question.beUser?r("nuxt-link",{staticClass:"user-info",attrs:{to:t.item.user.id>0?"/user/"+t.item.question.beUser.id:""}},[r("span",{staticClass:"user-name"},[t._v(t._s(t.item.question.beUser.username))]),t._v(" "),t.item.question.beUser&&t.item.question.beUser.groups&&t.item.question.beUser.groups.length>0&&t.item.question.beUser.groups[0].isDisplay?r("span",{staticClass:"admin"},[t._v("\n          ("+t._s(t.item.question.beUser.groups[0].name)+")\n        ")]):t._e()]):t.item.user?r("nuxt-link",{staticClass:"user-info",attrs:{to:t.item.user.id>0?"/user/"+t.item.user.id:""}},[r("span",{staticClass:"user-name"},[t._v(t._s(t.item.user.username))]),t._v(" "),t.item.user&&t.item.user.groups&&t.item.user.groups.length>0&&t.item.user.groups[0].isDisplay?r("span",{staticClass:"admin"},[t._v("\n          ("+t._s(t.item.user.groups[0].name)+")\n        ")]):t._e()]):t._e(),t._v(" "),r("div",{staticClass:"time"},[5===t.item.type&&t.item.question&&1===t.item.question.is_answer?r("div",{staticClass:"answered"},[t._v("\n          "+t._s(t.$t("topic.answered"))+"\n        ")]):t._e(),t._v(" "),t.item.createdAt?[t._v(t._s(t.$t("topic.publishAt"))+"\n          "+t._s(t._f("formatDate")(t.item.createdAt)))]:t._e()],2)],1),t._v(" "),5===t.item.type?r("div",[t.item.question&&0===t.item.question.is_answer?[t._v("\n        "+t._s(t.$t("topic.be"))+"\n        "),t.item.question&&t.item.question.beUser?r("nuxt-link",{staticClass:"blue",attrs:{to:t.item.question.beUser.id>0?"/user/"+t.item.question.beUser.id:""}},[t._v("@"+t._s(t.item.question.beUser.username))]):t._e(),t._v("\n        "+t._s(t.$t("topic.question"))+"\n      ")]:t._e(),t._v(" "),t.item.question&&1===t.item.question.is_answer?[t._v("\n        "+t._s(t.$t("topic.answer"))+"\n        "),t.item.user?r("nuxt-link",{staticClass:"blue",attrs:{to:t.item.user.id>0?"/user/"+t.item.user.id:""}},[t._v("@"+t._s(t.item.user.username))]):t._e(),t._v("\n        "+t._s(t.$t("topic.of"))+t._s(t.$t("topic.question"))+"\n      ")]:t._e()],2):t._e(),t._v(" "),t.item.firstPost?[r("div",{staticClass:"first-post",on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},[r("div",{on:{click:t.onClickContent}},[1===t.item.type?r("div",{staticClass:"title"},[t._v("\n            "+t._s(t.$t("home.released"))+"\n            "),r("svg-icon",{directives:[{name:"show",rawName:"v-show",value:parseFloat(t.item.price)>0||parseFloat(t.item.attachmentPrice)>0,expression:"\n                parseFloat(item.price) > 0 ||\n                  parseFloat(item.attachmentPrice) > 0\n              "}],staticClass:"blue",staticStyle:{"font-size":"17px",display:"inline-block","margin-right":"5px"},attrs:{type:"pay-yuan"}}),t._v(" "),r("span",{staticClass:"blue "},[t._v(t._s(t.item.title))])],1):r("div",{staticClass:"content"},[5===t.item.type?r("svg-icon",{staticClass:"icon-pay-yuan blue",attrs:{type:"question-icon"}}):6===t.item.type?r("svg-icon",{staticClass:"icon-pay-yuan blue",attrs:{type:"product-icon"}}):parseFloat(t.item.price)>0||parseFloat(t.item.attachmentPrice)>0?r("svg-icon",{staticClass:"icon-pay-yuan grey",attrs:{type:"pay-yuan"}}):t._e(),t._v(" "),r("div",{class:{"content-block":5===t.item.type||6===t.item.type||parseFloat(t.item.price)>0,blue:5===t.item.type},domProps:{innerHTML:t._s(t.$xss(t.formatTopicHTML(t.item.firstPost.summary)))}})],1)]),t._v(" "),t.item.firstPost.images&&t.item.firstPost.images.length>0?r("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{ url: 'data-source' }"}],staticClass:"images",on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},t._l(t.item.firstPost.images.slice(0,3),(function(image,e){return r("el-image",{key:e,class:{image:!0,infoimage:t.infoimage},attrs:{src:image.thumbUrl,"data-source":t.unpaid?"":image.url,alt:image.filename,fit:"cover",lazy:t.lazy},on:{click:function(e){return e.target!==e.currentTarget?null:t.onClickImage(e)}}},[r("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[r("i",{staticClass:"el-icon-loading"})])])})),1):t._e(),t._v(" "),t.item.firstPost.images&&t.item.firstPost.images.length>3?r("div",{staticClass:"image-count",on:{click:t.toDetail}},[t._v("\n          "+t._s(t.$t("home.total"))+" "+t._s(t.item.firstPost.images.length)+"\n          "+t._s(t.$t("home.seeAllImage"))+"\n        ")]):t._e(),t._v(" "),2===t.item.type&&t.item.threadVideo?r("div",{staticClass:"video-main",on:{click:function(e){return e.stopPropagation(),t.openVideo(e)}}},[t.item.threadVideo.cover_url?r("el-image",{staticClass:"video-img-cover",attrs:{src:t.item.threadVideo.cover_url,alt:t.item.threadVideo.file_name,fit:"cover",lazy:t.lazy}}):r("div",{staticClass:"no-cover"},[t._v(t._s(t.$t("home.noPoster")))]),t._v(" "),r("svg-icon",{staticClass:"video-play",attrs:{type:"video-play"}})],1):t._e(),t._v(" "),t.item.firstPost.attachments&&t.item.firstPost.attachments.length>0?r("div",{staticClass:"attachment",on:{click:t.toDetail}},[r("svg-icon",{attrs:{type:t.extensionValidate(t.item.firstPost.attachments[0].extension)}}),t._v(" "),r("div",{staticClass:"name text-hidden"},[t._v("\n            "+t._s(t.item.firstPost.attachments[0].fileName)+"\n          ")]),t._v(" "),t.item.firstPost.attachments.length>1?r("div",{staticClass:"total"},[t._v("\n            "+t._s(t.$t("home.etc")+t.item.firstPost.attachments.length+t.$t("home.attachmentTotal"))+"\n          ")]):t._e()],1):t._e()]),t._v(" "),6===t.item.type?r("product-item",{attrs:{item:t.item&&t.item.firstPost&&t.item.firstPost.postGoods}}):t._e(),t._v(" "),4===t.item.type?r("div",{on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},[r("audio-player",{attrs:{file:t.item&&t.item.threadAudio,"current-audio":t.currentAudio},on:{play:t.play,pause:t.pause,seek:t.seek,seeking:t.seeking}}),t._v(" "),r("audio",{staticClass:"audio-player",staticStyle:{display:"none"},attrs:{id:"audio-player"+(t.item._jv&&t.item._jv.id),src:t.currentAudio.url}})],1):t._e(),t._v(" "),t.item.location?r("nuxt-link",{staticClass:"location",attrs:{to:"/topic/position?longitude="+t.item.longitude+"&latitude="+t.item.latitude}},[r("span",{staticClass:"flex"},[r("svg-icon",{staticClass:"icon",attrs:{type:"location"}}),t._v("\n          "+t._s(t.item.location)+"\n        ")],1)]):t._e(),t._v(" "),t.canDetail?t._e():r("div",{staticClass:"bottom-handle"},[r("div",{staticClass:"left"},[r("div",{staticClass:"btn like",class:{liked:t.isLiked},on:{click:t.handleLike}},[r("svg-icon",{staticClass:"icon",attrs:{type:"like"},on:{click:t.handleLike}}),t._v("\n            "+t._s(t.isLiked?t.$t("topic.liked"):t.$t("topic.like"))+"\n            "+t._s(t.likeCount>0?t.likeCount:"")+"\n          ")],1),t._v(" "),r("div",{staticClass:"btn comment",on:{click:t.toDetail}},[r("svg-icon",{staticClass:"icon",attrs:{type:"post-comment"}}),t._v("\n            "+t._s(t.$t("topic.comment"))+"\n            "+t._s(t.item.postCount-1>0?t.item.postCount-1:"")+"\n          ")],1),t._v(" "),t.item._jv&&t.item._jv.id&&t.showShare?r("share-popover",{attrs:{"threads-id":t.item._jv.id}},[r("div",{staticClass:"btn share"},[r("svg-icon",{staticClass:"icon",attrs:{type:"link"}}),t._v("\n              "+t._s(t.$t("topic.share"))+"\n            ")],1)]):t._e()],1),t._v(" "),t._t("bottom-right")],2)]:t._e()],2),t._v(" "),t.showVideoPop?r("video-pop",{attrs:{"cover-url":t.item.threadVideo.cover_url,url:t.item.threadVideo.media_url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e()],1)}),[],!1,null,"18ebc636",null);e.default=component.exports;installComponents(component,{SvgIcon:r(60).default,Avatar:r(268).default,ProductItem:r(773).default,AudioPlayer:r(774).default,SharePopover:r(777).default,VideoPop:r(744).default})},777:function(t,e,r){"use strict";r.r(e);r(267);var n=r(775),o={name:"SharePopover",props:{threadsId:{type:[String,Number],default:""},type:{type:String,default:""}},data:function(){return{qrcode:null,currentType:""}},methods:{copyLink:function(){var t=document.createElement("input");"topic"===this.type?t.value=window.location.href:t.value="".concat(window.location.protocol,"//").concat(window.location.host,"/thread/").concat(this.threadsId),t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success("链接复制成功"),setTimeout((function(){t.remove()}),100)},onShowPopover:function(){this.currentType=this.type;var path=window.location.href;path="topic"===this.type?window.location.href:"".concat(window.location.protocol,"//").concat(window.location.host,"/thread/").concat(this.threadsId),this.createQrcode(path)},createQrcode:function(link){var t=this;this.qrcode=null,this.$nextTick((function(){t.qrcode=new n(t.$refs.qrcode,{width:88,height:88,text:link})}))},closeCode:function(){this.$refs.qrcode.innerHTML=""}}},c=(r(780),r(781),r(12)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"share-container"},[r("el-popover",{attrs:{placement:"bottom",width:"120","min-width":"120",trigger:"click","popper-class":"custom-popover-width"},on:{show:t.onShowPopover,hide:t.closeCode}},[r("div",{staticClass:"share-cont"},[r("div",{staticClass:"copy",on:{click:t.copyLink}},[r("svg-icon",{staticClass:"copy-icon",attrs:{type:"copy-link"}}),t._v(" "),r("span",[t._v(t._s(t.$t("core.copyLink")))])],1),t._v(" "),r("div",{staticClass:"qrcode"},[r("div",{staticClass:"qrcode-text"},[r("svg-icon",{staticClass:"wechat-logo",attrs:{type:"wechat-logo"}}),t._v(" "),r("span",[t._v(t._s(t.$t("core.wxShare")))])],1),t._v(" "),r("div",{ref:"qrcode",staticClass:"qrcode-cont"})])]),t._v(" "),r("template",{slot:"reference"},[t._t("default")],2)],2)],1)}),[],!1,null,"020e6bca",null);e.default=component.exports;installComponents(component,{SvgIcon:r(60).default})},778:function(t,e,r){"use strict";r.r(e);var n=r(775),o={name:"Advertising",data:function(){return{qrcode:null,siteName:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{forums:{handler:function(t){t&&t.set_site&&(this.siteName=t.set_site.site_name?t.set_site.site_name:"Discuz! Q")},deep:!0}},mounted:function(){this.siteName=this.forums&&this.forums.set_site&&this.forums.set_site.site_name?this.forums.set_site.site_name:"Discuz! Q",this.createQrcode(window.location.href)},destroyed:function(){this.qrcode=null},methods:{createQrcode:function(link){var t=this;this.qrcode=null,this.$nextTick((function(){t.qrcode=new n(t.$refs.qrcode,{width:70,height:70,text:link})}))}}},c=(r(784),r(12)),component=Object(c.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"adv-container"},[e("div",{ref:"qrcode",staticClass:"qrcode"}),this._v(" "),e("div",{staticClass:"adv-info"},[e("div",{staticClass:"adv-title"},[this._v("扫一扫，访问移动端")]),this._v("\n    "+this._s(this.siteName)+"\n  ")])])}),[],!1,null,"164368aa",null);e.default=component.exports},779:function(t,e,r){"use strict";r.r(e);var n={name:"Copyright",data:function(){return{year:"2019"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=window.currentTime||new Date;this.year=t.getFullYear()}},o=(r(785),r(12)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"copyright"},[r("div",{staticClass:"info"},[r("span",[t._v("Powered By")]),t._v(" "),r("a",{staticClass:"site",attrs:{href:"https://discuz.com",target:"_blank"}},[t._v("Discuz! Q")]),t._v(" "),r("span",{staticClass:"block"},[t._v("© "+t._s(t.year))])]),t._v(" "),t.forums&&t.forums.set_site&&(t.forums.set_site.site_record||t.forums.set_site.site_record_code)?r("div",{staticClass:"id"},[r("div",{staticClass:"site-record-code"},[r("a",{attrs:{href:"https://beian.miit.gov.cn/",target:"_blank"}},[t._v(t._s(t.forums.set_site?t.forums.set_site.site_record:""))])]),t._v(" "),t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code?r("div",{staticClass:"site-record-code"},[r("a",{attrs:{href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=\n        "+(t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code.replace(/[^0-9]/gi,""))+"\n        ",target:"_blank"}},[t._v(t._s(t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code))])]):t._e()]):t._e()])}),[],!1,null,"5a66071e",null);e.default=component.exports},780:function(t,e,r){"use strict";var n=r(738);r.n(n).a},781:function(t,e,r){"use strict";var n=r(739);r.n(n).a},784:function(t,e,r){"use strict";var n=r(740);r.n(n).a},785:function(t,e,r){"use strict";var n=r(741);r.n(n).a},788:function(t,e,r){"use strict";var n=r(743);r.n(n).a},791:function(t,e,r){},792:function(t,e,r){},802:function(t,e){},803:function(t,e,r){"use strict";r.r(e);var n={name:"UserItem",props:{item:{type:Object,default:function(){}},show:{type:String,default:"all"},isFollow:{type:Boolean,default:!1}},data:function(){return{}},methods:{toUser:function(){this.$router.push("/user/".concat(this.item.id))}}},o=(r(812),r(12)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"user-item-container",class:{simple:"simple"===t.show}},[r("div",{staticClass:"flex user-item",on:{click:function(e){return e.stopPropagation(),t.toUser(e)}}},[r("avatar",{attrs:{user:t.item,size:"simple"===t.show?40:45}}),t._v(" "),r("div",{staticClass:"info"},[r("div",{staticClass:"flex"},[r("span",{staticClass:"name text-hidden"},[t._v(t._s(t.item.username))]),t._v(" "),"all"===t.show&&t.item.groupName?r("span",{staticClass:"role"},[t._v(t._s(t.item.groupName))]):t._e()]),t._v(" "),r("div",{staticClass:"flex count"},["all"===t.show?r("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.topic"))+" "+t._s(t.item.threadCount||0))]):t._e(),t._v(" "),"all"===t.show?r("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.following"))+" "+t._s(t.item.followCount||0))]):t._e(),t._v(" "),r("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.followers"))+" "+t._s(t.item.fansCount||0))])])])],1),t._v(" "),t.isFollow?r("el-button",{staticClass:"follow",attrs:{type:"text"}},[t._v("\n    "+t._s(t.$t("profile.following"))+"\n  ")]):t._e()],1)}),[],!1,null,"15aefb24",null);e.default=component.exports;installComponents(component,{Avatar:r(268).default})},812:function(t,e,r){"use strict";var n=r(754);r.n(n).a},814:function(t,e,r){"use strict";var n=r(755);r.n(n).a},817:function(t,e,r){"use strict";r.r(e);r(27),r(11);var n=r(732),o={name:"RecommendUser",mixins:[r.n(n).a],props:{list:{type:Array,default:function(){return[]}}},data:function(){return{userList:[],loading:!1,pageNum:1,pageSize:4}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{list:{handler:function(t){this.userList=t},deep:!0}},mounted:function(){0===this.list.length?this.getList():this.userList=this.list},methods:{getList:function(){var t=this;this.userList=[],this.loading=!0;var e={include:"groups",limit:this.pageSize};this.$store.dispatch("jv/get",["users/recommended",{params:e}]).then((function(e){var data=e;e&&Array.isArray(e)&&data.forEach((function(t,i){data[i].groupName=t.groups[0]?t.groups[0].name:""})),t.userList=data}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},refresh:function(){this.getList()}}},c=(r(814),r(12)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"recommend-user-container"},[r("div",{staticClass:"recommend-user-title"},[t._v(t._s(t.$t("home.recommentUser")))]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"recommend-user-list"},[t._l(t.userList,(function(t,e){return r("user-item",{key:e,attrs:{item:t,show:"simple"}})})),t._v(" "),0===t.userList.length?r("div",{staticClass:"no-more"},[t._v(t._s(t.$t("discuzq.list.noData")))]):t._e()],2),t._v(" "),r("div",{staticClass:"refresh",on:{click:t.refresh}},[r("svg-icon",{staticClass:"icon",attrs:{type:"refresh"}}),t._v("\n    "+t._s(t.$t("home.refresh"))+"\n  ")],1)])}),[],!1,null,"ccf1d846",null);e.default=component.exports;installComponents(component,{UserItem:r(803).default,SvgIcon:r(60).default})},846:function(t,e,r){"use strict";var n=r(791);r.n(n).a},847:function(t,e,r){"use strict";var n=r(792);r.n(n).a},857:function(t,e,r){},859:function(t,e,r){"use strict";r.r(e);var n=r(178),o={name:"CreatePostPopover",mixins:[r.n(n).a],data:function(){return{userId:this.$store.getters["session/get"]("userId"),visible:!1,noCreateThread:!1,can_create_thread:!0,can_create_thread_long:!0,can_create_thread_video:!0,can_create_thread_image:!0,can_create_thread_question:!0,can_create_thread_goods:!0}},computed:{userInfo:function(){return this.$store.getters["jv/get"]("/users/".concat(this.userId))},forums:function(){return this.$store.state.site.info.attributes||{}},categoryId:function(){return this.$route.query.categoryId}},methods:{showAndHidePopover:function(){var t=this;if(this.$store.getters["session/get"]("isLogin")){if(!this.visible){var e=this.forums.other,r=this.userInfo;if(!e)return;if(!(e.can_create_thread||e.can_create_thread_long||e.can_create_thread_video||e.can_create_thread_image||e.can_create_thread_question||e.can_create_thread_goods))return void this.$message.error(this.$t("home.noPostingPermission"));if(e.publish_need_real_name&&!r.realname)return void this.$message.error(this.$t("home.needRealname"));if(e.publish_need_bind_phone&&!r.mobile)return void this.$message.error(this.$t("home.needPhone"));if(!e.can_create_thread_in_category)return void this.$message.error(this.$t("home.noPostingCategory"));if(this.categoryId)this.$store.getters["jv/get"]("categories/".concat(this.categoryId)).canCreateThread||this.$message.error(this.$t("home.noPostingCategory"));e.can_create_thread||(this.can_create_thread=!1),e.can_create_thread_long||(this.can_create_thread_long=!1),e.can_create_thread_video||(this.can_create_thread_video=!1),e.can_create_thread_image||(this.can_create_thread_image=!1),e.can_create_thread_question||(this.can_create_thread_question=!1),e.can_create_thread_goods||(this.can_create_thread_goods=!1)}this.visible=!this.visible}else this.$message.warning("请登录"),window.setTimeout((function(){t.headerTologin()}),1e3)},toRouter:function(t){this.$router.push("/thread/post?type=".concat(t).concat(this.categoryId?"&categoryId=".concat(this.categoryId):""))}}},c=(r(846),r(12)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-popover",{attrs:{placement:"bottom",width:"120","min-width":"120",trigger:"manual","popper-class":"custom-popover-width"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[r("ul",{staticClass:"type-container"},[t.can_create_thread?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(0)}}},[t._v("\n      "+t._s(t.$t("home.word"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_long?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(1)}}},[t._v("\n      "+t._s(t.$t("home.invitation"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_image?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(3)}}},[t._v("\n      "+t._s(t.$t("home.picture"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_video?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(2)}}},[t._v("\n      "+t._s(t.$t("home.video"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_question?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(5)}}},[t._v("\n      "+t._s(t.$t("home.question"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_goods?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(6)}}},[t._v("\n      "+t._s(t.$t("home.product"))+"\n    ")]):t._e()]),t._v(" "),r("template",{slot:"reference"},[t._t("button",[r("el-button",{staticClass:"new-post",attrs:{type:"primary"},on:{click:t.showAndHidePopover}},[r("span",{staticClass:"add-icon"},[t._v("+")]),t._v(t._s(t.$t("profile.post"))+"\n      ")])])],2)],2)}),[],!1,null,"edf11fa4",null);e.default=component.exports},860:function(t,e,r){"use strict";r.r(e);var n=r(85),o=r(732),c={name:"Category",mixins:[r.n(o).a],props:{postLoading:{type:Boolean,default:!1},list:{type:Array,default:function(){return[]}}},data:function(){return{selectId:0,categoryList:[]}},watch:{list:{handler:function(t){var e=0;t.forEach((function(t){e+=t.thread_count})),this.categoryList=[{_jv:{id:0},name:this.$t("topic.whole"),threadCount:e}].concat(Object(n.a)(t))},deep:!0}},mounted:function(){if(0===this.list.length)this.getCategoryList();else{var t=0;this.list.forEach((function(e){t+=e.thread_count})),this.categoryList=[{_jv:{id:0},name:this.$t("topic.whole"),threadCount:t}].concat(Object(n.a)(this.list))}this.$route.params.id&&(this.selectId=this.$route.params.id)},methods:{getCategoryList:function(){var t=this;this.$store.dispatch("jv/get",["categories",{}]).then((function(e){var r=Object(n.a)(e)||[],o=0;r.forEach((function(t){o+=t.thread_count})),t.categoryList=[{_jv:{id:0},name:t.$t("topic.whole"),threadCount:o}].concat(Object(n.a)(r))}),(function(e){t.handleError(e)}))},onChange:function(t){this.postLoading||(this.selectId=t,this.$emit("onChange",t))}}},l=(r(847),r(12)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.categoryList.length>0?r("div",{staticClass:"category-container"},t._l(t.categoryList,(function(e,n){return r("div",{key:n,staticClass:"category-item",class:{active:t.selectId===(e._jv&&e._jv.id),loading:t.postLoading},on:{click:function(r){return t.onChange(e._jv&&e._jv.id)}}},[t.selectId===(e._jv&&e._jv.id)?r("i",{staticClass:"el-icon-arrow-left arrow-icon"}):t._e(),t._v(" "),r("div",{staticClass:"flex"},[r("div",{staticClass:"title"},[t._v(t._s(e.name))]),t._v(" "),r("div",{staticClass:"count"},[t._v(t._s(e.thread_count))])])])})),0):t._e()}),[],!1,null,"1a5276bc",null);e.default=component.exports},869:function(t,e,r){var n=r(715);t.exports={methods:{handleThreadList:function(data,t){if(Array.isArray(data)){this.hasMore=data.length===this.pageSize;var e=data;1===this.pageNum&&this.threadIdSet.clear();for(var i=0;i<e.length;i++)e[i]._jv&&e[i]._jv.id&&(e[i].id=e[i]._jv.id,this.threadIdSet.has(e[i]._jv.id)?(e.splice(i,1),i--):this.threadIdSet.add(e[i]._jv.id));this.threadCount=e&&e._jv&&e._jv.json&&e._jv.json.meta&&e._jv.json.meta.threadCount||0,1===this.pageNum?this[t]=e:this[t]=[].concat(n(this[t]),n(e)),e&&e._jv&&(this.hasMore=this[t].length<this.threadCount),this.pageNum+=1}}}}},939:function(t,e,r){},940:function(t,e,r){"use strict";var n=r(857);r.n(n).a},965:function(t,e,r){"use strict";r.r(e);var n={name:"IndexFilter",data:function(){return{filterQuery:[{label:this.$t("home.all"),value:"",isShow:!0},{label:this.$t("home.essence"),value:"isEssence",isShow:!0},{label:this.$t("home.followed"),value:"followed",isShow:!1}],filterType:[{label:this.$t("home.noLimit"),value:""},{label:this.$t("home.text"),value:0},{label:this.$t("home.invitation"),value:1},{label:this.$t("home.video"),value:2},{label:this.$t("home.picture"),value:3},{label:this.$t("home.voice"),value:4},{label:this.$t("home.question"),value:5},{label:this.$t("home.product"),value:6}],filterSort:[{label:this.$t("home.noLimit"),value:""},{label:this.$t("home.sortCreatedAt"),value:"-createdAt"},{label:this.$t("home.sortUpdatedAt"),value:"-updatedAt"}],query:{filter:"",filterType:"",filterSort:""}}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")}},watch:{userId:function(t){this.filterQuery[2].isShow=t>0}},mounted:function(){this.userId>0?this.filterQuery[2].isShow=!0:this.filterQuery[2].isShow=!1},methods:{onClickFilter:function(t){"followed"!==t||this.userId&&0!=+this.userId?(this.query.filter=t,this.$emit("onChangeFilter",t)):this.$message.error(this.$t("core.not_authenticated"))},handleCommandType:function(t){this.query.filterType=t,this.$emit("onChangeType",t)},handleCommandSort:function(t){this.query.filterSort=t,this.$emit("onChangeSort",t)}}},o=(r(940),r(12)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"index-top-conttainer"},[r("div",{staticClass:"index-filter"},[t._l(t.filterQuery,(function(e,n){return[e.isShow?r("div",{key:n,staticClass:"filter-btn",class:{active:t.query.filter===e.value},on:{click:function(r){return t.onClickFilter(e.value)}}},[t._v("\n        "+t._s(e.label)+"\n      ")]):t._e()]})),t._v(" "),r("el-dropdown",{staticClass:"filter-dropdown",attrs:{placement:"bottom"},on:{command:t.handleCommandType}},[r("span",{staticClass:"el-dropdown-link",class:{active:""!==t.query.filterType}},[t._v("\n        "+t._s(t.$t("home.filterType"))),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.filterType,(function(e,n){return r("el-dropdown-item",{key:n,class:{active:e.value===t.query.filterType},attrs:{command:e.value}},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1)],1),t._v(" "),r("el-dropdown",{staticClass:"filter-dropdown",attrs:{placement:"bottom"},on:{command:t.handleCommandSort}},[r("span",{staticClass:"el-dropdown-link",class:{active:""!==t.query.filterSort}},[t._v("\n        "+t._s(t.$t("core.sort"))),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.filterSort,(function(e,n){return r("el-dropdown-item",{key:n,class:{active:e.value===t.query.filterSort},attrs:{command:e.value}},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1)],1)],2),t._v(" "),r("create-post-popover")],1)}),[],!1,null,"1f03ba6f",null);e.default=component.exports;installComponents(component,{CreatePostPopover:r(859).default})}}]);