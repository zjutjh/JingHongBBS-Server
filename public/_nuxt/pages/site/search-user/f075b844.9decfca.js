(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{1070:function(t,e,r){"use strict";var n=r(910);r.n(n).a},1156:function(t,e,r){"use strict";r.r(e);r(52),r(28),r(17),r(39);var n=r(85),o=(r(27),r(11),r(9)),c=(r(32),r(8)),h=r(732),l=r.n(h),d=r(180),head=r(733),_=r.n(head);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={layout:"custom_layout",name:"SearchUser",mixins:[l.a,_.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function r(){var n,o,c,h;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.store,d.a.isSpider||e(null,{}),r.prev=2,o={},r.next=6,n.dispatch("jv/get",["categories",{}]);case 6:c=r.sent,Array.isArray(c)?o.categoryData=c:c&&c._jv&&c._jv.json&&((h=c._jv.json.data||[]).forEach((function(t,e){h[e]=v(v(v({},t),t.attributes),{},{_jv:{id:t.id}})})),o.categoryData=h),e(null,o),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(2),e(null,{});case 14:case"end":return r.stop()}}),r,null,[[2,11]])})))()},data:function(){return{loading:!1,categoryData:[],pageNum:1,pageSize:10,categoryId:0,value:"",hasMore:!1,userCount:0,userList:[],title:this.$t("search.search")}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{$route:"init"},mounted:function(){this.init()},methods:{init:function(){this.$route.query.categoryId&&(this.categoryId=this.$route.query.categoryId),this.$route.query.value&&(this.value=this.$route.query.value,this.reloadList())},getUserList:function(){var t=this;this.loading=!0;var e={include:"groups",sort:"createdAt","filter[status]":"normal","page[limit]":this.pageSize,"page[number]":this.pageNum,"filter[username]":"*".concat(this.value,"*")};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(e){var data=e;e&&data.forEach((function(t,i){data[i].groupName=t.groups[0]?t.groups[0].name:""})),t.userCount=data._jv.json.meta.total,t.hasMore=data.length===t.pageSize,1===t.pageNum?t.userList=data:t.userList=[].concat(Object(n.a)(t.userList),Object(n.a)(data)),t.pageNum+=1,data._jv&&(t.hasMore=t.userList.length<data._jv.json.meta.total)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.getUserList()},reloadList:function(){this.pageNum=1,this.userList=[],this.getUserList()}}},y=(r(1070),r(12)),component=Object(y.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("main",{staticClass:"cont-left"},[r("div",{staticClass:"search-header"},[r("div",{staticClass:"result-count"},[t._v("\n        "+t._s(t.$t("search.find"))+" "),t.value?r("span",{staticClass:"keyword"},[t._v('"'+t._s(t.value)+'"')]):t._e(),t._v("\n        "+t._s(t.$t("search.searchuserresult"))+" "+t._s(t.userCount)+" "+t._s(t.$t("topic.item"))+"\n      ")]),t._v(" "),r("create-post-popover")],1),t._v(" "),r("div",{staticClass:"user-list"},[r("div",{staticClass:"user-flex"},t._l(t.userList,(function(t,e){return r("user-item",{key:e,attrs:{item:t}})})),1),t._v(" "),r("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.userList.length,"load-more-text":t.$t("topic.showMore")+t.$t("search.users")},on:{loadMore:t.loadMore}})],1)]),t._v(" "),r("aside",{staticClass:"cont-right"},[r("div",{staticClass:"category background-color"},[r("category",{attrs:{list:t.categoryData}})],1),t._v(" "),r("advertising"),t._v(" "),r("copyright",{attrs:{forums:t.forums}})],1)])}),[],!1,null,"eb6de7d6",null);e.default=component.exports;installComponents(component,{CreatePostPopover:r(859).default,UserItem:r(803).default,ListLoadMore:r(772).default,Category:r(860).default,Advertising:r(778).default,Copyright:r(779).default})},733:function(t,e){t.exports={data:function(){return{title:"‎"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},head:function(){return{title:"‎"!==this.title&&this.forums&&this.forums.set_site&&this.forums.set_site.site_name?"".concat(this.title," - ").concat(this.forums.set_site.site_name):this.title}}}},791:function(t,e,r){},792:function(t,e,r){},846:function(t,e,r){"use strict";var n=r(791);r.n(n).a},847:function(t,e,r){"use strict";var n=r(792);r.n(n).a},859:function(t,e,r){"use strict";r.r(e);var n=r(178),o={name:"CreatePostPopover",mixins:[r.n(n).a],data:function(){return{userId:this.$store.getters["session/get"]("userId"),visible:!1,noCreateThread:!1,can_create_thread:!0,can_create_thread_long:!0,can_create_thread_video:!0,can_create_thread_image:!0,can_create_thread_question:!0,can_create_thread_goods:!0}},computed:{userInfo:function(){return this.$store.getters["jv/get"]("/users/".concat(this.userId))},forums:function(){return this.$store.state.site.info.attributes||{}},categoryId:function(){return this.$route.query.categoryId}},methods:{showAndHidePopover:function(){var t=this;if(this.$store.getters["session/get"]("isLogin")){if(!this.visible){var e=this.forums.other,r=this.userInfo;if(!e)return;if(!(e.can_create_thread||e.can_create_thread_long||e.can_create_thread_video||e.can_create_thread_image||e.can_create_thread_question||e.can_create_thread_goods))return void this.$message.error(this.$t("home.noPostingPermission"));if(e.publish_need_real_name&&!r.realname)return void this.$message.error(this.$t("home.needRealname"));if(e.publish_need_bind_phone&&!r.mobile)return void this.$message.error(this.$t("home.needPhone"));if(!e.can_create_thread_in_category)return void this.$message.error(this.$t("home.noPostingCategory"));if(this.categoryId)this.$store.getters["jv/get"]("categories/".concat(this.categoryId)).canCreateThread||this.$message.error(this.$t("home.noPostingCategory"));e.can_create_thread||(this.can_create_thread=!1),e.can_create_thread_long||(this.can_create_thread_long=!1),e.can_create_thread_video||(this.can_create_thread_video=!1),e.can_create_thread_image||(this.can_create_thread_image=!1),e.can_create_thread_question||(this.can_create_thread_question=!1),e.can_create_thread_goods||(this.can_create_thread_goods=!1)}this.visible=!this.visible}else this.$message.warning("请登录"),window.setTimeout((function(){t.headerTologin()}),1e3)},toRouter:function(t){this.$router.push("/thread/post?type=".concat(t).concat(this.categoryId?"&categoryId=".concat(this.categoryId):""))}}},c=(r(846),r(12)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-popover",{attrs:{placement:"bottom",width:"120","min-width":"120",trigger:"manual","popper-class":"custom-popover-width"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[r("ul",{staticClass:"type-container"},[t.can_create_thread?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(0)}}},[t._v("\n      "+t._s(t.$t("home.word"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_long?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(1)}}},[t._v("\n      "+t._s(t.$t("home.invitation"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_image?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(3)}}},[t._v("\n      "+t._s(t.$t("home.picture"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_video?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(2)}}},[t._v("\n      "+t._s(t.$t("home.video"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_question?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(5)}}},[t._v("\n      "+t._s(t.$t("home.question"))+"\n    ")]):t._e(),t._v(" "),t.can_create_thread_goods?r("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(6)}}},[t._v("\n      "+t._s(t.$t("home.product"))+"\n    ")]):t._e()]),t._v(" "),r("template",{slot:"reference"},[t._t("button",[r("el-button",{staticClass:"new-post",attrs:{type:"primary"},on:{click:t.showAndHidePopover}},[r("span",{staticClass:"add-icon"},[t._v("+")]),t._v(t._s(t.$t("profile.post"))+"\n      ")])])],2)],2)}),[],!1,null,"edf11fa4",null);e.default=component.exports},860:function(t,e,r){"use strict";r.r(e);var n=r(85),o=r(732),c={name:"Category",mixins:[r.n(o).a],props:{postLoading:{type:Boolean,default:!1},list:{type:Array,default:function(){return[]}}},data:function(){return{selectId:0,categoryList:[]}},watch:{list:{handler:function(t){var e=0;t.forEach((function(t){e+=t.thread_count})),this.categoryList=[{_jv:{id:0},name:this.$t("topic.whole"),threadCount:e}].concat(Object(n.a)(t))},deep:!0}},mounted:function(){if(0===this.list.length)this.getCategoryList();else{var t=0;this.list.forEach((function(e){t+=e.thread_count})),this.categoryList=[{_jv:{id:0},name:this.$t("topic.whole"),threadCount:t}].concat(Object(n.a)(this.list))}this.$route.params.id&&(this.selectId=this.$route.params.id)},methods:{getCategoryList:function(){var t=this;this.$store.dispatch("jv/get",["categories",{}]).then((function(e){var r=Object(n.a)(e)||[],o=0;r.forEach((function(t){o+=t.thread_count})),t.categoryList=[{_jv:{id:0},name:t.$t("topic.whole"),threadCount:o}].concat(Object(n.a)(r))}),(function(e){t.handleError(e)}))},onChange:function(t){this.postLoading||(this.selectId=t,this.$emit("onChange",t))}}},h=(r(847),r(12)),component=Object(h.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.categoryList.length>0?r("div",{staticClass:"category-container"},t._l(t.categoryList,(function(e,n){return r("div",{key:n,staticClass:"category-item",class:{active:t.selectId===(e._jv&&e._jv.id),loading:t.postLoading},on:{click:function(r){return t.onChange(e._jv&&e._jv.id)}}},[t.selectId===(e._jv&&e._jv.id)?r("i",{staticClass:"el-icon-arrow-left arrow-icon"}):t._e(),t._v(" "),r("div",{staticClass:"flex"},[r("div",{staticClass:"title"},[t._v(t._s(e.name))]),t._v(" "),r("div",{staticClass:"count"},[t._v(t._s(e.thread_count))])])])})),0):t._e()}),[],!1,null,"1a5276bc",null);e.default=component.exports},910:function(t,e,r){}}]);