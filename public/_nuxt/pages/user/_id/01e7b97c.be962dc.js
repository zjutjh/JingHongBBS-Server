(window.webpackJsonp=window.webpackJsonp||[]).push([[51,5,8,9],{1103:function(t,e,n){"use strict";var o=n(952);n.n(o).a},1104:function(t,e,n){"use strict";var o=n(953);n.n(o).a},1105:function(t,e,n){"use strict";var o=n(954);n.n(o).a},1106:function(t,e,n){"use strict";var o=n(955);n.n(o).a},1107:function(t,e,n){"use strict";var o=n(956);n.n(o).a},1108:function(t,e,n){"use strict";var o=n(957);n.n(o).a},1136:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(11),n(5)),l=n(732),c={name:"Topic",mixins:[n.n(l).a],props:{userId:{type:String,default:""},threadData:{type:Array,default:function(){return[]}}},data:function(){return{threadsData:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1,currentAudioId:""}},mounted:function(){this.threadsData=this.threadData,0===this.threadsData.length&&this.loadThreads()},methods:{loadThreads:function(){var t=this;this.loading=!0;var e={"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[type]":"0,1,2,3,4,6",sort:"-createdAt",include:"user,user.groups,firstPost,firstPost.images,firstPost.postGoods,category,threadVideo,threadAudio,question,question.beUser,question.beUser.groups","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[isApproved]":1,"filter[userId]":this.userId};r.status.run((function(){return t.$store.dispatch("jv/get",["threads",{params:e}])})).then((function(e){t.loading=!1,t.hasMore=e.length===t.pageSize,t.threadsData=[].concat(Object(o.a)(t.threadsData),Object(o.a)(e)),e._jv&&(t.hasMore=t.threadsData.length<e._jv.json.meta.threadCount),t.pageNum+=1}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.hasMore&&this.loadThreads()},changelike:function(){this.$emit("changeLike",{userId:this.userId})},changetopiclike:function(){this.pageNum=1,this.threadsData=[],this.loadThreads()},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},d=(n(1104),n(12)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic"},[n("div",{staticClass:"post-list"},[t._l(t.threadsData,(function(e,o){return[4===e.type?n("post-item",{key:o,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e,lazy:!1},on:{change:t.changelike,audioPlay:t.audioPlay}}):n("post-item",{key:o,attrs:{item:e,lazy:!1},on:{change:t.changelike}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.threadsData.length},on:{loadMore:t.loadMore}})],2)])}),[],!1,null,"7b460cda",null);e.default=component.exports;installComponents(component,{PostItem:n(776).default,ListLoadMore:n(772).default})},1137:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(11),n(5)),l=n(732),c={name:"Question",mixins:[n.n(l).a],props:{userId:{type:String,default:""},askthreadData:{type:Array,default:function(){return[]}}},data:function(){return{askthreadsData:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1}},mounted:function(){this.askthreadsData=this.askthreadData,0===this.askthreadsData.length&&this.loadThreads()},methods:{loadThreads:function(){var t=this;this.loading=!0;var e={"filter[isDeleted]":"no",sort:"-createdAt",include:"user,user.groups,firstPost,firstPost.images,firstPost.postGoods,category,threadVideo,threadAudio,question,question.beUser,question.beUser.groups","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[isApproved]":1,"filter[userId]":this.userId,"filter[type]":5,"filter[answer]":"yes"};r.status.run((function(){return t.$store.dispatch("jv/get",["threads",{params:e}])})).then((function(e){t.loading=!1,t.hasMore=e.length===t.pageSize,t.askthreadsData=[].concat(Object(o.a)(t.askthreadsData),Object(o.a)(e)),e._jv&&(t.hasMore=t.askthreadsData.length<e._jv.json.meta.threadCount),t.pageNum+=1}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.hasMore&&this.loadThreads()},changelike:function(){this.$emit("changeLike",{userId:this.userId})},changetopiclike:function(){this.pageNum=1,this.askthreadsData=[],this.loadThreads()}}},d=(n(1105),n(12)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic"},[n("div",{staticClass:"post-list"},[t._l(t.askthreadsData,(function(e,o){return n("post-item",{key:o,attrs:{item:e,lazy:!1},on:{change:t.changelike}})})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.askthreadsData.length},on:{loadMore:t.loadMore}})],2)])}),[],!1,null,"9fc70b0c",null);e.default=component.exports;installComponents(component,{PostItem:n(776).default,ListLoadMore:n(772).default})},1138:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(11),n(5)),l=n(732),c={name:"Like",mixins:[n.n(l).a],props:{userId:{type:String,default:""},likethreadsData:{type:Array,default:function(){return[]}}},data:function(){return{data:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1,editThreadId:"",currentAudioId:""}},mounted:function(){this.data=this.likethreadsData,0===this.data.length&&this.loadlikes()},methods:{loadlikes:function(){var t=this;this.loading=!0;var e={include:"user,user.groups,firstPost,firstPost.images,firstPost.postGoods,category,threadVideo,threadAudio,question","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[isApproved]":1,"filter[user_id]":this.userId};r.status.run((function(){return t.$store.dispatch("jv/get",["threads/likes",{params:e}])})).then((function(e){t.loading=!1,t.hasMore=e.length===t.pageSize;var n=JSON.parse(JSON.stringify(e));t.data=[].concat(Object(o.a)(t.data),Object(o.a)(n)),e._jv&&(t.hasMore=t.data.length<e._jv.json.meta.threadCount),t.pageNum+=1}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.hasMore&&this.loadlikes()},changelike:function(){this.pageNum=1,this.data=[],this.$emit("changeFollow",{userId:this.userId}),this.loadlikes()},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},d=(n(1106),n(12)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"like"},[n("div",{staticClass:"post-list"},[t._l(t.data,(function(e,o){return[4===e.type?n("post-item",{key:o,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e,lazy:!1},on:{change:t.changelike,audioPlay:t.audioPlay}}):n("post-item",{key:o,attrs:{item:e,lazy:!1},on:{change:t.changelike}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.data.length},on:{loadMore:t.loadMore}})],2)])}),[],!1,null,"b0f8bee6",null);e.default=component.exports;installComponents(component,{PostItem:n(776).default,ListLoadMore:n(772).default})},1139:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(11),n(5)),l=n(732),c={name:"Following",mixins:[n.n(l).a],props:{userId:{type:String,default:""}},data:function(){return{value:"",inputVal:"",loadingType:"",followingList:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1,sort:"",options:[{label:this.$t("home.noLimit"),value:""},{label:"用户创建时间",value:"users.createdAt"}]}},mounted:function(){this.getFollowingList()},methods:{getFollowingList:function(t){var e=this;this.loading=!0;var n={include:"toUser,toUser.groups","filter[type]":1,sort:this.sort,"page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[user_id]":this.userId,"filter[username]":"".concat(this.inputVal)};r.status.run((function(){return e.$store.dispatch("jv/get",["follow",{params:n}])})).then((function(n){e.loading=!1,e.hasMore=n.length===e.pageSize,e.followingList="change"===t?n:[].concat(Object(o.a)(e.followingList),Object(o.a)(n)),n._jv&&(e.hasMore=e.followingList.length<n._jv.json.meta.total),e.pageNum+=1}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))},addFollow:function(t,e){var n=this;if(this.$store.getters["session/get"]("isLogin"))if(0===t.follow){var o={_jv:{type:"follow"},type:"user_follow",to_user_id:t.id};this.$store.dispatch("jv/post",o).then((function(t){n.userId===n.currentLoginId&&n.$emit("changeFollow",{userId:n.userId});var o=n.followingList[e],r=JSON.parse(JSON.stringify(o));r.toUser.follow=1===t.is_mutual?2:1,n.$set(n.followingList,e,r)}))}else this.deleteFollow(t,e)},deleteFollow:function(t,e){var n=this;this.$store.getters["session/get"]("isLogin")&&this.$store.dispatch("jv/delete","follow/".concat(t.id,"/1")).then((function(){n.userId===n.currentLoginId&&n.$emit("changeFollow",{userId:n.userId});var t=n.followingList[e],o=JSON.parse(JSON.stringify(t));o.toUser.follow=0,n.$set(n.followingList,e,o)}))},loadMore:function(){this.hasMore&&this.getFollowingList()},toUser:function(t){this.$router.push("/user/".concat(t))},confirm:function(t){this.sort=t,this.pageNum=1,this.followingList=[],this.getFollowingList("change")},onClickSearch:function(){this.pageNum=1,this.getFollowingList("change")}}},d=(n(1107),n(12)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"following"},[n("div",{staticClass:"ftop"},[n("el-select",{staticClass:"fselect",attrs:{placeholder:"排序",size:"small"},on:{change:t.confirm},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("el-input",{staticClass:"h-search",attrs:{size:"small",placeholder:t.$t("manage.pleaseInputUserName")},on:{change:t.onClickSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:t.onClickSearch},slot:"suffix"})])],1),t._v(" "),t._l(t.followingList,(function(e,o){return n("div",{key:o,staticClass:"user-item-container"},[n("div",{staticClass:"flex user-item",on:{click:function(n){return n.stopPropagation(),t.toUser(e.toUser.id)}}},[n("avatar",{attrs:{user:e.toUser,size:45}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"flex"},[n("span",{staticClass:"name text-hidden"},[t._v(t._s(e.toUser.username))]),t._v(" "),e.toUser.groups&&e.toUser.groups[0]&&e.toUser.groups[0].isDisplay?n("span",{staticClass:"role"},[t._v(t._s(e.toUser&&e.toUser.groups&&e.toUser.groups[0]?e.toUser.groups[0].name:""))]):t._e()]),t._v(" "),n("div",{staticClass:"flex count"},[n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.topic"))+" "+t._s(e.toUser.threadCount||0))]),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.following"))+" "+t._s(e.toUser.followCount||0))]),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.followers"))+" "+t._s(e.toUser.fansCount||0))])])])],1),t._v(" "),(e.toUser&&e.toUser.id)!=t.currentLoginId?n("el-button",{staticClass:"follow",attrs:{type:"text"},on:{click:function(n){return t.addFollow(e.toUser,o)}}},[2===e.toUser.follow?n("svg-icon",{staticClass:"follow-icon",attrs:{type:"follow-heart"}}):t._e(),t._v("\n      "+t._s(0==(e.toUser&&e.toUser.follow)?t.$t("profile.following"):1==(e.toUser&&e.toUser.follow)?t.$t("profile.followed"):t.$t("profile.mutualfollow"))+"\n    ")],1):t._e()],1)})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.followingList.length},on:{loadMore:t.loadMore}})],2)}),[],!1,null,"3aa95a5e",null);e.default=component.exports;installComponents(component,{Avatar:n(268).default,SvgIcon:n(60).default,ListLoadMore:n(772).default})},1140:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(11),n(5)),l=n(732),c={name:"Followers",mixins:[n.n(l).a],props:{userId:{type:String,default:""}},data:function(){return{value:"",inputVal:"",loadingType:"",followerList:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1,sort:"",options:[{label:this.$t("home.noLimit"),value:""},{label:"用户创建时间",value:"users.createdAt"}]}},mounted:function(){this.getFollowerList()},methods:{getFollowerList:function(t){var e=this;this.loading=!0;var n={include:["fromUser","fromUser.groups"],"filter[type]":2,sort:this.sort,"page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[user_id]":this.userId,"filter[username]":"".concat(this.inputVal)};r.status.run((function(){return e.$store.dispatch("jv/get",["follow",{params:n}])})).then((function(n){e.loading=!1,e.hasMore=n.length===e.pageSize,e.followerList="change"===t?n:[].concat(Object(o.a)(e.followerList),Object(o.a)(n)),n._jv&&(e.hasMore=e.followerList.length<n._jv.json.meta.total),e.pageNum+=1}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))},addFollow:function(t,e){var n=this;if(this.$store.getters["session/get"]("isLogin"))if(0===t.follow){var o={_jv:{type:"follow"},type:"user_follow",to_user_id:t.id};this.$store.dispatch("jv/post",o).then((function(t){n.userId===n.currentLoginId&&n.$emit("changeFollow",{userId:n.userId});var o=n.followerList[e],r=JSON.parse(JSON.stringify(o));r.fromUser.follow=1===t.is_mutual?2:1,n.$set(n.followerList,e,r)}),(function(t){return n.handleError(t)}))}else this.deleteFollow(t,e)},deleteFollow:function(t,e){var n=this;this.$store.getters["session/get"]("isLogin")&&this.$store.dispatch("jv/delete","follow/".concat(t.id,"/1")).then((function(){n.userId===n.currentLoginId&&n.$emit("changeFollow",{userId:n.userId});var t=n.followerList[e],o=JSON.parse(JSON.stringify(t));o.fromUser.follow=0,n.$set(n.followerList,e,o)}))},loadMore:function(){this.hasMore&&this.getFollowerList()},toUser:function(t){this.$router.push("/user/".concat(t))},confirm:function(t){this.sort=t,this.pageNum=1,this.followerList=[],this.getFollowerList("change")},onClickSearch:function(){this.pageNum=1,this.getFollowerList("change")}}},d=(n(1108),n(12)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"follwers"},[n("div",{staticClass:"ftop"},[n("el-select",{staticClass:"fselect",attrs:{placeholder:"排序",size:"small"},on:{change:t.confirm},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("el-input",{staticClass:"h-search",attrs:{size:"small",placeholder:t.$t("manage.pleaseInputUserName")},on:{change:t.onClickSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:t.onClickSearch},slot:"suffix"})])],1),t._v(" "),t._l(t.followerList,(function(e,o){return n("div",{key:o,staticClass:"user-item-container"},[n("div",{staticClass:"flex user-item",on:{click:function(n){return n.stopPropagation(),t.toUser(e.fromUser.id)}}},[n("avatar",{attrs:{user:e.fromUser,size:45}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"flex"},[n("span",{staticClass:"name text-hidden"},[t._v(t._s(e.fromUser.username))]),t._v(" "),e.fromUser.groups&&e.fromUser.groups[0]&&e.fromUser.groups[0].isDisplay?n("span",{staticClass:"role"},[t._v(t._s(e.fromUser&&e.fromUser.groups&&e.fromUser.groups[0]?e.fromUser.groups[0].name:""))]):t._e()]),t._v(" "),n("div",{staticClass:"flex count"},[n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.topic"))+" "+t._s(e.fromUser.threadCount||0))]),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.following"))+" "+t._s(e.fromUser.followCount||0))]),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.followers"))+" "+t._s(e.fromUser.fansCount||0))])])])],1),t._v(" "),(e.fromUser&&e.fromUser.id)!=t.currentLoginId?n("el-button",{staticClass:"follow",attrs:{type:"text"},on:{click:function(n){return t.addFollow(e.fromUser,o)}}},[2===e.fromUser.follow?n("svg-icon",{staticClass:"follow-icon",attrs:{type:"follow-heart"}}):t._e(),t._v("\n      "+t._s(0==(e.fromUser&&e.fromUser.follow)?t.$t("profile.following"):1==(e.fromUser&&e.fromUser.follow)?t.$t("profile.followed"):t.$t("profile.mutualfollow"))+"\n    ")],1):t._e()],1)})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.followerList.length},on:{loadMore:t.loadMore}})],2)}),[],!1,null,"2f912ad3",null);e.default=component.exports;installComponents(component,{Avatar:n(268).default,SvgIcon:n(60).default,ListLoadMore:n(772).default})},1177:function(t,e,n){"use strict";n.r(e);n(52),n(28),n(267),n(30),n(27);var o=n(9),r=(n(17),n(11),n(39),n(32),n(8)),l=n(5),c=n(732),d=n.n(c),h=n(180);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function m(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v="user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio",_={name:"Index",layout:"custom_layout",mixins:[d.a],asyncData:function(t,e){return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,f,_,y,w,C,$,k,x;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.store,r=t.params,h.a.isSpider||e(null,{}),l={"filter[isDeleted]":"no",sort:"-createdAt",include:v,"page[number]":1,"page[limit]":10,"filter[isApproved]":1,"filter[userId]":r.id},c={include:v,"page[number]":1,"page[limit]":10,"filter[isApproved]":1,"filter[user_id]":r.id},d={include:v,"page[number]":1,"page[limit]":20,"filter[isApproved]":1,"filter[userId]":r.id,"filter[type]":5,"filter[answer]":"yes"},n.prev=5,f={},n.next=9,o.dispatch("jv/get",["threads",{params:l}]);case 9:return _=n.sent,n.next=12,o.dispatch("jv/get",["threads/likes",{params:c}]);case 12:return y=n.sent,n.next=15,o.dispatch("jv/get",["threads",{params:d}]);case 15:return w=n.sent,n.next=18,o.dispatch("jv/get",["users/".concat(r.id),{}]);case 18:C=n.sent,Object.keys(C).length>0&&(f.profilename=C.username),Array.isArray(_)?f.threadsData=_:_&&_._jv&&_._jv.json&&(($=_._jv.json.data||[]).forEach((function(t,e){$[e]=m(m(m({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),f.threadsData=$),Array.isArray(y)?f.likethreadsData=y:y&&y._jv&&y._jv.json&&((k=y._jv.json.data||[]).forEach((function(t,e){k[e]=m(m(m({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),f.likethreadsData=k),Array.isArray(w)?f.askthreadData=w:w&&w._jv&&w._jv.json&&((x=w._jv.json.data||[]).forEach((function(t,e){x[e]=m(m(m({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),f.askthreadData=x),e(null,f),n.next=29;break;case 26:n.prev=26,n.t0=n.catch(5),e(null,{_error__abc:{error_keys:Object.keys(n.t0),error:String(n.t0),errno:n.t0.errno,code:n.t0.code,syscall:n.t0.syscall,address:n.t0.address,port:n.t0.port,config:n.t0.config,request_domain:(n.t0.request||{}).domain,request_keys:Object.keys(n.t0.request||{}),response_keys:Object.keys(n.t0.response||{})}});case 29:case"end":return n.stop()}}),n,null,[[5,26]])})))()},data:function(){return{userId:"",userInfo:"",current:"",activeName:"1",profilename:"‎",can_create_dialog:!1,can_create_thread_question:!1,canBeAsked:!1,headFixed:!1,loading:!1,dialog:{id:"",name:""},chatting:!1,offsetTop:0,isShield:!1,site_name:"",threadsData:[],likethreadsData:[],askthreadData:[],unbundlingArry:[],unbundUserData:[]}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},currentLoginId:function(){return this.$store.getters["session/get"]("userId")}},watch:{$route:function(){this.$router.go(0)},forums:{handler:function(t){t.other&&t.other.can_create_dialog&&(this.can_create_dialog=!0),t.set_site&&t.set_site.site_name&&(this.site_name=t.set_site.site_name),t.other&&t.other.can_create_thread_question&&(this.can_create_thread_question=!0)},deep:!0,immediate:!0}},created:function(){var t=this.$route.query.current;this.userId=this.$route.params.id||"",this.current=t,this.activeName=this.current?this.current:this.activeName},mounted:function(){this.getAuth(),this.getUserInfo(this.userId),window.addEventListener("scroll",this.handleScroll),this.currentLoginId&&this.getShieldData()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},methods:{ask:function(){this.$router.push("/thread/post?type=5&beaskId=".concat(this.userId))},handleScroll:function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;this.headFixed=t>220},changeactive:function(){},getAuth:function(){this.forums.other&&this.forums.other.can_create_dialog?this.can_create_dialog=!0:this.can_create_dialog=!1},getUserInfo:function(t){var e=this;this.loading=!0;var n={include:"groups,dialog"};l.status.run((function(){return e.$store.dispatch("jv/get",["users/".concat(t),{params:n}]).then((function(t){t.isDeleted?e.$message.error("用户不存在"):(e.loading=!1,e.dialog.id=t.dialog?t.dialog._jv.id:0,e.dialog.name=t.username,e.profilename="".concat(e.dialog.name+e.$t("profile.myperson")," - ").concat(e.site_name),e.userInfo=t,e.userInfo.groupsName=e.userInfo.groups?e.userInfo.groups[0].name:"",e.canBeAsked=t.canBeAsked)}))})).catch((function(t){e.loading=!1,e.handleError(t)}))},addFollow:function(t){var e=this;if(localStorage.getItem("access_token"))if(this.isShield2)this.$message.error("你已被屏蔽");else{var n={_jv:{type:"follow"},type:"user_follow",to_user_id:t.id.toString()};this.$store.dispatch("jv/post",n).then((function(){e.getUserInfo(e.userId),e.$refs.followers&&e.$refs.followers.getFollowerList("change")}),(function(t){return e.handleError(t)}))}},deleteFollow:function(t){var e=this;localStorage.getItem("access_token")&&this.$store.dispatch("jv/delete","follow/".concat(t.id,"/1")).then((function(){e.getUserInfo(e.userId),e.$refs.followers&&e.$refs.followers.getFollowerList("change")}))},changeFollow:function(t){this.getUserInfo(t.userId)},changeLike:function(t){this.changeFollow(t)},chat:function(){localStorage.getItem("access_token")&&(this.chatting=!0)},getShieldData:function(){var t=this;this.loading=!0,this.$store.dispatch("jv/get","users/".concat(this.currentLoginId,"/deny")).then((function(e){t.unbundUserData=[],t.unbundUserData.push(Number(t.currentLoginId));var n=JSON.parse(JSON.stringify(e));n.forEach((function(e,i){t.unbundUserData.push(n[i].id)}));var data=n.filter((function(e){return e.id.toString()===t.userId}));t.isShield=data.length>0}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))},handleShield:function(){var t=this;if(localStorage.getItem("access_token")){var e={_jv:{type:"users/".concat(this.userId,"/deny")}};this.$store.dispatch("jv/post",e).then((function(){t.getShieldData()}))}},unbundlingUser:function(){var t=this;localStorage.getItem("access_token")&&this.$store.dispatch("jv/delete","users/".concat(this.userId,"/deny")).then((function(){t.$t("profile.unboundsucceed"),t.getShieldData()}))}},head:function(){return{title:this.profilename}}},y=(n(1103),n(12)),component=Object(y.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"profile"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.headFixed,expression:"headFixed"}],staticClass:"isFixed"},[n("div",{staticClass:"headcon"},[n("div",{staticClass:"hinfo"},[n("Avatar",{staticClass:"avatar",attrs:{user:t.userInfo,size:40}}),t._v(" "),n("div",{staticClass:"profile-info"},[n("span",{staticClass:"info-name"},[t._v(t._s(t.userInfo.username||""))]),t._v(" "),n("span",{staticClass:"info-actor"},[t._v("\n            "+t._s(t.userInfo.groups&&t.userInfo.groups[0]&&t.userInfo.groups[0].isDisplay?t.userInfo.groupsName:"")+"\n          ")])])],1),t._v(" "),n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},on:{"tab-click":t.changeactive},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("profile.topic")+" ("+(t.userInfo.threadCount||0)+")",name:"1"}}),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.question")+" ("+(t.userInfo.questionCount||0)+")",name:"2"}}),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.likes")+" ("+(t.userInfo.likedCount||0)+")",name:"3"}}),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.following")+" ("+(t.userInfo.followCount||0)+")",name:"4"}}),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.followers")+" ("+(t.userInfo.fansCount||0)+")",name:"5"}})],1),t._v(" "),t.userId!==t.currentLoginId?n("div",{staticClass:"profile-btn2"},[n("el-button",{staticClass:"h-button2",attrs:{type:"primary",plain:"",size:"small",disabled:!t.currentLoginId},on:{click:function(e){0==t.userInfo.follow?t.addFollow(t.userInfo):t.deleteFollow(t.userInfo)}}},[t._v("\n          "+t._s(0==t.userInfo.follow?"+ "+t.$t("profile.following"):1==t.userInfo.follow?t.$t("profile.followed"):t.$t("profile.mutualfollow")))]),t._v(" "),t.can_create_dialog?n("el-button",{staticClass:"h-button1",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.chat}},[t._v(t._s(t.$t("profile.privateMessage")))]):t._e()],1):t._e()],1)]),t._v(" "),t.userInfo&&t.forums?n("div",{staticClass:"profile-h"},[n("Avatar",{staticClass:"avatar",attrs:{user:t.userInfo,size:100}}),t._v(" "),n("div",{staticClass:"profile-info"},[n("span",{staticClass:"info-name"},[t._v("\n        "+t._s(t.userInfo.username||"")+"\n      ")]),t._v(" "),n("span",{staticClass:"info-actor"},[t.userInfo&&t.userInfo.isReal?n("svg-icon",{staticClass:"auth-icon",attrs:{type:"auth"}}):t._e(),t._v(" "),n("span",{staticClass:"groupname"},[t._v("\n          "+t._s(t.userInfo.groups&&t.userInfo.groups[0]&&t.userInfo.groups[0].isDisplay?t.userInfo.groupsName:"")+"\n        ")])],1),t._v(" "),t.userInfo.signature?n("p",{staticClass:"info-content"},[t._v("\n        "+t._s(t.userInfo.signature)+"\n      ")]):t._e()]),t._v(" "),t.userId!=t.currentLoginId?n("div",{staticClass:"profile-btn"},[t.isShield?n("div",{staticClass:"shield",on:{click:t.unbundlingUser}},[n("svg-icon",{staticClass:"unshield-icon",attrs:{type:"unshield"}}),t._v(t._s(t.$t("profile.deleteshield"))+"\n      ")],1):n("div",{staticClass:"shield",on:{click:t.handleShield}},[n("svg-icon",{staticClass:"canshield-icon",attrs:{type:"canshield"}}),t._v(t._s(t.$t("profile.shield"))+"\n      ")],1),t._v(" "),t.userInfo?n("el-button",{staticClass:"h-button2",attrs:{type:"primary",plain:"",size:"small",disabled:!t.currentLoginId},on:{click:function(e){0==t.userInfo.follow?t.addFollow(t.userInfo):t.deleteFollow(t.userInfo)}}},[t._v("\n        "+t._s(0==t.userInfo.follow?"+ "+t.$t("profile.following"):1==t.userInfo.follow?t.$t("profile.followed"):t.$t("profile.mutualfollow")||""))]):t._e(),t._v(" "),t.can_create_dialog?n("el-button",{staticClass:"h-button1",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.chat}},[t._v(t._s(t.$t("profile.privateMessage")))]):t._e(),t._v(" "),t.can_create_thread_question&&t.canBeAsked?n("el-button",{staticClass:"h-button1",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.ask}},[t._v("向Ta提问")]):t._e()],1):t._e(),t._v(" "),t.chatting?n("chat-box",{attrs:{dialog:t.dialog||{}},on:{close:function(e){t.chatting=!1}}}):t._e()],1):t._e(),t._v(" "),t.userInfo&&t.forums?n("div",{staticClass:"profile-c"},[n("div",{staticClass:"profile-cc"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},on:{"tab-click":t.changeactive},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("profile.topic")+" ("+(t.userInfo.threadCount||0)+")",name:"1"}},["1"===t.activeName?n("topic",{ref:"topic",attrs:{"user-id":t.userId,"thread-data":t.threadsData},on:{changeLike:t.changeLike}}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.question")+" ("+(t.userInfo.questionCount||0)+")",name:"2"}},["2"===t.activeName?n("question",{ref:"question",attrs:{"user-id":t.userId},on:{changeLike:t.changeLike}}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.likes")+" ("+(t.userInfo.likedCount||0)+")",name:"3"}},["3"===t.activeName?n("like",{ref:"like",attrs:{"user-id":t.userId,"likethreads-data":t.likethreadsData},on:{changeFollow:t.changeFollow}}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.following")+" ("+(t.userInfo.followCount||0)+")",name:"4"}},["4"===t.activeName?n("following",{ref:"following",attrs:{"user-id":t.userId},on:{changeFollow:t.changeFollow}}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.followers")+" ("+(t.userInfo.fansCount||0)+")",name:"5"}},["5"===t.activeName?n("follwers",{ref:"followers",attrs:{"user-id":t.userId},on:{changeFollow:t.changeFollow}}):t._e()],1)],1)],1),t._v(" "),n("div",{staticClass:"profileside"},[n("advertising"),t._v(" "),n("recommend-user",{staticClass:"recomusr"}),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)]):t._e()])}),[],!1,null,"9b3ddbec",null);e.default=component.exports;installComponents(component,{Avatar:n(268).default,SvgIcon:n(60).default,ChatBox:n(858).default,Topic:n(1136).default,Question:n(1137).default,Like:n(1138).default,Following:n(1139).default,Follwers:n(1140).default,Advertising:n(778).default,RecommendUser:n(817).default,Copyright:n(779).default})},732:function(t,e,n){n(32);var o=n(714);n(51),t.exports={data:function(){var t=this;return{errorCodeHandler:{default:{model_not_found:function(){return t.$router.replace("/error")},not_authenticated:function(){return t.$router.push("/user/login")}},thread:{permission_denied:function(){return t.$router.replace("/error")}}}}},methods:{handleError:function(t){var e=arguments,n=this;return o(regeneratorRuntime.mark((function o(){var r,l,c,d,h,f;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e.length>1&&void 0!==e[1]?e[1]:"",l=t.response.data.errors,!(Array.isArray(l)&&l.length>0)){o.next=17;break}if(c=l[0].code,d=l[0].detail&&l[0].detail.length>0?l[0].detail[0]:l[0].code,h=l[0].detail&&l[0].detail.length>0?l[0].detail[0]:n.$t("core.".concat(d)),"site_closed"!==l[0].code){o.next=10;break}return o.next=9,n.siteClose(l);case 9:return o.abrupt("return",o.sent);case 10:if("need_ext_fields"!==l[0].code){o.next=14;break}return f=n.$store.getters["session/get"]("userId"),n.$router.push("/user/supple-mentary?id=".concat(f)),o.abrupt("return");case 14:"Permission Denied"===c?n.$message.error(n.$t("core.permission_denied2")):n.$message.error(h),n.errorCodeHandler.default[c]&&n.errorCodeHandler.default[c](),r&&n.errorCodeHandler[r][c]&&n.errorCodeHandler[r][c]();case 17:case"end":return o.stop()}}),o)})))()},siteClose:function(t){var e=this;return o(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("forum/setError",{code:t[0].code,detail:t[0].detail&&t[0].detail.length>0&&t[0].detail[0]});case 3:return n.next=5,e.$router.push("/site/close");case 5:n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()}}}},734:function(t,e,n){},735:function(t,e,n){},736:function(t,e,n){},737:function(t,e,n){"use strict";n.r(e);var o={name:"Cover",mounted:function(){var t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0, 0, 0, .4)",t.style.zIndex="10",t.id="cover",document.querySelector("body").appendChild(t)},destroyed:function(){var t=document.querySelector("#cover");t.parentNode.removeChild(t)},render:function(){return""}},r=n(12),component=Object(r.a)(o,void 0,void 0,!1,null,null,null);e.default=component.exports},738:function(t,e,n){},739:function(t,e,n){},740:function(t,e,n){},741:function(t,e,n){},742:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return l}));n(177),n(51);var o=function(time){var t=(window.currentTime||new Date)-new Date(time);return parseInt(parseInt(t/1e3,0)/60,0)<60?"".concat(Math.ceil(t/1e3/60)>0?Math.ceil(t/1e3/60):1,"分钟前"):parseInt(parseInt(parseInt(t/1e3,0)/60,0)/60,0)<16?"".concat(Math.ceil(t/1e3/60/60)>0?Math.ceil(t/1e3/60/60):1,"小时前"):time.replace(/T/," ").replace(/Z/,"").substring(0,16)},r=function(t){var e=t-Math.round(new Date/1e3);return parseInt(e/86400,0)},l=function(t){var e=Math.round(new Date(t)/1e3),n=Math.round(new Date/1e3)-e,o=parseInt(n/86400,0);if(o>365){var r=parseInt(n/86400/365,0);return"".concat(r,"年")}return"".concat(o,"天")}},743:function(t,e,n){},744:function(t,e,n){"use strict";n.r(e);var o=n(801),r={name:"VideoPop",props:{url:{type:String,default:""},coverUrl:{type:String,default:""}},data:function(){return{options:{autoplay:!0,controls:!0},player:null}},mounted:function(){document.addEventListener("click",this.removeVideoPop),this.initVideoJs()},methods:{initVideoJs:function(){var t=this;this.player=Object(o.a)("videoPlayer",this.options,(function(){var e=this;o.a.log("Your player is ready!"),this.play(),this.on("error",(function(){e.errorDisplay.close(),e.createModal(t.$t("core.videoError"))}))}))},removeVideoPop:function(t){var e=!0;(t.path||t.composedPath&&t.composedPath()).forEach((function(t){"video-pop"===t.id&&(e=!1),t.classList&&t.classList.contains("svg-icon-video-play")&&(e=!1)})),e&&(this.$emit("remove"),this.player.dispose(),document.removeEventListener("click",this.removeVideoPop))}}},l=(n(749),n(12)),component=Object(l.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video-pop",attrs:{id:"video-pop"}},[e("Cover"),this._v(" "),e("video",{staticClass:"video-js",attrs:{id:"videoPlayer",controls:"",width:"800px",height:"600px",preload:"auto","data-setup":"{}"}},[e("source",{attrs:{src:this.url}}),this._v(" "),e("source",{attrs:{src:this.url,type:"video/webm"}})])],1)}),[],!1,null,"625079a2",null);e.default=component.exports;installComponents(component,{Cover:n(737).default})},745:function(t,e){e.extensionList=["7Z","AI","APK","CAD","CDR","DOC","DOCX","EPS","EXE","IPA","MP3","MP4","PDF","PPT","PSD","RAR","TXT","XLS","XLSX","ZIP","JPG","WAV"]},747:function(t,e,n){"use strict";n.r(e);var o={name:"MessageBox",props:{width:{type:String,default:"820px"},title:{type:String,default:""},overflow:{type:String,default:"auto"}}},r=(n(804),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Cover"),t._v(" "),n("div",{staticClass:"message-box",style:{overflow:t.overflow,width:t.width}},[n("div",{staticClass:"container-title"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),t._t("default")],2)],1)}),[],!1,null,"05e0d157",null);e.default=component.exports;installComponents(component,{Cover:n(737).default,SvgIcon:n(60).default})},748:function(t,e,n){"use strict";n(39);var o=n(23),r=(n(37),n(28),n(17),n(11),n(36),n(716),n(177),n(51),n(717)),l=(n(719),n(179),n(718));function c(t,e){c=function(t,e){return new f(t,void 0,e)};var n=Object(l.a)(RegExp),d=RegExp.prototype,h=new WeakMap;function f(t,e,o){var r=n.call(this,t,e);return h.set(r,o||h.get(t)),r}function m(t,e){var g=h.get(e);return Object.keys(g).reduce((function(e,n){return e[n]=t[g[n]],e}),Object.create(null))}return Object(r.a)(f,n),f.prototype.exec=function(t){var e=d.exec.call(this,t);return e&&(e.groups=m(e,this)),e},f.prototype[Symbol.replace]=function(t,e){if("string"==typeof e){var n=h.get(this);return d[Symbol.replace].call(this,t,e.replace(/\$<([^>]+)>/g,(function(t,e){return"$"+n[e]})))}if("function"==typeof e){var r=this;return d[Symbol.replace].call(this,t,(function(){var t=[];return t.push.apply(t,arguments),"object"!==Object(o.a)(t[t.length-1])&&t.push(m(t,r)),e.apply(this,t)}))}return d[Symbol.replace].call(this,t,e)},c.apply(this,arguments)}var d={topic:function(text){if(text){var t=c(/<[s\u017F]pan[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*id="topic"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*value="([0-9A-Z_a-z\u017F\u212A]+)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*>((?:(?!<)[\s\S])+)<\/[s\u017F]pan>/gim,{value:1,string:2});return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){var e="/topic/".concat(t);return'<a href="'.concat(e,'" class="content-topic a-blue">').concat(text,"</a> ")}))}))}},usermention:function(text){if(text){var t=c(/<[s\u017F]pan[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*id="member"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*value="([0-9A-Z_a-z\u017F\u212A]+)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*>((?:(?!<)[\s\S])+)<\/[s\u017F]pan>/gim,{value:1,string:2});return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){var e="/user/".concat(t);return'<a href="'.concat(e,'" class="content-member a-blue">').concat(text,"</a> ")}))}))}},parseHtml1:function(text){if(text){var t=/&lt;/gim;return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){return"<"}))}))}},parseHtml2:function(text){if(text){var t=/&gt;/gim;return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){return">"}))}))}}};e.a={parse:function(text){for(var t in d)text=d[t](text);return text}}},749:function(t,e,n){"use strict";var o=n(734);n.n(o).a},750:function(t,e,n){t.exports={data:function(){return{diffModulus:[[1e3,60,this.$t("discuzq.date.sec")],[6e4,60,this.$t("discuzq.date.min")],[36e5,24,this.$t("discuzq.date.hour")],[864e5,30,this.$t("discuzq.date.day")],[2592e6,12,this.$t("discuzq.date.mon")],[31104e6,1e6,this.$t("discuzq.date.year")]]}},methods:{timerDiff:function(t,e){t instanceof Date||(t=new Date(t)),e instanceof Date||(e=window.currentTime||new Date),e||(e=window.currentTime||new Date);for(var n,o=e-t,i=0;i<this.diffModulus.length;i++){var r=this.diffModulus[i];if(o/r[0]<r[1]){n="".concat(Math.ceil(o/r[0])," ").concat(r[2]);break}}return n||""}}}},751:function(t,e,n){},752:function(t,e,n){},753:function(t,e,n){},754:function(t,e,n){},755:function(t,e,n){},756:function(t,e,n){"use strict";var o=n(735);n.n(o).a},757:function(t,e,n){"use strict";var o=n(736);n.n(o).a},758:function(t,e,n){},759:function(t,e,n){},760:function(t,e,n){},761:function(t,e,n){},762:function(t,e,n){},763:function(t,e,n){},764:function(t,e,n){},765:function(t,e,n){},766:function(t,e,n){},767:function(t,e,n){},768:function(t,e,n){},769:function(t,e,n){},770:function(t,e,n){},771:function(t,e,n){},772:function(t,e,n){"use strict";n.r(e);n(267);var o={name:"ListLoadMore",mixins:[{data:function(){return{scrollTop:0}},mounted:function(){this.addEventListener(window,"scroll",this.handleScroll)},destroyed:function(){this.removeEventListener(window,"scroll",this.handleScroll)},methods:{handleScroll:function(){var t=document.documentElement.scrollTop||document.body.scrollTop,e=document.documentElement.clientHeight||document.body.clientHeight,n=document.documentElement.scrollHeight||document.body.scrollHeight;Math.ceil(t+e+10)>=n&&this.scrollLoadMore(),this.scrollTop=t},addEventListener:function(t,e,n,o){t.addEventListener?t.addEventListener(e,n,o):t.attachEvent&&t.attachEvent("on".concat(e),n)},removeEventListener:function(t,e,n,o){t.removeEventListener?t.removeEventListener(e,n,o):t.detachEvent&&t.detachEvent("on".concat(e),n)}}}],props:{loading:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1},pageNum:{type:[Number,String],default:1},length:{type:[Number,String],default:0},surplus:{type:[Number,String],default:0},loadMoreText:{type:String,default:function(){return this.$t("topic.showMore")}}},methods:{scrollLoadMore:function(){(this.pageNum-1)%5>0&&!this.loading&&this.hasMore&&this.loadMore()},loadMore:function(){this.$emit("loadMore")}}},r=n(12),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"load-more-container"},[t.loading?n("loading"):[t.hasMore&&(t.pageNum-1)%5==0?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v("\n      "+t._s(t.surplus>0?t.$t("notice.checkMore",{surplus:t.surplus}):t.loadMoreText)+"\n    ")]):t.hasMore&&(t.pageNum-1)%5>0?n("loading"):n("div",{staticClass:"no-more"},[0===t.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v("\n      "+t._s(t.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noData"))+"\n    ")],1)]],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Loading:n(842).default,SvgIcon:n(60).default})},773:function(t,e,n){"use strict";n.r(e);var o={name:"ProductItem",props:{item:{type:Object,default:function(){}}},data:function(){return{}}},r=(n(756),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item?n("a",{staticClass:"product-container",attrs:{href:t.item.detail_content,target:"_blank",el:"nofollow"}},[n("el-image",{staticClass:"image",attrs:{src:t.item.image_path,alt:t.item.title,fit:"cover"}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])]),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"info-header"},[n("div",{staticClass:"title"},[t._v(t._s(t.item.title))]),t._v(" "),t.item.price>0?n("div",{staticClass:"price"},[t._v(t._s(t.$t("post.yuanItem")+t.item.price+t.$t("post.yuan")))]):t._e()]),t._v(" "),n("div",{staticClass:"btn"},[n("svg-icon",{staticClass:"icon",attrs:{type:"product-icon"}}),t._v(t._s(t.$t("post.buyProudct")))],1)])],1):t._e()}),[],!1,null,"14d72f28",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default})},774:function(t,e,n){"use strict";n.r(e);n(30),n(11);var o={name:"AudioPlayer",props:{file:{type:Object,default:function(){}},currentAudio:{type:Object,default:function(){}}},data:function(){return{onDragging:!1,delta:0}},computed:{currentFile:function(){return this.currentAudio.id===this.file._jv.id},playing:function(){return this.currentAudio.currentTime&&this.currentAudio.duration}},methods:{formatDuration:function(t){var e=Math.floor(t/60),n=(t-60*e).toString().substr(0,2);return"."===n[1]&&(n="0".concat(n[0])),"".concat(e,":").concat(n)},formatCurrentTime:function(t){var e=parseInt(t/60)%60,n=(t%60).toFixed(),o=e<10?"0".concat(e):e,s=n<10?"0".concat(n):n;return"".concat(o,":").concat(s)},convertToPercentage:function(){return this.currentAudio.currentTime/this.currentAudio.duration*100},onmousedown:function(){window.document.addEventListener("mousemove",this.dragging),window.document.addEventListener("mouseup",this.onMouseUp)},dragging:function(t){this.delta=t.clientX-this.$refs.progress.getBoundingClientRect().x,this.delta<0&&(this.delta=0),this.delta>290&&(this.delta=290);var time=this.delta/290*this.currentAudio.duration;this.$emit("seeking",time)},onMouseUp:function(){var time=this.delta/290*this.currentAudio.duration;this.$emit("seek",time),window.document.removeEventListener("mousemove",this.dragging),window.document.removeEventListener("mouseup",this.onMouseUp)}}},r=(n(757),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"audio"},[t.currentFile&&t.currentAudio.isLoading?n("div",{staticClass:"control"},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"loading",rotate:""}})],1):t.currentFile&&t.currentAudio.isPlay?n("div",{staticClass:"control",on:{click:function(e){return t.$emit("pause")}}},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"audio-pause"}})],1):n("div",{staticClass:"control",on:{click:function(e){return t.$emit("play",t.file)}}},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"audio-play"}})],1),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"title"},[n("span",{staticClass:"title-audio"},[t._v(t._s(t.file.fileName||t.file.file_name))]),t._v(" "),t.currentFile&&t.playing?n("span",{staticClass:"duration-audio"},[t._v("\n        "+t._s(t.formatCurrentTime(t.currentAudio.currentTime))+" /\n        "+t._s(t.formatDuration(t.currentAudio.duration))+"\n      ")]):n("span",{staticClass:"duration-audio"},[t._v("--:--")])]),t._v(" "),t.currentFile&&t.playing?n("div",{ref:"progress",staticClass:"progress",attrs:{id:"progress"}},[n("div",{staticClass:"progress-item",style:{width:t.convertToPercentage()+"%"}}),t._v(" "),n("div",{staticClass:"control-ball",style:{left:t.convertToPercentage()+"%"},attrs:{id:"control-ball"},on:{mousedown:t.onmousedown}})]):t._e()])])}),[],!1,null,"1e22faf0",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default})},776:function(t,e,n){"use strict";n.r(e);n(27),n(11);var o=n(748),time=n(742),r=n(745),l=n(732),c=n.n(l),d=n(178),h=n.n(d),f={name:"PostItem",filters:{formatDate:function(t){return Object(time.b)(t)}},mixins:[c.a,h.a],props:{item:{type:Object,default:function(){}},showShare:{type:Boolean,default:!0},lazy:{type:Boolean,default:!0},infoimage:{type:Boolean,default:!1},canDetail:{type:Boolean,default:!1}},data:function(){return{loading:!1,showVideoPop:!1,isLiked:!1,currentAudio:{id:"",url:"",currentTime:"",duration:"",audio:"",seeking:!1,isPlay:!1,isLoading:!1}}},computed:{unpaid:function(){return!(this.item.paid||0===parseFloat(this.item.price))},forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{item:{handler:function(t){this.isLiked=t.firstPost&&t.firstPost.isLiked,this.likeCount=t.firstPost&&t.firstPost.likeCount},deep:!0,immediate:!0}},mounted:function(){this.currentAudio.audio=document.getElementById("audio-player".concat(this.item&&this.item._jv&&this.item._jv.id))},methods:{handleLike:function(){var t=this;if(this.$store.getters["session/get"]("isLogin")){if(this.loading)return;if(!this.item.firstPost.canLike)return void this.$message.error(this.$t("topic.noThreadLikePermission"));this.loading=!0;var e=!this.isLiked,n={_jv:{type:"posts",id:this.item.firstPost&&this.item.firstPost._jv&&this.item.firstPost._jv.id},isLiked:e};return this.$store.dispatch("jv/patch",n).then((function(){t.$message.success(e?t.$t("discuzq.msgBox.likeSuccess"):t.$t("discuzq.msgBox.cancelLikeSuccess")),e?t.likeCount+=1:t.likeCount-=1,t.isLiked=e,t.$emit("change")}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))}this.$message.warning("请登录"),window.setTimeout((function(){t.headerTologin()}),1e3)},toDetail:function(){this.canViewPostsFn()&&this.routerLink()},onClickImage:function(){this.unpaid&&this.canViewPostsFn()&&this.routerLink()},openVideo:function(){this.canViewPostsFn()&&(this.unpaid?this.routerLink():"/"===this.$route.path||"/site/search"===this.$route.path||"category-id"===this.$route.name?this.$emit("showVideoFn",this.item.threadVideo):this.showVideoPop=!0)},routerLink:function(){window.open("/thread/".concat(this.item._jv&&this.item._jv.id),"_blank")},onClickContent:function(t){var e=t||window.event;"a"!==(e.target||e.srcElement).nodeName.toLocaleLowerCase()&&this.toDetail()},canViewPostsFn:function(){var t=this;return this.item.canViewPosts?!this.canDetail||(this.$message.warning(this.$t("topic.joinAfterView")),!1):(this.$store.getters["session/get"]("isLogin")?this.$message.warning(this.$t("home.noPostingTopic")):(this.$message.warning(this.$t("core.not_authenticated")),window.setTimeout((function(){t.headerTologin()}),1e3)),!1)},formatTopicHTML:function(html){return o.a.parse(html)},extensionValidate:function(t){return r.extensionList.indexOf(t.toUpperCase())>0?t.toUpperCase():"UNKNOWN"},play:function(t){var e=this;this.unpaid?this.routerLink():this.canViewPostsFn()&&this.currentAudio.audio&&(this.currentAudio.id!==t._jv.id&&(this.resetAudio(this.currentAudio.audio),this.currentAudio.url=t.url||t.media_url,this.currentAudio.id=t._jv.id,this.currentAudio.audio.src=this.currentAudio.url,this.currentAudio.isLoading=!0,this.currentAudio.audio.load()),window.setTimeout((function(){e.currentAudio.audio.play(),e.currentAudio.isPlay=!0,e.currentAudio.audio.addEventListener("timeupdate",e.onProgressing),e.currentAudio.audio.addEventListener("ended",e.onEnded),e.$emit("audioPlay",e.currentAudio.id)}),0))},onProgressing:function(){this.currentAudio.seeking||(this.currentAudio.isLoading=!1,this.currentAudio.duration=this.currentAudio.audio.duration,this.currentAudio.currentTime=this.currentAudio.audio.currentTime)},onEnded:function(){this.resetAudio(this.currentAudio.audio)},resetAudio:function(audio){audio&&(audio.removeEventListener("timeupdate",this.onProgressing),audio.removeEventListener("ended",this.onEnded),this.currentAudio.isPlay=!1,this.currentAudio.duration="",this.currentAudio.currentTime="")},pause:function(){this.currentAudio.audio&&(this.currentAudio.isLoading=!1,this.currentAudio.isPlay=!1,this.currentAudio.audio.pause())},seek:function(time){this.currentAudio.audio&&(this.currentAudio.seeking=!1,this.currentAudio.currentTime=time,this.currentAudio.audio.currentTime=time)},seeking:function(time){this.currentAudio.seeking=!0,this.currentAudio.currentTime=time}}},m=(n(788),n(12)),component=Object(m.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-container"},[t.item.isEssence?n("div",{staticClass:"essence"},[n("svg-icon",{attrs:{type:"index-essence"}})],1):t._e(),t._v(" "),5===t.item.type&&t.item.question&&1===t.item.question.is_answer&&t.item.question.beUser?n("avatar",{staticClass:"avatar",attrs:{user:{id:t.item.question.beUser.id,username:t.item.question.beUser.username,avatarUrl:t.item.question.beUser.avatarUrl,isReal:t.item.question.beUser.isReal},"prevent-jump":t.canDetail}}):t.item.user?n("avatar",{staticClass:"avatar",attrs:{user:{id:t.item.user.id,username:t.item.user.username,avatarUrl:t.item.user.avatarUrl,isReal:t.item.user.isReal},"prevent-jump":t.canDetail}}):t._e(),t._v(" "),n("div",{staticClass:"main-cont"},[n("div",{staticClass:"top-flex"},[5===t.item.type&&t.item.question&&1===t.item.question.is_answer&&t.item.question.beUser?n("nuxt-link",{staticClass:"user-info",attrs:{to:t.item.user.id>0?"/user/"+t.item.question.beUser.id:""}},[n("span",{staticClass:"user-name"},[t._v(t._s(t.item.question.beUser.username))]),t._v(" "),t.item.question.beUser&&t.item.question.beUser.groups&&t.item.question.beUser.groups.length>0&&t.item.question.beUser.groups[0].isDisplay?n("span",{staticClass:"admin"},[t._v("\n          ("+t._s(t.item.question.beUser.groups[0].name)+")\n        ")]):t._e()]):t.item.user?n("nuxt-link",{staticClass:"user-info",attrs:{to:t.item.user.id>0?"/user/"+t.item.user.id:""}},[n("span",{staticClass:"user-name"},[t._v(t._s(t.item.user.username))]),t._v(" "),t.item.user&&t.item.user.groups&&t.item.user.groups.length>0&&t.item.user.groups[0].isDisplay?n("span",{staticClass:"admin"},[t._v("\n          ("+t._s(t.item.user.groups[0].name)+")\n        ")]):t._e()]):t._e(),t._v(" "),n("div",{staticClass:"time"},[5===t.item.type&&t.item.question&&1===t.item.question.is_answer?n("div",{staticClass:"answered"},[t._v("\n          "+t._s(t.$t("topic.answered"))+"\n        ")]):t._e(),t._v(" "),t.item.createdAt?[t._v(t._s(t.$t("topic.publishAt"))+"\n          "+t._s(t._f("formatDate")(t.item.createdAt)))]:t._e()],2)],1),t._v(" "),5===t.item.type?n("div",[t.item.question&&0===t.item.question.is_answer?[t._v("\n        "+t._s(t.$t("topic.be"))+"\n        "),t.item.question&&t.item.question.beUser?n("nuxt-link",{staticClass:"blue",attrs:{to:t.item.question.beUser.id>0?"/user/"+t.item.question.beUser.id:""}},[t._v("@"+t._s(t.item.question.beUser.username))]):t._e(),t._v("\n        "+t._s(t.$t("topic.question"))+"\n      ")]:t._e(),t._v(" "),t.item.question&&1===t.item.question.is_answer?[t._v("\n        "+t._s(t.$t("topic.answer"))+"\n        "),t.item.user?n("nuxt-link",{staticClass:"blue",attrs:{to:t.item.user.id>0?"/user/"+t.item.user.id:""}},[t._v("@"+t._s(t.item.user.username))]):t._e(),t._v("\n        "+t._s(t.$t("topic.of"))+t._s(t.$t("topic.question"))+"\n      ")]:t._e()],2):t._e(),t._v(" "),t.item.firstPost?[n("div",{staticClass:"first-post",on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},[n("div",{on:{click:t.onClickContent}},[1===t.item.type?n("div",{staticClass:"title"},[t._v("\n            "+t._s(t.$t("home.released"))+"\n            "),n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:parseFloat(t.item.price)>0||parseFloat(t.item.attachmentPrice)>0,expression:"\n                parseFloat(item.price) > 0 ||\n                  parseFloat(item.attachmentPrice) > 0\n              "}],staticClass:"blue",staticStyle:{"font-size":"17px",display:"inline-block","margin-right":"5px"},attrs:{type:"pay-yuan"}}),t._v(" "),n("span",{staticClass:"blue "},[t._v(t._s(t.item.title))])],1):n("div",{staticClass:"content"},[5===t.item.type?n("svg-icon",{staticClass:"icon-pay-yuan blue",attrs:{type:"question-icon"}}):6===t.item.type?n("svg-icon",{staticClass:"icon-pay-yuan blue",attrs:{type:"product-icon"}}):parseFloat(t.item.price)>0||parseFloat(t.item.attachmentPrice)>0?n("svg-icon",{staticClass:"icon-pay-yuan grey",attrs:{type:"pay-yuan"}}):t._e(),t._v(" "),n("div",{class:{"content-block":5===t.item.type||6===t.item.type||parseFloat(t.item.price)>0,blue:5===t.item.type},domProps:{innerHTML:t._s(t.$xss(t.formatTopicHTML(t.item.firstPost.summary)))}})],1)]),t._v(" "),t.item.firstPost.images&&t.item.firstPost.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{ url: 'data-source' }"}],staticClass:"images",on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},t._l(t.item.firstPost.images.slice(0,3),(function(image,e){return n("el-image",{key:e,class:{image:!0,infoimage:t.infoimage},attrs:{src:image.thumbUrl,"data-source":t.unpaid?"":image.url,alt:image.filename,fit:"cover",lazy:t.lazy},on:{click:function(e){return e.target!==e.currentTarget?null:t.onClickImage(e)}}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])])})),1):t._e(),t._v(" "),t.item.firstPost.images&&t.item.firstPost.images.length>3?n("div",{staticClass:"image-count",on:{click:t.toDetail}},[t._v("\n          "+t._s(t.$t("home.total"))+" "+t._s(t.item.firstPost.images.length)+"\n          "+t._s(t.$t("home.seeAllImage"))+"\n        ")]):t._e(),t._v(" "),2===t.item.type&&t.item.threadVideo?n("div",{staticClass:"video-main",on:{click:function(e){return e.stopPropagation(),t.openVideo(e)}}},[t.item.threadVideo.cover_url?n("el-image",{staticClass:"video-img-cover",attrs:{src:t.item.threadVideo.cover_url,alt:t.item.threadVideo.file_name,fit:"cover",lazy:t.lazy}}):n("div",{staticClass:"no-cover"},[t._v(t._s(t.$t("home.noPoster")))]),t._v(" "),n("svg-icon",{staticClass:"video-play",attrs:{type:"video-play"}})],1):t._e(),t._v(" "),t.item.firstPost.attachments&&t.item.firstPost.attachments.length>0?n("div",{staticClass:"attachment",on:{click:t.toDetail}},[n("svg-icon",{attrs:{type:t.extensionValidate(t.item.firstPost.attachments[0].extension)}}),t._v(" "),n("div",{staticClass:"name text-hidden"},[t._v("\n            "+t._s(t.item.firstPost.attachments[0].fileName)+"\n          ")]),t._v(" "),t.item.firstPost.attachments.length>1?n("div",{staticClass:"total"},[t._v("\n            "+t._s(t.$t("home.etc")+t.item.firstPost.attachments.length+t.$t("home.attachmentTotal"))+"\n          ")]):t._e()],1):t._e()]),t._v(" "),6===t.item.type?n("product-item",{attrs:{item:t.item&&t.item.firstPost&&t.item.firstPost.postGoods}}):t._e(),t._v(" "),4===t.item.type?n("div",{on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},[n("audio-player",{attrs:{file:t.item&&t.item.threadAudio,"current-audio":t.currentAudio},on:{play:t.play,pause:t.pause,seek:t.seek,seeking:t.seeking}}),t._v(" "),n("audio",{staticClass:"audio-player",staticStyle:{display:"none"},attrs:{id:"audio-player"+(t.item._jv&&t.item._jv.id),src:t.currentAudio.url}})],1):t._e(),t._v(" "),t.item.location?n("nuxt-link",{staticClass:"location",attrs:{to:"/topic/position?longitude="+t.item.longitude+"&latitude="+t.item.latitude}},[n("span",{staticClass:"flex"},[n("svg-icon",{staticClass:"icon",attrs:{type:"location"}}),t._v("\n          "+t._s(t.item.location)+"\n        ")],1)]):t._e(),t._v(" "),t.canDetail?t._e():n("div",{staticClass:"bottom-handle"},[n("div",{staticClass:"left"},[n("div",{staticClass:"btn like",class:{liked:t.isLiked},on:{click:t.handleLike}},[n("svg-icon",{staticClass:"icon",attrs:{type:"like"},on:{click:t.handleLike}}),t._v("\n            "+t._s(t.isLiked?t.$t("topic.liked"):t.$t("topic.like"))+"\n            "+t._s(t.likeCount>0?t.likeCount:"")+"\n          ")],1),t._v(" "),n("div",{staticClass:"btn comment",on:{click:t.toDetail}},[n("svg-icon",{staticClass:"icon",attrs:{type:"post-comment"}}),t._v("\n            "+t._s(t.$t("topic.comment"))+"\n            "+t._s(t.item.postCount-1>0?t.item.postCount-1:"")+"\n          ")],1),t._v(" "),t.item._jv&&t.item._jv.id&&t.showShare?n("share-popover",{attrs:{"threads-id":t.item._jv.id}},[n("div",{staticClass:"btn share"},[n("svg-icon",{staticClass:"icon",attrs:{type:"link"}}),t._v("\n              "+t._s(t.$t("topic.share"))+"\n            ")],1)]):t._e()],1),t._v(" "),t._t("bottom-right")],2)]:t._e()],2),t._v(" "),t.showVideoPop?n("video-pop",{attrs:{"cover-url":t.item.threadVideo.cover_url,url:t.item.threadVideo.media_url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e()],1)}),[],!1,null,"18ebc636",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default,Avatar:n(268).default,ProductItem:n(773).default,AudioPlayer:n(774).default,SharePopover:n(777).default,VideoPop:n(744).default})},777:function(t,e,n){"use strict";n.r(e);n(267);var o=n(775),r={name:"SharePopover",props:{threadsId:{type:[String,Number],default:""},type:{type:String,default:""}},data:function(){return{qrcode:null,currentType:""}},methods:{copyLink:function(){var t=document.createElement("input");"topic"===this.type?t.value=window.location.href:t.value="".concat(window.location.protocol,"//").concat(window.location.host,"/thread/").concat(this.threadsId),t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success("链接复制成功"),setTimeout((function(){t.remove()}),100)},onShowPopover:function(){this.currentType=this.type;var path=window.location.href;path="topic"===this.type?window.location.href:"".concat(window.location.protocol,"//").concat(window.location.host,"/thread/").concat(this.threadsId),this.createQrcode(path)},createQrcode:function(link){var t=this;this.qrcode=null,this.$nextTick((function(){t.qrcode=new o(t.$refs.qrcode,{width:88,height:88,text:link})}))},closeCode:function(){this.$refs.qrcode.innerHTML=""}}},l=(n(780),n(781),n(12)),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"share-container"},[n("el-popover",{attrs:{placement:"bottom",width:"120","min-width":"120",trigger:"click","popper-class":"custom-popover-width"},on:{show:t.onShowPopover,hide:t.closeCode}},[n("div",{staticClass:"share-cont"},[n("div",{staticClass:"copy",on:{click:t.copyLink}},[n("svg-icon",{staticClass:"copy-icon",attrs:{type:"copy-link"}}),t._v(" "),n("span",[t._v(t._s(t.$t("core.copyLink")))])],1),t._v(" "),n("div",{staticClass:"qrcode"},[n("div",{staticClass:"qrcode-text"},[n("svg-icon",{staticClass:"wechat-logo",attrs:{type:"wechat-logo"}}),t._v(" "),n("span",[t._v(t._s(t.$t("core.wxShare")))])],1),t._v(" "),n("div",{ref:"qrcode",staticClass:"qrcode-cont"})])]),t._v(" "),n("template",{slot:"reference"},[t._t("default")],2)],2)],1)}),[],!1,null,"020e6bca",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default})},778:function(t,e,n){"use strict";n.r(e);var o=n(775),r={name:"Advertising",data:function(){return{qrcode:null,siteName:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{forums:{handler:function(t){t&&t.set_site&&(this.siteName=t.set_site.site_name?t.set_site.site_name:"Discuz! Q")},deep:!0}},mounted:function(){this.siteName=this.forums&&this.forums.set_site&&this.forums.set_site.site_name?this.forums.set_site.site_name:"Discuz! Q",this.createQrcode(window.location.href)},destroyed:function(){this.qrcode=null},methods:{createQrcode:function(link){var t=this;this.qrcode=null,this.$nextTick((function(){t.qrcode=new o(t.$refs.qrcode,{width:70,height:70,text:link})}))}}},l=(n(784),n(12)),component=Object(l.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"adv-container"},[e("div",{ref:"qrcode",staticClass:"qrcode"}),this._v(" "),e("div",{staticClass:"adv-info"},[e("div",{staticClass:"adv-title"},[this._v("扫一扫，访问移动端")]),this._v("\n    "+this._s(this.siteName)+"\n  ")])])}),[],!1,null,"164368aa",null);e.default=component.exports},779:function(t,e,n){"use strict";n.r(e);var o={name:"Copyright",data:function(){return{year:"2019"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=window.currentTime||new Date;this.year=t.getFullYear()}},r=(n(785),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"copyright"},[n("div",{staticClass:"info"},[n("span",[t._v("Powered By")]),t._v(" "),n("a",{staticClass:"site",attrs:{href:"https://discuz.com",target:"_blank"}},[t._v("Discuz! Q")]),t._v(" "),n("span",{staticClass:"block"},[t._v("© "+t._s(t.year))])]),t._v(" "),t.forums&&t.forums.set_site&&(t.forums.set_site.site_record||t.forums.set_site.site_record_code)?n("div",{staticClass:"id"},[n("div",{staticClass:"site-record-code"},[n("a",{attrs:{href:"https://beian.miit.gov.cn/",target:"_blank"}},[t._v(t._s(t.forums.set_site?t.forums.set_site.site_record:""))])]),t._v(" "),t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code?n("div",{staticClass:"site-record-code"},[n("a",{attrs:{href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=\n        "+(t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code.replace(/[^0-9]/gi,""))+"\n        ",target:"_blank"}},[t._v(t._s(t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code))])]):t._e()]):t._e()])}),[],!1,null,"5a66071e",null);e.default=component.exports},780:function(t,e,n){"use strict";var o=n(738);n.n(o).a},781:function(t,e,n){"use strict";var o=n(739);n.n(o).a},782:function(t,e,n){t.exports={methods:{handleAttachmentError:function(t){if(t&&t.message){var e=t.message.errors,n=e[0].detail?e[0].detail[0]:e[0].code,o=e[0].detail?e[0].detail[0]:this.$t("core.".concat(n));this.$message.error(o)}else this.$message.error(this.$t("post.imageUploadFail"))}}}},783:function(t,e,n){n(17),n(36),n(30),n(11),n(27);var o=n(715);t.exports={watch:{fileList:{handler:function(){var t;this.fileList.length>this.previewFiles.length&&0===this.previewFiles.length&&((t=this.previewFiles).push.apply(t,o(this.fileList)),this.previewFiles.map((function(t){t.progress=100})))},deep:!0,immediate:!0}},methods:{uploaderFile:function(t){t.dispatchEvent(new MouseEvent("click"))},onInput:function(t){var e=this,n=t.target.files,o=[];if(this.onUpload)return this.$message.warning(0===this.type?"请等待上传中的文件完成上传":"请等待上传中的图片完成上传");if(this.checkSizeLimit(n)&&this.checkLengthLimit(n)){for(var i=0;i<n.length;i++){var r=this.getObjectURL(n[i]);this.previewFiles.push({name:n[i].name,url:r,progress:0,deleted:!1,size:n[i].size}),o.push(n[i])}var l=o.reduce((function(t,n,o,r){return t.push(e.uploadFile(n,o,r.length)),t}),[]);this.uploadFiles(l)}},uploadFile:function(t,e,n){var o=this,r={onUploadProgress:function(t){t.lengthComputable?o.previewFiles[o.previewFiles.length-n+e].progress=.9*parseInt(Math.round(t.loaded/t.total*100).toString()):o.previewFiles[o.previewFiles.length-n+e].progress=100}},l=new FormData;return l.append("type",this.type),l.append("file",t),this.service.post(this.action,l,r)},uploadFiles:function(t){var e=this;this.$emit("update:onUpload",!0),Promise.all(t).then((function(t){e.previewFiles.map((function(t){t.progress=100}));var n=t.map((function(t){return t.data.data})),r=o(e.fileList);n.forEach((function(t){return r.push({id:t.id,name:t.attributes.fileName,url:t.attributes.url})})),e.currentInput.value="",e.$emit("success",r),e.$emit("update:onUpload",!1)}),(function(n){e.currentInput.value="";var o=t.length;e.$emit("update:onUpload",!1),e.previewFiles.splice(e.previewFiles.length-o,o),e.handleError(n).then((function(){}))}))},removeItem:function(t){var e=this;this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){e.previewFiles[t].deleted=!0;var n=o(e.fileList);n.splice(t,1),e.$emit("remove",n,t),setTimeout((function(){e.previewFiles.splice(t,1),e.$message.success("删除成功")}),900)}),(function(){}))},checkSizeLimit:function(t){for(var e=!0,i=0;i<t.length;i++)t[i].size>this.sizeLimit&&(e=!1);return e||this.$message.error(0===this.type?"文件大小不可超过 ".concat(this.sizeLimit/1024/1024," MB"):"图片大小不可超过 ".concat(this.sizeLimit/1024/1024," MB")),e},checkLengthLimit:function(t){return!(this.previewFiles.length+t.length>this.limit)||(this.$message.warning(0===this.type?"文件最多上传".concat(this.limit,"张"):"图片最多上传".concat(this.limit,"张")),this.$emit("exceed",t),!1)},getObjectURL:function(t){var e=null;return window.createObjectURL?e=window.createObjectURL(t):window.URL?e=window.URL.createObjectURL(t):window.webkitURL&&(e=window.webkitURL.createObjectURL(t)),e}}}},784:function(t,e,n){"use strict";var o=n(740);n.n(o).a},785:function(t,e,n){"use strict";var o=n(741);n.n(o).a},786:function(t,e,n){"use strict";n.r(e);n(267);var o={name:"AvatarComponent",props:{author:{type:Object,default:function(){}},size:{type:Number,default:50},round:{type:Boolean,default:!1}},computed:{isAnonymous:function(){return this.author&&this.author.id&&parseInt(this.author.id)<0}}},r=(n(820),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("Avatar",{attrs:{user:t.author,size:t.size,round:t.round}}),t._v(" "),n("div",{staticClass:"title-info"},[n("div",{staticClass:"author-name"},[n("a",{staticClass:"username",attrs:{href:t.isAnonymous?"javascript:void(0)":"/user/"+t.author.id}},[t._v(t._s(t.author.username))]),t._v(" "),t.author.groups&&t.author.groups[0]&&t.author.groups[0].isDisplay?n("span",{staticClass:"group"},[t._v("（"+t._s(t.author.groups[0].name)+"）")]):t._e()]),t._v(" "),n("div",{staticClass:"timer"},[t._t("default")],2)])],1)}),[],!1,null,"91b5e060",null);e.default=component.exports;installComponents(component,{Avatar:n(268).default})},788:function(t,e,n){"use strict";var o=n(743);n.n(o).a},789:function(t,e,n){},790:function(t,e,n){},794:function(t,e,n){"use strict";n.r(e);var o=n(85),r=n(732),l={name:"Caller",mixins:[n.n(r).a],data:function(){return{friends:[],friendsLoading:!0,selectedFriends:[],searchList:[],searchValue:"",searchTotal:10,loading:!1,setTimeoutId:null,pageLimit:10,pageNumber:1}},computed:{noMore:function(){return!(!this.searchValue||this.loading)&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.getFriends()},methods:{getFriends:function(){var t=this,e={"filter[type]":2,include:"fromUser,toUser.groups"};return this.$store.dispatch("jv/get",["follow",{params:e}]).then((function(data){t.friendsLoading=!1,t.friends=data.filter((function(t){return 1===t.is_mutual})),t.friends=t.friends.map((function(t){return t.fromUser}))}),(function(e){return t.handleError(e)}))},searchUser:function(t){var e=this;this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue&&(this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getSearchList(),e.setTimeoutId=null}),300))},getSearchList:function(){var t=this,e={"filter[username]":"*".concat(this.searchValue,"*"),"filter[status]":"normal","page[limit]":this.pageLimit,"page[number]":this.pageNumber};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(o.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchValue&&this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getSearchList())},formatValue:function(){var t=Object(o.a)(this.selectedFriends);return t=t.map((function(t){return"".concat(t," ")}))," @".concat(t.join("@"))},selectFriendFromUl:function(t){this.selectedFriends.indexOf(t.username)<0&&this.selectedFriends.push(t.username),this.clear()},clear:function(){this.$refs.inputCaller.value="",this.searchValue="",this.searchList=[]}}},c=(n(828),n(12)),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("post.callFriends"),overflow:"visible"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"container-selectedCaller"},t._l(t.selectedFriends,(function(e,o){return n("div",{key:o,staticClass:"selectedCaller"},[n("span",[t._v("@ "+t._s(e))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(n){t.selectedFriends.splice(t.selectedFriends.indexOf(e),1)}}})],1)})),0),t._v(" "),n("div",{staticClass:"tip"},[t._v(t._s(t.$t("post.searchFriends")))]),t._v(" "),n("div",{staticClass:"container-search-list"},[n("label",[n("input",{ref:"inputCaller",staticClass:"input-caller",attrs:{placeholder:t.$t("post.pleaseInput"),type:"text"},on:{input:t.searchUser}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},t._l(t.searchList,(function(e,o){return n("li",{key:o,class:{"infinite-list-item":!0,selected:t.selectedFriends.indexOf(e.username)>=0},on:{click:function(n){return t.selectFriendFromUl(e)}}},[t._v("\n            "+t._s(e.username)+"\n          ")])})),0),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e(),t._v(" "),t.noMore?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.noMoreData")))]):t._e()])]),t._v(" "),n("div",{staticClass:"friends"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.myFriends")))]),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.friendsLoading,expression:"friendsLoading"}],staticClass:"container-caller"},t._l(t.friends,(function(e,o){return n("div",{key:o,class:{caller:!0,selected:t.selectedFriends.indexOf(e.username)>=0},on:{click:function(n){t.selectedFriends.indexOf(e.username)>=0?t.selectedFriends.splice(t.selectedFriends.indexOf(e.username),1):t.selectedFriends.push(e.username)}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0)])]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("span",{staticClass:"text"},[t._v(t._s(t.$t("post.chosen")+" "+t.selectedFriends.length+" "+t.$t("topic.personUnit")))]),t._v(" "),n("el-button",{attrs:{disabled:0===t.selectedFriends.length,size:"medium",type:"primary"},on:{click:function(e){t.$emit("selectedCaller",t.formatValue())}}},[t._v(t._s(t.$t("post.confirmChoice")))])],1)])])}),[],!1,null,"cac17f28",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default,Avatar:n(268).default,MessageBox:n(747).default})},795:function(t,e,n){"use strict";n.r(e);var o=n(85),r=n(732),l={name:"TopicList",mixins:[n.n(r).a],data:function(){return{searchValue:"",searchList:[],searchTotal:0,pageNumber:1,pageLimit:5,setTimeoutId:null,loading:!1}},computed:{noMore:function(){return!this.loading&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.getTopics()},methods:{searchTopics:function(t){var e=this;this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getTopics(),e.setTimeoutId=null}),300)},getTopics:function(){var t=this,e={"page[limit]":this.pageLimit,"page[number]":this.pageNumber,sort:"recommended"};return this.searchValue&&(e["filter[content]"]=this.searchValue),this.searchValue||(e["filter[recommended]"]=1),this.$store.dispatch("jv/get",["topics",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(o.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getTopics())},emitValue:function(t){this.$emit("selectedTopic"," #".concat(t,"# ")),this.searchValue="",this.searchList=[],this.getTopics()}}},c=(n(826),n(12)),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-search-list",on:{click:function(t){t.stopPropagation()}}},[n("label",{on:{click:function(t){if(t.target!==t.currentTarget)return null}}},[n("input",{staticClass:"input-topic",attrs:{type:"text",placeholder:t.$t("post.topicInputTip")},domProps:{value:t.searchValue},on:{input:t.searchTopics,click:function(t){if(t.target!==t.currentTarget)return null}}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},[t.searchValue&&t.searchList.map((function(t){return t.content})).indexOf(t.searchValue)<0&&!t.loading?n("li",{on:{click:function(e){return t.emitValue(t.searchValue)}}},[n("span",[t._v("#"+t._s(t.searchValue)+"#")]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.newTopic")))])]):t._e(),t._v(" "),t._l(t.searchList,(function(e,o){return n("li",{key:o,staticClass:"infinite-list-item",on:{click:function(n){return t.emitValue(e.content)}}},[n("span",[t._v("#"+t._s(e.content)+"#")]),t._v(" "),n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:1===e.recommended,expression:"topic.recommended === 1"}],staticStyle:{"font-size":"16px"},attrs:{type:"recommend"}}),t._v(" "),n("span",[t._v(t._s(e.view_count+t.$t("topic.hot")))])],1)}))],2),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e()])])}),[],!1,null,"2a433fb1",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default})},796:function(t,e,n){"use strict";n.r(e);var o={name:"EmojiList",data:function(){return{emojiList:[]}},mounted:function(){this.getEmojiList()},methods:{getEmojiList:function(){var t=this;this.$store.dispatch("jv/get",["emoji",{}]).then((function(data){t.emojiList=data}))}}},r=(n(827),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"emoji-list"},t._l(t.emojiList,(function(e,o){return n("span",{key:o,on:{click:function(n){return t.$emit("selectEmoji",e.code)}}},[n("img",{attrs:{src:e.url,alt:e.code}})])})),0)}),[],!1,null,"22862d46",null);e.default=component.exports},799:function(t,e,n){"use strict";n.r(e);n(61);var o=n(732),r={name:"Editor",mixins:[n.n(o).a],props:{post:{type:Object,default:function(){}},payment:{type:Object,default:function(){}},question:{type:Object,default:function(){}},product:{type:Object,default:function(){}},typeInformation:{type:Object,default:function(){}},editResourceShow:{type:Object,default:function(){}},isEdit:{type:Boolean,default:!1},onPublish:{type:Boolean,default:!1},editorStyle:{type:String,default:"post"},selector:{type:String,default:"editor"}},data:function(){return{input:{},vditor:{},selectionStart:0,selectionEnd:0,showEmoji:!1,showCaller:!1,showTopic:!1,showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1,onUploadImage:!1,onUploadVideo:!1,onUploadAttached:!1,listenerList:["emoji-list","topic-list"],actions:[{icon:"emoji",toggle:"showEmoji",show:!1},{icon:"call",toggle:"showCaller",show:!1},{icon:"topic",toggle:"showTopic",show:!1}],resources:[{icon:"picture",toggle:"showUploadImg",show:!1},{icon:"video",toggle:"showUploadVideo",show:!1}]}},computed:{userId:function(){return this.$store.state.session.userId},url:function(){return"/api"},header:function(){var t=window.localStorage.getItem("access_token");return{authorization:"Bearer ".concat(t)}},textarea:function(){return document.querySelector(".".concat(this.selector," #textarea"))},forums:function(){return this.$store.state.site.info.attributes||{}},canCreateThreadPaid:function(){return!(!this.forums||!this.forums.other)&&this.forums.other.can_create_thread_paid},canUploadAttachments:function(){return!(!this.forums||!this.forums.other)&&this.forums.other.can_upload_attachments},attachedSizeLimit:function(){return this.forums.set_attach?1024*this.forums.set_attach.support_max_size*1024:10485760},imageTypeLimit:function(){return this.forums.set_attach?this.forums.set_attach.support_img_ext.split(",").map((function(t){return".".concat(t)})).join(","):""},attachedTypeLimit:function(){return this.forums.set_attach?this.forums.set_attach.support_file_ext.split(",").map((function(t){return".".concat(t)})).join(","):""},isPost:function(){return this.typeInformation&&1===this.typeInformation.type||!1}},watch:{editResourceShow:{handler:function(t){if(t)for(var e in t)this[e]=t[e]},deep:!0,immediate:!0},typeInformation:{handler:function(t){t&&(this.actions[0].show=t.showEmoji,this.actions[1].show=t.showCaller,this.actions[2].show=t.showTopic,this.resources[0].show=t.showImage,this.resources[1].show=t.showVideo)},deep:!0,immediate:!0}},mounted:function(){this.textarea&&this.autoHeight(),this.emojiListener()},methods:{onPostContentChange:function(t,e){var n=Object.assign({},this.post);n[t]=e,this.$emit("update:post",n)},onPaymentChange:function(t,e){var n=Object.assign({},this.payment);n[t]=e,this.$emit("update:payment",n)},onQuestionChange:function(t,e){var n=Object.assign({},this.question);n[t]=e,this.$emit("update:question",n)},onProductChange:function(t){var e=Object.assign({},t);this.$emit("update:product",e)},autoHeight:function(){"chat"!==this.editorStyle&&(this.post.text.length>310&&(this.textarea.style.height="180px"),this.textarea.onkeyup=function(){var t=document.scrollingElement.scrollTop;this.style.height="auto",this.style.height="".concat(this.scrollHeight,"px"),document.scrollingElement.scrollTop=t})},getSelection:function(){this.selectionStart=this.textarea.selectionStart,this.selectionEnd=this.textarea.selectionEnd},emojiListener:function(){var t=this;document.addEventListener("click",(function(e){var n=!0;(e.path||e.composedPath&&e.composedPath()).forEach((function(t){t.classList&&(t.classList.contains("emoji-list")||t.classList.contains("topic-list")||t.classList.contains("editor-bar"))&&(n=!1)})),n&&(t.showTopic=!1,t.showEmoji=!1)}))},onActions:function(t){var e=this;this.hideActions(),setTimeout((function(){e[t]=!e[t]}))},addResource:function(t){this[t]=!0},selectActions:function(code){this.getSelection();var t=this.post.text.slice(0,this.selectionStart)+code+this.post.text.slice(this.selectionStart,this.post.text.length);this.onPostContentChange("text",t),this.hideActions()},hideActions:function(){this.showEmoji=!1,this.showTopic=!1,this.showCaller=!1},publish:function(){return this.onUploadAttached?this.$message.warning(this.$t("post.pleaseWaitForTheAttachedUploadToComplete")):this.onUploadImage?this.$message.warning(this.$t("post.pleaseWaitForTheImageUploadToComplete")):this.onUploadVideo?this.$message.warning(this.$t("post.pleaseWaitForTheVideoUploadToComplete")):(this.$emit("update:onPublish",!0),void this.$emit("publish"))}}},l=(n(818),n(12)),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[t.userId&&0===t.userId?n("div",{staticClass:"not-logged"},[n("span",[t._v(t._s(t.$t("post.publishAfterLogin")))])]):t._e(),t._v(" "),t.typeInformation&&t.typeInformation.showTitle?n("label",[n("input",{staticClass:"input-title",attrs:{placeholder:t.$t("post.pleaseInputPostTitle"),type:"text"},domProps:{value:t.post&&t.post.title},on:{input:function(e){return t.onPostContentChange("title",e.target.value)}}})]):t._e(),t._v(" "),t.typeInformation&&5===t.typeInformation.type?n("editor-qa",{attrs:{question:t.question},on:{paymentTypeChange:function(e){return t.onQuestionChange("paymentType",e)},isAnonymousChange:function(e){return t.onQuestionChange("isAnonymous",e)},isOnlookerChange:function(e){return t.onQuestionChange("isOnlooker",e)},beUserChange:function(e){return t.onQuestionChange("beUser",e)}}}):t._e(),t._v(" "),t.typeInformation&&6===t.typeInformation.type?n("editor-product",{attrs:{product:t.product},on:{productChange:t.onProductChange}}):t._e(),t._v(" "),t.typeInformation&&t.typeInformation.showPayment&&t.canCreateThreadPaid?n("editor-payment",{attrs:{payment:t.payment||{},type:t.typeInformation&&t.typeInformation.type,"can-upload-attachments":t.canUploadAttachments},on:{paymentChange:function(e){return t.onPaymentChange(e.key,e.value)}}}):t._e(),t._v(" "),t.isPost&&t.canUploadAttachments?n("attachment-upload",{attrs:{"file-list":t.post&&t.post.attachedList,"on-upload":t.onUploadAttached,action:"/attachments",accept:t.attachedTypeLimit,limit:99999,type:0,"size-limit":t.attachedSizeLimit},on:{"update:onUpload":function(e){t.onUploadAttached=e},"update:on-upload":function(e){t.onUploadAttached=e},success:function(e){return t.onPostContentChange("attachedList",e)},remove:function(e){return t.onPostContentChange("attachedList",e)}}}):t._e(),t._v(" "),t.isPost?n("Vditor",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit,"text-length":t.post&&t.post.text&&t.post.text.length,placeholder:t.typeInformation&&t.typeInformation.placeholder,"image-accept":t.imageTypeLimit,text:t.post&&t.post.text,"show-caller":t.showCaller,"show-topic":t.showTopic,"show-emoji":t.showEmoji,"is-edit":t.isEdit,"on-publish":t.onPublish,"attachment-size-limit":t.attachedSizeLimit,"on-upload-image":t.onUploadImage},on:{"update:onUploadImage":function(e){t.onUploadImage=e},"update:on-upload-image":function(e){t.onUploadImage=e},textChange:function(e){return t.onPostContentChange("text",e)},close:function(e){t.showCaller=!1},hideActions:t.hideActions,onActions:t.onActions,publish:t.publish}}):t._e(),t._v(" "),t.isPost?t._e():n("div",{class:["container-textarea",t.editorStyle]},["post"===t.editorStyle?n("editor-tool-bar",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit,"text-length":t.post&&t.post.text&&t.post.text.length,actions:t.actions,"show-emoji":t.showEmoji,"show-topic":t.showTopic,"show-caller":t.showCaller,resources:t.resources,"on-publish":t.onPublish,"editor-style":t.editorStyle},on:{publish:t.publish,selectActions:t.selectActions,addResource:t.addResource,hidePop:t.hideActions,onActions:t.onActions}}):t._e(),t._v(" "),n("label",[n("textarea",{class:["input-text",t.editorStyle],attrs:{id:"textarea",placeholder:t.typeInformation?t.typeInformation.placeholder:"",maxlength:t.post&&t.post.textLimit},domProps:{value:t.post&&t.post.text},on:{input:function(e){return t.onPostContentChange("text",e.target.value)}}})]),t._v(" "),n("div",[t.showUploadImg||t.showUploadVideo?n("div",{staticClass:"resources-list"},[t.showUploadImg?n("image-upload",{attrs:{type:t.typeInformation.type&&15===t.typeInformation.type?5:1,"file-list":t.post&&t.post.imageList,"on-upload":t.onUploadImage,action:"/attachments",accept:t.imageTypeLimit,limit:9,"size-limit":t.attachedSizeLimit},on:{"update:onUpload":function(e){t.onUploadImage=e},"update:on-upload":function(e){t.onUploadImage=e},success:function(e){return t.onPostContentChange("imageList",e)},remove:function(e){return t.onPostContentChange("imageList",e)}}}):t._e(),t._v(" "),t.showUploadVideo?n("video-upload",{attrs:{"on-upload-video":t.onUploadVideo,"video-list":t.post&&t.post.videoList},on:{"update:onUploadVideo":function(e){t.onUploadVideo=e},"update:on-upload-video":function(e){t.onUploadVideo=e},videoChange:function(e){return t.onPostContentChange(e.key,e.value)}}}):t._e()],1):t._e(),t._v(" "),"post"!==t.editorStyle?n("editor-tool-bar",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit||450,"text-length":t.post&&t.post.text&&t.post.text.length||0,actions:t.actions,"show-emoji":t.showEmoji,"show-topic":t.showTopic,"show-caller":t.showCaller,resources:t.resources,"on-publish":t.onPublish,"editor-style":t.editorStyle},on:{publish:t.publish,selectActions:t.selectActions,addResource:t.addResource,hidePop:t.hideActions,onActions:t.onActions}}):t._e()],1)],1),t._v(" "),t.showCaller&&!t.isPost?n("caller",{on:{close:function(e){t.showCaller=!1},selectedCaller:t.selectActions}}):t._e()],1)}),[],!1,null,"4439b281",null);e.default=component.exports;installComponents(component,{EditorQa:n(833).default,EditorProduct:n(834).default,EditorPayment:n(835).default,AttachmentUpload:n(815).default,Vditor:n(832).default,EditorToolBar:n(836).default,ImageUpload:n(816).default,VideoUpload:n(837).default,Caller:n(794).default})},802:function(t,e){},803:function(t,e,n){"use strict";n.r(e);var o={name:"UserItem",props:{item:{type:Object,default:function(){}},show:{type:String,default:"all"},isFollow:{type:Boolean,default:!1}},data:function(){return{}},methods:{toUser:function(){this.$router.push("/user/".concat(this.item.id))}}},r=(n(812),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-item-container",class:{simple:"simple"===t.show}},[n("div",{staticClass:"flex user-item",on:{click:function(e){return e.stopPropagation(),t.toUser(e)}}},[n("avatar",{attrs:{user:t.item,size:"simple"===t.show?40:45}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"flex"},[n("span",{staticClass:"name text-hidden"},[t._v(t._s(t.item.username))]),t._v(" "),"all"===t.show&&t.item.groupName?n("span",{staticClass:"role"},[t._v(t._s(t.item.groupName))]):t._e()]),t._v(" "),n("div",{staticClass:"flex count"},["all"===t.show?n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.topic"))+" "+t._s(t.item.threadCount||0))]):t._e(),t._v(" "),"all"===t.show?n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.following"))+" "+t._s(t.item.followCount||0))]):t._e(),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.followers"))+" "+t._s(t.item.fansCount||0))])])])],1),t._v(" "),t.isFollow?n("el-button",{staticClass:"follow",attrs:{type:"text"}},[t._v("\n    "+t._s(t.$t("profile.following"))+"\n  ")]):t._e()],1)}),[],!1,null,"15aefb24",null);e.default=component.exports;installComponents(component,{Avatar:n(268).default})},804:function(t,e,n){"use strict";var o=n(751);n.n(o).a},805:function(t,e,n){"use strict";n(51);e.a=function(t){return t[0]===t[1]&&"0"===t[0]&&(t=t.substr(0,1)),t.replace(/[^\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3").replace(/^\./g,"")}},806:function(t,e,n){"use strict";var o=n(752);n.n(o).a},807:function(t,e,n){"use strict";var o=n(753);n.n(o).a},812:function(t,e,n){"use strict";var o=n(754);n.n(o).a},814:function(t,e,n){"use strict";var o=n(755);n.n(o).a},815:function(t,e,n){"use strict";n.r(e);n(61),n(267);var o=n(732),r=n.n(o),l=n(782),c=n.n(l),d=n(745),h=n(783),f=n.n(h),m=n(33),v={name:"AttachmentUpload",mixins:[r.a,c.a,f.a],props:{action:{type:String,default:"",required:!0},fileList:{type:Array,default:function(){return[]},required:!0},accept:{type:String,default:""},limit:{type:Number,default:9999},sizeLimit:{type:Number,default:1e17},onUpload:{type:Boolean,default:!1},addTips:{type:String,default:""},type:{type:Number,default:0}},data:function(){return{previewFiles:[],currentInput:""}},computed:{input:function(){return document.getElementById("upload")},service:function(){return m.a}},methods:{onClick:function(){var t=this.$refs.uploadFile;this.currentInput=t,this.uploaderFile(t)},extensionValidate:function(t){var e=t.split(".")[t.split(".").length-1];return d.extensionList.indexOf(e.toUpperCase())>0?e.toUpperCase():"UNKNOWN"}}},_=(n(806),n(12)),component=Object(_.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"container-upload"},[n("div",{staticClass:"upload"},[n("span",{staticClass:"attachment-list"},[t._v(t._s(t.$t("post.attachmentList")))]),t._v(" "),n("span",{staticClass:"add-attachment",on:{click:t.onClick}},[t._v(t._s(t.addTips||t.$t("post.addAttachment")))]),t._v(" "),n("input",{ref:"uploadFile",attrs:{id:"upload",accept:t.accept,type:"file",multiple:""},on:{input:t.onInput}})]),t._v(" "),t._l(t.previewFiles,(function(e,o){return n("div",{key:o,class:{"preview-item":!0,deleted:e.deleted}},[n("div",{staticClass:"container-item"},[n("div",{staticClass:"info"},[n("svg-icon",{staticStyle:{"font-size":"18px","vertical-align":"middle"},attrs:{type:t.extensionValidate(e.name)}}),t._v(" "),n("span",{class:{"file-name":!0,uploading:e.progress<100}},[t._v(t._s(e.name))])],1),t._v(" "),n("span",{staticClass:"size"},[t._v(t._s(parseInt((e.size/1024).toString()).toLocaleString())+"\n        KB")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.progress<100,expression:"file.progress < 100"}],staticClass:"progress",style:{width:e.progress+"%"}})]),t._v(" "),n("div",{staticClass:"remove"},[n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:e.progress&&100===e.progress,expression:"file.progress && file.progress === 100"}],staticClass:"remove-icon",attrs:{type:"delete"},on:{click:function(e){return t.removeItem(o)}}})],1)])}))],2)}),[],!1,null,"48bd9f36",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default})},816:function(t,e,n){"use strict";n.r(e);n(267);var o=n(732),r=n.n(o),l=n(782),c=n.n(l),d=n(783),h=n.n(d),f=n(33),m={name:"ImageUpload",mixins:[r.a,c.a,h.a],props:{action:{type:String,default:"",required:!0},fileList:{type:Array,default:function(){return[]},required:!0},accept:{type:String,default:""},limit:{type:Number,default:9999},sizeLimit:{type:Number,default:1e17},onUpload:{type:Boolean,default:!1},type:{type:Number,default:0}},data:function(){return{previewFiles:[],currentInput:""}},computed:{input:function(){return document.getElementById("upload")},service:function(){return f.a}},methods:{onClick:function(){var t=this.$refs.uploadImage;this.currentInput=t,this.uploaderFile(t)}}},v=(n(807),n(12)),component=Object(v.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"container-upload"},[t._l(t.previewFiles,(function(image,e){return n("div",{key:e,class:{"preview-item":!0,deleted:image.deleted}},[n("img",{attrs:{src:image.url,alt:""}}),t._v(" "),n("el-progress",{directives:[{name:"show",rawName:"v-show",value:image.progress<100,expression:"image.progress < 100"}],staticClass:"progress",attrs:{percentage:image.progress,color:"#25A9F6","show-text":!1}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:image.progress<100,expression:"image.progress < 100"}],staticClass:"cover"},[t._v("图片上传中...")]),t._v(" "),n("div",{class:{"upload-delete":!0,"show-delete":100===image.progress},on:{click:function(n){return t.removeItem(e)}}},[n("svg-icon",{staticStyle:{"font-size":"14px",fill:"white"},attrs:{type:"delete"}})],1)],1)})),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.previewFiles.length<t.limit,expression:"previewFiles.length < limit"}],staticClass:"upload",on:{click:function(e){return t.onClick(e)}}},[n("input",{ref:"uploadImage",attrs:{id:"upload",accept:t.accept,type:"file",multiple:""},on:{input:t.onInput}}),t._v(" "),n("svg-icon",{staticClass:"upload-icon",attrs:{type:"add"}})],1)],2)}),[],!1,null,"7eca05fc",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default})},817:function(t,e,n){"use strict";n.r(e);n(27),n(11);var o=n(732),r={name:"RecommendUser",mixins:[n.n(o).a],props:{list:{type:Array,default:function(){return[]}}},data:function(){return{userList:[],loading:!1,pageNum:1,pageSize:4}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{list:{handler:function(t){this.userList=t},deep:!0}},mounted:function(){0===this.list.length?this.getList():this.userList=this.list},methods:{getList:function(){var t=this;this.userList=[],this.loading=!0;var e={include:"groups",limit:this.pageSize};this.$store.dispatch("jv/get",["users/recommended",{params:e}]).then((function(e){var data=e;e&&Array.isArray(e)&&data.forEach((function(t,i){data[i].groupName=t.groups[0]?t.groups[0].name:""})),t.userList=data}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},refresh:function(){this.getList()}}},l=(n(814),n(12)),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"recommend-user-container"},[n("div",{staticClass:"recommend-user-title"},[t._v(t._s(t.$t("home.recommentUser")))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"recommend-user-list"},[t._l(t.userList,(function(t,e){return n("user-item",{key:e,attrs:{item:t,show:"simple"}})})),t._v(" "),0===t.userList.length?n("div",{staticClass:"no-more"},[t._v(t._s(t.$t("discuzq.list.noData")))]):t._e()],2),t._v(" "),n("div",{staticClass:"refresh",on:{click:t.refresh}},[n("svg-icon",{staticClass:"icon",attrs:{type:"refresh"}}),t._v("\n    "+t._s(t.$t("home.refresh"))+"\n  ")],1)])}),[],!1,null,"ccf1d846",null);e.default=component.exports;installComponents(component,{UserItem:n(803).default,SvgIcon:n(60).default})},818:function(t,e,n){"use strict";var o=n(758);n.n(o).a},819:function(t,e,n){"use strict";var o=n(759);n.n(o).a},820:function(t,e,n){"use strict";var o=n(760);n.n(o).a},821:function(t,e,n){"use strict";var o=n(761);n.n(o).a},822:function(t,e,n){"use strict";var o=n(762);n.n(o).a},823:function(t,e,n){"use strict";var o=n(763);n.n(o).a},824:function(t,e,n){"use strict";var o=n(764);n.n(o).a},825:function(t,e,n){"use strict";var o=n(765);n.n(o).a},826:function(t,e,n){"use strict";var o=n(766);n.n(o).a},827:function(t,e,n){"use strict";var o=n(767);n.n(o).a},828:function(t,e,n){"use strict";var o=n(768);n.n(o).a},829:function(t,e,n){"use strict";var o=n(769);n.n(o).a},830:function(t,e,n){"use strict";var o=n(770);n.n(o).a},831:function(t,e,n){"use strict";var o=n(771);n.n(o).a},832:function(t,e,n){"use strict";n.r(e);n(17),n(36),n(11),n(267);var o=n(33),r=n(732),l=n.n(r),c=n(863),d={name:"Vditor",mixins:[l.a],props:{showCaller:{type:Boolean,default:!1},showTopic:{type:Boolean,default:!1},showEmoji:{type:Boolean,default:!1},text:{type:String,default:""},textLimit:{type:[Number,String],default:49999},textLength:{type:[Number,String],default:0},isEdit:{type:Boolean,default:!1},attachmentSizeLimit:{type:Number,default:1e21},imageAccept:{type:String,default:""},onUploadImage:{type:Boolean,default:!1},placeholder:{type:String,default:""},onPublish:{type:Boolean,default:!1}},data:function(){return{vditor:{},input:{},range:[],afterVditorInit:!1}},watch:{isEdit:{handler:function(t){t&&this.text&&this.setDefaultValue()},immediate:!0}},mounted:function(){c&&this.initVditor()},methods:{initVditor:function(){var t=this;this.vditor=new c("vditor",{minHeight:450,placeholder:this.placeholder,mode:"wysiwyg",tab:"    ",input:function(e){t.$emit("textChange",e)},toolbar:[{hotkey:"",name:"@",tipPosition:"ne",tip:"@ 好友",className:"right",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="19.816" height="19.816" viewBox="0 0 19.816 19.816">\n   <path id="路径_965" data-name="路径 965" d="M67.565,65.963c0,6.137,4.261,9.862,10.128,9.862a14.524,14.524,0,0,0,4.032-.512c.66-.2.87-.54.87-.884a.611.611,0,0,0-.64-.606,1.994,1.994,0,0,0-.449.065A13.894,13.894,0,0,1,78,74.353c-5.236,0-8.79-3.073-8.79-8.334,0-5.038,3.363-8.549,8.427-8.549,4.481,0,8.227,2.691,8.227,7.525,0,2.821-.984,4.721-2.551,4.721a1.489,1.489,0,0,1-1.653-1.611V61.792a.727.727,0,0,0-.764-.811.741.741,0,0,0-.784.811v1.061h-.086a3.258,3.258,0,0,0-3.1-1.871c-2.474,0-4.214,2.058-4.214,5.009,0,2.98,1.729,5.057,4.252,5.057a3.3,3.3,0,0,0,3.172-2.1h.086a2.6,2.6,0,0,0,2.838,2.114c2.666,0,4.319-2.551,4.319-6.127,0-5.411-4.09-8.921-9.727-8.921-5.933,0-10.089,3.957-10.089,9.955Zm9.66,3.613c-1.72,0-2.8-1.387-2.8-3.595,0-2.169,1.089-3.557,2.809-3.557,1.748,0,2.857,1.36,2.857,3.52,0,2.207-1.128,3.632-2.866,3.632Z" transform="translate(-67.565 -56.008)" fill="#777"/>\n</svg>',click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showCaller")}},{hotkey:"",name:"#",tipPosition:"ne",tip:"新增话题",className:"right",icon:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1598001954510" class="icon" viewBox="0 0 1040 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5506" xmlns:xlink="http://www.w3.org/1999/xlink" width="203.125" height="200"><defs><style type="text/css"></style></defs><path d="M947.393251 679.125345 674.853042 679.125345l143.716192-556.918026c3.51915-13.677511-4.727675-27.656897-18.411325-31.184233-13.644765-3.545756-27.646664 4.678556-31.214932 18.386766L721.04713 295.052946 364.271424 295.052946l44.60694-172.84051c3.527336-13.675464-4.727675-27.646664-18.402115-31.174-13.661138-3.553942-27.65485 4.678556-31.208792 18.378579l-47.900963 185.645141L76.8022 295.062156c-14.114462 0-25.594935 11.480472-25.594935 25.603121 0 14.155395 11.488659 25.596981 25.594935 25.596981L298.143331 346.262258l-85.904509 332.872297L25.611308 679.134555c-14.130835 0-25.611308 11.480472-25.611308 25.603121 0 14.155395 11.488659 25.596981 25.611308 25.596981l173.439144 0-44.60694 172.830277c-3.527336 13.691837 4.694929 27.65485 18.394952 31.214932 2.156106 0.551562 4.304026 0.791016 6.402827 0.791016 11.408841 0 21.828145-7.656377 24.805966-19.199271l147.026588-569.732889 356.768543 0L621.937878 679.117159 384.087749 679.117159c-14.155395 0-25.596981 11.480472-25.596981 25.594935 0 14.163581 11.441587 25.605168 25.596981 25.605168l224.645386 0-44.604894 172.830277c-3.521197 13.691837 4.733814 27.65485 18.409279 31.216979 2.156106 0.541329 4.312212 0.788969 6.427386 0.788969 11.376095 0 21.779026-7.656377 24.781406-19.199271l47.900963-185.645141 285.769512 0c14.155395 0 25.594935-11.449773 25.594935-25.596981 0-14.130835-11.455913-25.611308-25.611308-25.611308L947.393251 679.125345zM998.617913 295.052946 896.193149 295.052946c-14.155395 0-25.594935 11.480472-25.594935 25.594935 0 14.155395 11.43954 25.596981 25.594935 25.596981l102.424764 0c14.153348 0 25.594935-11.441587 25.594935-25.596981C1024.212848 306.517045 1012.771261 295.052946 998.617913 295.052946L998.617913 295.052946zM998.617913 295.052946" p-id="5507" fill="#333" ></path></svg>',click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showTopic")}},{hotkey:"",name:"my-emoji",tipPosition:"ne",tip:"插入表情",className:"right",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="19.819" height="19.816" viewBox="0 0 19.819 19.816">\n  <path id="路径_964" data-name="路径 964" d="M9.909,19.816A9.908,9.908,0,0,1,2.9,2.9,9.91,9.91,0,0,1,16.92,16.914a9.855,9.855,0,0,1-7.011,2.9Zm0-18.525A8.618,8.618,0,0,0,3.815,16,8.62,8.62,0,0,0,16.007,3.814a8.566,8.566,0,0,0-6.1-2.523ZM6.389,12.612a4.334,4.334,0,0,0,3.52,1.856,5.563,5.563,0,0,0,3.906-1.856.873.873,0,0,1,.876.928,5.954,5.954,0,0,1-4.782,2.165A4.649,4.649,0,0,1,5.586,13.54s-.032-.928.8-.928Zm.64-5.89A1.213,1.213,0,1,0,8.243,7.936,1.215,1.215,0,0,0,7.029,6.722Zm6.219,0a1.213,1.213,0,1,0,1.214,1.214,1.214,1.214,0,0,0-1.214-1.214Z" transform="translate(0)" fill="#777"/>\n</svg>',click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showEmoji")}},"headings","bold","italic","strike","link","list","ordered-list","check","outdent","indent","quote",{hotkey:"",name:"picture",tipPosition:"ne",tip:"插入图片",className:"right",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="19.816" height="19.816" viewBox="0 0 19.816 19.816">\n  <path id="路径_1180" data-name="路径 1180" d="M120.154,104.877a2.477,2.477,0,1,0,2.477,2.477,2.484,2.484,0,0,0-2.477-2.477Zm0,3.716a1.239,1.239,0,1,1,1.239-1.239A1.242,1.242,0,0,1,120.154,108.593Zm12.385-6.193H117.677a2.484,2.484,0,0,0-2.477,2.477v14.862a2.484,2.484,0,0,0,2.477,2.477h14.862a2.484,2.484,0,0,0,2.477-2.477V104.877A2.484,2.484,0,0,0,132.539,102.4Zm-14.862,18.578a1.242,1.242,0,0,1-1.238-1.238v-.557l4.892-4.4,6.254,6.193Zm16.1-1.238a1.242,1.242,0,0,1-1.239,1.238h-3.22l-4.521-4.644,5.264-5.264,3.716,3.716Zm0-6.75-3.716-3.777-6.131,6.254-2.539-2.539-4.954,4.521V104.877a1.242,1.242,0,0,1,1.238-1.238h14.862a1.242,1.242,0,0,1,1.239,1.238Z" transform="translate(-115.2 -102.4)" fill="#777"/>\n</svg>\n',click:function(){t.uploader()}},"line","code","inline-code","table","both","br","undo","redo"],toolbarConfig:{pin:!0},cache:{enable:!1},after:function(){t.afterVditorInit=!0}})},uploader:function(){var t=this;if(this.onUploadImage)return this.$message.warning("请等待上传中的图片完成上传");this.input=document.createElement("input"),this.input.type="file",this.input.multiple=!0,this.input.accept=this.imageAccept,this.input.dispatchEvent(new MouseEvent("click")),this.input.oninput=function(e){var n=e.target.files,o=[];if(t.checkSizeLimit(n)){for(var i=0;i<n.length;i++)o.push(n[i]);var r=o.reduce((function(e,n){return e.push(t.uploadFile(n)),e}),[]);t.uploadFiles(r)}}},uploadFile:function(t){var e=new FormData;return e.append("type",1),e.append("file",t),o.a.post("/attachments",e)},uploadFiles:function(t){var e=this;this.$emit("update:onUploadImage",!0),Promise.all(t).then((function(t){t.map((function(t){return t.data.data})).forEach((function(t){var html='<img src="'.concat(t.attributes.url,'" alt="').concat(t.attributes.fileName,'" title="').concat(t.id,'">'),n=e.vditor.html2md(html);e.vditor.insertValue(n.substr(0,n.length-1))})),e.input.value=""}),(function(t){e.input.value="",e.handleError(t).then((function(){}))})).finally((function(){e.$emit("update:onUploadImage",!1)}))},selectActions:function(code){var t=window.getSelection();t.removeAllRanges(),t.addRange(this.range),this.vditor.insertValue(code),this.$emit("hideActions")},checkSizeLimit:function(t){for(var e=!0,i=0;i<t.length;i++)t[i].size>this.attachmentSizeLimit&&(e=!1);return e||this.$message.error("图片大小不可超过 ".concat(this.attachmentSizeLimit/1024/1024," MB")),e},publish:function(){var t=this.vditor.getValue();this.$emit("textChange",t),this.$emit("publish")},setDefaultValue:function(){this.afterVditorInit?this.vditor.setValue(this.text,!1):setTimeout(this.setDefaultValue,100)}}},h=(n(825),n(12)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.onUploadImage,expression:"onUploadImage"}],staticClass:"vditor-container",attrs:{"element-loading-background":"hsla(0,0%,100%,0.6)"}},[n("div",{staticClass:"sticky-box"},[n("topic-list",{directives:[{name:"show",rawName:"v-show",value:t.showTopic,expression:"showTopic"}],staticClass:"action-vditor",on:{selectedTopic:t.selectActions}}),t._v(" "),n("emoji-list",{directives:[{name:"show",rawName:"v-show",value:t.showEmoji,expression:"showEmoji"}],staticClass:"action-vditor",on:{selectEmoji:t.selectActions}})],1),t._v(" "),n("div",{attrs:{id:"vditor"}}),t._v(" "),t.textLimit?n("span",{staticClass:"tip"},[t._v(t._s(t.textLimit>=t.textLength?t.$t("post.note",{num:t.textLimit-t.textLength}):t.$t("post.exceed",{num:t.textLength-t.textLimit})))]):t._e(),t._v(" "),t.showCaller?n("caller",{on:{close:function(e){return t.$emit("close")},selectedCaller:t.selectActions}}):t._e(),t._v(" "),n("el-button",{staticClass:"button-publish",attrs:{loading:t.onPublish,type:"primary",size:"small"},on:{click:t.publish}},[t._v(t._s(t.$t("post.post")))])],1)}),[],!1,null,"76b61930",null);e.default=component.exports;installComponents(component,{TopicList:n(795).default,EmojiList:n(796).default,Caller:n(794).default})},833:function(t,e,n){"use strict";n.r(e);var o=n(750),r={name:"EditorQa",mixins:[n.n(o).a],props:{question:{type:Object,default:function(){}}},data:function(){return{beAskedUser:{},showQACaller:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},canSetOnlooker:function(){return!!(this.forums&&this.forums.other&&this.forums.other.can_be_onlooker)&&this.forums.other.can_be_onlooker},siteOnlookerPrice:function(){return this.forums&&this.forums.set_site?this.forums.set_site.site_onlooker_price:""},siteMasterScale:function(){return this.forums&&this.forums.set_site?this.forums.set_site.site_master_scale/10:""},siteUserScale:function(){return this.siteMasterScale?1-this.siteMasterScale:""}},watch:{question:{handler:function(t){t.beUser&&(this.beAskedUser=t.beUser)},deep:!0,immediate:!0}},mounted:function(){this.question.beUser&&(this.beAskedUser=this.question.beUser)},methods:{selectedQaCaller:function(t){this.beAskedUser=t,this.showQACaller=!1,this.$emit("beUserChange",t)}}},l=(n(819),n(12)),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qa"},[n("div",{staticClass:"qa-payment block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.questionMode"))+":")]),t._v(" "),n("el-radio",{attrs:{value:t.question.paymentType,label:"free"},on:{input:function(e){return t.$emit("paymentTypeChange",e)}}},[t._v(t._s(t.$t("post.freeWatch")))]),t._v(" "),n("el-radio",{attrs:{value:t.question.paymentType,label:"paid"},on:{input:function(e){return t.$emit("paymentTypeChange",e)}}},[t._v(t._s(t.$t("post.paidWatch")))])],1),t._v(" "),n("div",{staticClass:"qa-anonymous block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.anonymous"))+":")]),t._v(" "),n("el-switch",{attrs:{value:t.question.isAnonymous,"active-color":"#1878F3"},on:{input:function(e){return t.$emit("isAnonymousChange",e)}}})],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.canSetOnlooker,expression:"canSetOnlooker"}],staticClass:"qa-onlooker block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.onLooker"))+":")]),t._v(" "),n("el-switch",{attrs:{value:t.question.isOnlooker,"active-color":"#1878F3"},on:{input:function(e){return t.$emit("isOnlookerChange",e)}}}),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.siteOnlookerPrice&&t.siteMasterScale&&t.siteUserScale,expression:"siteOnlookerPrice && siteMasterScale && siteUserScale"}],staticClass:"tip"},[n("span",[t._v(t._s("他人围观需付费 "+t.siteOnlookerPrice+" 元"))]),t._v(" "),n("span",[t._v(t._s("（你得 "+(t.siteOnlookerPrice*t.siteUserScale/2).toFixed(2)+" 元\n        ，回答者得 "+(t.siteOnlookerPrice*t.siteUserScale/2).toFixed(2)+" 元\n        ，平台得 "+(t.siteOnlookerPrice*t.siteMasterScale).toFixed(2)+" 元）"))])])],1),t._v(" "),n("div",{staticClass:"qa-answerer block"},[n("div",{staticClass:"title"},[n("span",[t._v(t._s(t.$t("post.questionHim"))+":")]),t._v(" "),n("span",{staticClass:"select-answerer",on:{click:function(e){t.showQACaller=!0}}},[t._v("\n        "+t._s(Object.keys(t.beAskedUser).length>0?t.$t("post.changeBeAskedUser"):t.$t("post.addBeAskedUser"))+"\n      ")])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.beAskedUser).length>0,expression:"Object.keys(beAskedUser).length > 0"}],staticClass:"be-asked-user"},[n("avatar-component",{attrs:{author:t.beAskedUser,size:50,round:""}},[t._v("\n        "+t._s(t.$t("topic.activeAt"))+" "+t._s(t.timerDiff(t.beAskedUser.updatedAt))+t._s(t.$t("topic.before"))+"\n      ")])],1)]),t._v(" "),t.showQACaller?n("qa-caller",{on:{close:function(e){t.showQACaller=!1},selectedQaCaller:t.selectedQaCaller}}):t._e()],1)}),[],!1,null,"2d9ab75f",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(786).default,QaCaller:n(838).default})},834:function(t,e,n){"use strict";n.r(e);n(52),n(28),n(17),n(11),n(39);var o=n(9),r=n(750);function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var c={name:"EditorProduct",mixins:[n.n(r).a],props:{product:{type:Object,default:function(){}}},data:function(){return{addedProduct:{},showProductDialog:!1,typeList:{1:"product-tmall",2:"product-jd",3:"product-pinduoduo",5:"product-taobao",7:"product-youzan"}}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{product:{handler:function(t){this.addedProduct=t},deep:!0}},mounted:function(){this.addedProduct=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},this.product)},methods:{inputedLink:function(t){this.addedProduct=t,this.showProductDialog=!1,this.$emit("productChange",t)},remove:function(){this.addedProduct={},this.$emit("productChange",this.addedProduct)}}},d=(n(822),n(12)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"product-container"},[n("div",{staticClass:"block"},[n("div",{staticClass:"title"},[n("span",[t._v(t._s(t.$t("permission.createThreadGoods"))+":")]),t._v(" "),n("span",{staticClass:"select-product",on:{click:function(e){t.showProductDialog=!0}}},[t._v("\n        "+t._s(Object.keys(t.addedProduct).length>0?"":"+"+t.$t("post.addProduct"))+"\n      ")])]),t._v(" "),Object.keys(t.addedProduct).length>0?n("div",{staticClass:"product-info"},[n("el-image",{staticClass:"image",attrs:{src:t.addedProduct.image_path}}),t._v(" "),n("div",{staticClass:"right"},[n("div",{staticClass:"title"},[t.typeList[t.addedProduct.type]&&t.addedProduct.title?n("svg-icon",{staticClass:"icon",attrs:{type:t.typeList[t.addedProduct.type]}}):t._e(),t._v("\n          "+t._s(t.addedProduct.title)+"\n        ")],1),t._v(" "),n("div",{staticClass:"bottom"},[n("span",{staticClass:"price"},[t._v(t._s(t.addedProduct.price>0?t.$t("post.yuanItem")+t.addedProduct.price+t.$t("post.yuan"):""))]),t._v(" "),n("svg-icon",{staticClass:"icon",attrs:{type:"delete"},on:{click:t.remove}})],1)])],1):t._e()]),t._v(" "),t.showProductDialog?n("product-dialog",{on:{close:function(e){t.showProductDialog=!1},inputedLink:t.inputedLink}}):t._e()],1)}),[],!1,null,"23da471e",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default,ProductDialog:n(839).default})},835:function(t,e,n){"use strict";n.r(e);n(267);var o=n(805),r={name:"EditorPayment",props:{payment:{type:Object,default:function(){}},type:{type:Number,default:0},canUploadAttachments:{type:Boolean,default:!1}},data:function(){return{freeWords:0,price:0,attachmentPrice:0,options:[{value:"free",label:this.$t("post.freeWatch")},{value:"paid",label:this.$t("post.paidWatch")}],freeWordsOptions:[{value:0,label:"0%"},{value:.1,label:"10%"},{value:.3,label:"30%"},{value:.5,label:"50%"},{value:.7,label:"70%"},{value:1,label:"100%"}]}},watch:{payment:{handler:function(t){this.freeWords=t.freeWords||0,this.price=t.price||0,this.attachmentPrice=t.attachmentPrice||0},immediate:!0,deep:!0},type:{handler:function(t){1===t&&this.canUploadAttachments&&this.options.push({value:"attachmentPaid",label:this.$t("post.postFreeAttachmentPaid")})},immediate:!0}},methods:{onPriceInput:function(t){this.price=Object(o.a)(t)},onAttachmentPriceInput:function(t){this.attachmentPrice=Object(o.a)(t)}}},l=(n(824),n(12)),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("div",{staticClass:"block"},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.isPay"))+":")]),t._v(" "),n("el-select",{attrs:{size:"medium",value:t.payment.paidType,placeholder:"请选择"},on:{change:function(e){return t.$emit("paymentChange",{key:"paidType",value:e})}}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("div",{staticClass:"block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"paid"===t.payment.paidType,expression:"payment.paidType === 'paid'"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.paymentAmount"))+":")]),t._v(" "),n("el-input",{attrs:{size:"medium",placeholder:"0",maxlength:"7"},on:{change:function(e){t.$emit("paymentChange",{key:"price",value:parseFloat(t.price)})},input:t.onPriceInput},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}},[n("span",{staticClass:"prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v("￥")])])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"attachmentPaid"===t.payment.paidType&&1===t.type,expression:"payment.paidType === 'attachmentPaid' && type === 1"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.paymentAmount"))+":")]),t._v(" "),n("el-input",{attrs:{size:"medium",placeholder:"0",maxlength:"7"},on:{change:function(e){t.$emit("paymentChange",{key:"attachmentPrice",value:parseFloat(t.attachmentPrice)})},input:t.onAttachmentPriceInput},model:{value:t.attachmentPrice,callback:function(e){t.attachmentPrice=e},expression:"attachmentPrice"}},[n("span",{staticClass:"prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v("￥")])])],1)]),t._v(" "),n("div",{staticClass:"block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"paid"===t.payment.paidType&&1===t.type,expression:"payment.paidType === 'paid' && type === 1"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.freeWord"))+":")]),t._v(" "),n("el-select",{attrs:{size:"medium",value:t.freeWords},on:{change:function(e){return t.$emit("paymentChange",{key:"freeWords",value:e})}}},t._l(t.freeWordsOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])])}),[],!1,null,"3241ff39",null);e.default=component.exports},836:function(t,e,n){"use strict";n.r(e);n(267);var o={name:"EditorToolBar",props:{actions:{type:Array,default:function(){return[]}},showEmoji:{type:Boolean,default:!1},showTopic:{type:Boolean,default:!1},resources:{type:Array,default:function(){return[]}},textLimit:{type:[Number,String],default:450},textLength:{type:[Number,String],default:0},onPublish:{type:Boolean,default:!1},editorStyle:{type:String,default:"post"}}},r=(n(829),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["editor-bar",t.editorStyle]},[n("div",{staticClass:"block"},[t._l(t.actions,(function(e,o){return[e.show&&"emoji"===e.icon?n("popover",{key:o,staticClass:"svg",attrs:{visible:t.showEmoji},on:{hidePop:function(e){return t.$emit("hidePop",e)}},scopedSlots:t._u([{key:"pop",fn:function(){return[n("emoji-list",{on:{selectEmoji:function(e){return t.$emit("selectActions",e)}}})]},proxy:!0},{key:"activeNode",fn:function(){return[n("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}})]},proxy:!0}],null,!0)}):t._e(),t._v(" "),e.show&&"topic"===e.icon?n("popover",{key:o,staticClass:"svg",attrs:{visible:t.showTopic},on:{hidePop:function(e){return t.$emit("hidePop",e)}},scopedSlots:t._u([{key:"pop",fn:function(){return[n("topic-list",{on:{selectedTopic:function(e){return t.$emit("selectActions",e)}}})]},proxy:!0},{key:"activeNode",fn:function(){return[n("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}})]},proxy:!0}],null,!0)}):e.show&&"call"===e.icon?n("svg-icon",{key:o,staticClass:"svg",staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}}):t._e()]}))],2),t._v(" "),n("div",{staticClass:"block"},[t._l(t.resources,(function(e,o){return[e.show?n("svg-icon",{key:o,staticClass:"svg",staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("addResource",e.toggle)}}}):t._e()]}))],2),t._v(" "),n("div",{staticClass:"publish-container"},[t.textLimit?n("span",{staticClass:"tip"},[t._v(t._s(t.textLimit>=t.textLength?t.$t("post.note",{num:t.textLimit-t.textLength}):t.$t("post.exceed",{num:t.textLength-t.textLimit})))]):t._e(),t._v(" "),n("el-button",{staticClass:"button-publish",attrs:{loading:t.onPublish,type:"primary",size:"small"},on:{click:function(e){return t.$emit("publish")}}},[t._v(t._s(t.$t("post.post")))])],1)])}),[],!1,null,"28cb2ba1",null);e.default=component.exports;installComponents(component,{EmojiList:n(796).default,SvgIcon:n(60).default,Popover:n(840).default,TopicList:n(795).default})},837:function(t,e,n){"use strict";n.r(e);n(11),n(27);var o=n(85),r=(n(61),n(864)),l={name:"VideoUpload",props:{videoList:{type:Array,default:function(){return[]}},onUploadVideo:{type:Boolean,default:!1}},data:function(){return{showVideoPop:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},sizeLimit:function(){return this.forums&&this.forums.qcloud?this.forums.qcloud.qcloud_vod_size:""},typesLimit:function(){return this.forums&&this.forums.qcloud?this.forums.qcloud.qcloud_vod_ext.split(",").map((function(t){return".".concat(t)})).join(","):""}},methods:{handleVideoRemove:function(){var t=this;return this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),type:this.$t("discuzq.msgBox.cancel"),typeInformation:"warning"}).then((function(){t.$refs.upload.clearFiles(),setTimeout((function(){t.$emit("videoChange",{key:"videoList",value:[]})}),1e3)}),(function(){}))},addVideo:function(t){var e=this;if(!this.onUploadVideo){if(this.sizeLimit&&t.raw.size>1024*this.sizeLimit*1024)return this.$message.error("".concat(this.$t("profile.filesizecannotexceed")+this.sizeLimit,"MB")),void this.$refs.upload.clearFiles();if(!this.videoTypeCheck(t))return this.$message.error("暂不支持此类型的视频"),void this.$refs.upload.clearFiles();this.$emit("update:onUploadVideo",!0);var n=Object(o.a)(this.videoList);n.push({name:t.name,url:t.url,videoPercent:0}),this.$emit("videoChange",{key:"videoList",value:n}),this.getSignature((function(o){new r.default({getSignature:o}).upload({mediaFile:t.raw}).on("media_progress",(function(t){n[0].videoPercent=t.percent,e.$emit("videoChange",{key:"videoList",value:n})})).done().then((function(t){e.postVideo(t.fileId)}))}))}},videoTypeCheck:function(t){var e=t.name.split(".")[t.name.split(".").length-1].toLowerCase();return!("m3u8"===e||this.typesLimit.indexOf(e.toLowerCase())<0)},getSignature:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$store.dispatch("jv/get",["signature",{}]).then((function(e){t((function(){return e.signature}))}))},postVideo:function(t){var e=this,n={_jv:{type:"thread/video"},file_id:t};this.$store.dispatch("jv/post",n).then((function(data){var t=Object(o.a)(e.videoList);t[0].id=data.file_id,e.$emit("videoChange",{key:"videoList",value:t})}),(function(t){return e.handleError(t)})).finally((function(){e.$emit("update:onUploadVideo",!1)}))},handleError:function(){this.$emit("update:onUploadVideo",!1),this.$message.error(this.$t("post.videoUploadFail"))}}},c=(n(831),n(12)),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.videoList[0]?n("div",{staticClass:"video-upload"},[n("video",{ref:"video",staticClass:"video",attrs:{src:t.videoList[0].url,controls:!1}}),t._v(" "),t.showVideoPop?n("video-pop",{attrs:{url:t.videoList[0].url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e(),t._v(" "),n("svg-icon",{staticClass:"icon-play",staticStyle:{"font-size":"30px"},attrs:{type:"video-play"},on:{click:function(e){t.showVideoPop=!0}}}),t._v(" "),n("svg-icon",{staticClass:"icon-delete",staticStyle:{"font-size":"22px"},attrs:{type:"delete-red"},on:{click:t.handleVideoRemove}}),t._v(" "),n("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.videoList[0].videoPercent<1,expression:"videoList[0].videoPercent < 1"}],staticClass:"progress",attrs:{percentage:100*t.videoList[0].videoPercent,color:"#25A9F6","show-text":!1}})],1):t._e(),t._v(" "),n("el-upload",{directives:[{name:"show",rawName:"v-show",value:!t.videoList[0],expression:"!videoList[0]"}],ref:"upload",staticClass:"image-upload",attrs:{"list-type":"picture-card",accept:t.typesLimit,action:"","auto-upload":!1,limit:1,disabled:t.videoList.length>0,"on-change":t.addVideo,"on-error":t.handleError}},[n("i",{staticClass:"el-icon-plus"})])],1)}),[],!1,null,"7ceac8bb",null);e.default=component.exports;installComponents(component,{VideoPop:n(744).default,SvgIcon:n(60).default})},838:function(t,e,n){"use strict";n.r(e);var o=n(85),r=n(732),l={name:"QaCaller",mixins:[n.n(r).a],data:function(){return{preQaUsers:{loading:!0,list:[]},currentQaUsers:{loading:!0,list:[]},nextQaUsers:{loading:!0,list:[]},preTimerId:null,nextTimerId:null,qaFriendsLoading:!1,selectedFriend:{},searchList:[],searchValue:"",searchTotal:10,loading:!1,setTimeoutId:null,pageLimit:10,pageNumber:1,pageLimitPagination:10,pageNumberPagination:1,totalPage:""}},computed:{noMore:function(){return!(!this.searchValue||this.loading)&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.initUserList()},methods:{initUserList:function(){1===this.pageNumberPagination?(this.getUserList(this.pageNumberPagination,this.currentQaUsers),this.getUserList(this.pageNumberPagination+1,this.nextQaUsers)):this.pageNumberPagination===(this.totalPage||10)?(this.getUserList(this.pageNumberPagination-1,this.preQaUsers),this.getUserList(this.pageNumberPagination+1,this.currentQaUsers)):(this.getUserList(this.pageNumberPagination-1,this.preQaUsers),this.getUserList(this.pageNumberPagination,this.currentQaUsers),this.getUserList(this.pageNumberPagination+1,this.nextQaUsers))},getUserList:function(t,e){var n=this;if(!(e.list.length>0)){e.loading=!0;var r={"filter[canBeAsked]":"yes","page[limit]":this.pageLimitPagination,"page[number]":t};return this.$store.dispatch("jv/get",["/users",{params:r}]).then((function(data){var meta=data._jv.json.meta;n.totalPage=meta.pageCount,e.loading=!1,e.list=Object(o.a)(data)}),(function(t){return n.handleError(t)}))}},prePage:function(){var t=this;this.pageNumberPagination<=1||(this.$refs.currentQaUser.classList.add("transfer-right"),this.$refs.preQaUser.classList.add("transfer-right"),setTimeout((function(){t.$refs.currentQaUser.classList.remove("transfer-right"),t.$refs.preQaUser.classList.remove("transfer-right"),t.nextQaUsers=t.currentQaUsers,t.currentQaUsers=t.preQaUsers,t.preQaUsers={loading:!0,list:[]}}),300),this.pageNumberPagination-=1,this.preTimerId&&window.clearTimeout(this.preTimerId),this.preTimerId=setTimeout((function(){t.preTimerId=null,t.initUserList()}),310))},nextPage:function(){var t=this;this.pageNumberPagination>=this.totalPage||(this.$refs.currentQaUser.classList.add("transfer-left"),this.$refs.nextQaUser.classList.add("transfer-left"),setTimeout((function(){t.$refs.currentQaUser.classList.remove("transfer-left"),t.$refs.nextQaUser.classList.remove("transfer-left"),t.preQaUsers=t.currentQaUsers,t.currentQaUsers=t.nextQaUsers,t.nextQaUsers={loading:!0,list:[]}}),300),this.pageNumberPagination+=1,this.nextTimerId&&window.clearTimeout(this.nextTimerId),this.nextTimerId=setTimeout((function(){t.initUserList(),t.nextTimerId=null}),310))},searchUser:function(t){var e=this;this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue&&(this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getSearchList(),e.setTimeoutId=null}),300))},getSearchList:function(){var t=this,e={"filter[username]":"*".concat(this.searchValue,"*"),"filter[status]":"normal","page[limit]":this.pageLimit,"page[number]":this.pageNumber,"filter[canBeAsked]":"yes"};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(o.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchValue&&this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getSearchList())},selectFriendFromUl:function(t){this.selectedFriend=t,this.clear()},clear:function(){this.$refs.inputCaller.value="",this.searchValue="",this.searchList=[]}}},c=(n(821),n(12)),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("post.callAnswer"),overflow:"visible"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"container-selectedCaller"},[n("div",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.selectedFriend).length>0,expression:"Object.keys(selectedFriend).length > 0"}],staticClass:"selectedCaller"},[n("span",[t._v("@ "+t._s(t.selectedFriend.username))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){t.selectedFriend={}}}})],1)]),t._v(" "),n("div",{staticClass:"tip"},[t._v(t._s(t.$t("post.searchFriendsCanBeAsd")))]),t._v(" "),n("div",{staticClass:"container-search-list"},[n("label",[n("input",{ref:"inputCaller",staticClass:"input-caller",attrs:{placeholder:t.$t("post.pleaseInput"),type:"text"},on:{input:t.searchUser}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},t._l(t.searchList,(function(e,o){return n("li",{key:o,class:{"infinite-list-item":!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){return t.selectFriendFromUl(e)}}},[t._v("\n            "+t._s(e.username)+"\n          ")])})),0),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e(),t._v(" "),t.noMore?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.noMoreData")))]):t._e()])]),t._v(" "),n("div",{staticClass:"friends"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.recommendAnswer")))]),t._v(" "),n("div",{staticClass:"container-user-list"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.preQaUsers.loading,expression:"preQaUsers.loading"}],ref:"preQaUser",staticClass:"container-caller prePage"},t._l(t.preQaUsers.list,(function(e,o){return n("div",{key:o,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.currentQaUsers.loading,expression:"currentQaUsers.loading"}],ref:"currentQaUser",staticClass:"container-caller currentPage"},t._l(t.currentQaUsers.list,(function(e,o){return n("div",{key:o,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.nextQaUsers.loading,expression:"nextQaUsers.loading"}],ref:"nextQaUser",staticClass:"container-caller nextPage"},t._l(t.nextQaUsers.list,(function(e,o){return n("div",{key:o,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0)]),t._v(" "),t.totalPage?n("div",{staticClass:"container-pagination"},[n("div",{staticClass:"pagination"},[n("svg-icon",{class:{"page-button":!0,"pre-button":!0,disabled:t.pageNumberPagination<=1},attrs:{type:"drop-down"},on:{click:t.prePage}}),t._v(" "),n("span",[t._v(t._s(t.pageNumberPagination))]),t._v(" "),n("svg-icon",{class:{"page-button":!0,"next-button":!0,disabled:t.pageNumberPagination>=t.totalPage},attrs:{type:"drop-down"},on:{click:t.nextPage}})],1)]):t._e()])]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("el-button",{attrs:{disabled:0===Object.keys(t.selectedFriend).length,size:"medium",type:"primary"},on:{click:function(e){return t.$emit("selectedQaCaller",t.selectedFriend)}}},[t._v(t._s(t.$t("post.confirmChoice")))])],1)])])}),[],!1,null,"2aeea87a",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default,Avatar:n(268).default,MessageBox:n(747).default})},839:function(t,e,n){"use strict";n.r(e);n(11),n(720);var o=n(732),r={name:"ProductDialog",mixins:[n.n(o).a],data:function(){return{supportedType:[{icon:"product-jd",text:this.$t("post.jd")},{icon:"product-taobao",text:this.$t("post.taobao")},{icon:"product-tmall",text:this.$t("post.tmall")},{icon:"product-pinduoduo",text:this.$t("post.pinduoduo")},{icon:"product-youzan",text:this.$t("post.youzan")}],link:"",loading:!1}},computed:{},mounted:function(){},methods:{handleLink:function(){var t=this;if(this.link){this.loading=!0;var e={_jv:{type:"goods/analysis"},type:"analysis",address:this.link};this.$store.dispatch("jv/post",e).then((function(e){e&&e._jv&&(t.link="",t.$emit("inputedLink",e))}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))}else this.$message.error(this.$t("post.goodsLinkEmpty"))}}},l=(n(823),n(12)),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"message-box-product",attrs:{title:t.$t("post.addProduct"),overflow:"visible",width:"620px"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"tips"},[t._v(t._s(t.$t("post.supportedLink")))]),t._v(" "),n("div",{staticClass:"supported-type"},t._l(t.supportedType,(function(e,o){return n("div",{key:o,staticClass:"item"},[n("svg-icon",{staticClass:"icon",attrs:{type:e.icon}}),t._v(t._s(e.text)+"\n      ")],1)})),0),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.link,expression:"link"}],staticClass:"input-link",attrs:{placeholder:t.$t("post.goodsLink")},domProps:{value:t.link},on:{input:function(e){e.target.composing||(t.link=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.handleLink}},[t._v(t._s(t.$t("discuzq.ok")))]),t._v(" "),n("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.$t("post.cancel")))])],1)])])}),[],!1,null,"1173780e",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default,MessageBox:n(747).default})},840:function(t,e,n){"use strict";n.r(e);var o={name:"Popover",props:{visible:{type:Boolean,default:!1}}},r=(n(830),n(12)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-popover",{attrs:{placement:"bottom","min-width":"150",value:t.visible,trigger:"manual","popper-class":"popover"},on:{hide:function(e){return t.$emit("hide-pop")}}},[t._t("pop"),t._v(" "),n("template",{slot:"reference"},[t._t("activeNode")],2)],2)],1)}),[],!1,null,null,null);e.default=component.exports},841:function(t,e,n){t.exports=function(){"use strict";var t="millisecond",e="second",n="minute",o="hour",i="day",s="week",u="month",a="quarter",r="year",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,c=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(t,e,n){var o=String(t);return!o||o.length>=e?t:""+Array(e+1-o.length).join(n)+t},h={s:d,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),o=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+d(o,2,"0")+":"+d(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var o=12*(n.year()-e.year())+(n.month()-e.month()),i=e.add(o,u),s=n-i<0,a=e.add(o+(s?-1:1),u);return+(-(o+(n-i)/(s?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(l){return{M:u,y:r,w:s,d:i,D:"date",h:o,m:n,s:e,ms:t,Q:a}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m="en",v={};v[m]=f;var _=function(t){return t instanceof C},y=function(t,e,n){var o;if(!t)return m;if("string"==typeof t)v[t]&&(o=t),e&&(v[t]=e,o=t);else{var i=t.name;v[i]=t,o=i}return!n&&o&&(m=o),o||!n&&m},g=function(t,e){if(_(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new C(n)},w=h;w.l=y,w.i=_,w.w=function(t,e){return g(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var C=function(){function d(t){this.$L=this.$L||y(t.locale,null,!0),this.parse(t)}var h=d.prototype;return h.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var o=e.match(l);if(o){var i=o[2]-1||0;return n?new Date(Date.UTC(o[1],i,o[3]||1,o[4]||0,o[5]||0,o[6]||0,o[7]||0)):new Date(o[1],i,o[3]||1,o[4]||0,o[5]||0,o[6]||0,o[7]||0)}}return new Date(e)}(t),this.init()},h.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},h.$utils=function(){return w},h.isValid=function(){return!("Invalid Date"===this.$d.toString())},h.isSame=function(t,e){var n=g(t);return this.startOf(e)<=n&&n<=this.endOf(e)},h.isAfter=function(t,e){return g(t)<this.startOf(e)},h.isBefore=function(t,e){return this.endOf(e)<g(t)},h.$g=function(t,e,n){return w.u(t)?this[e]:this.set(n,t)},h.year=function(t){return this.$g(t,"$y",r)},h.month=function(t){return this.$g(t,"$M",u)},h.day=function(t){return this.$g(t,"$W",i)},h.date=function(t){return this.$g(t,"$D","date")},h.hour=function(t){return this.$g(t,"$H",o)},h.minute=function(t){return this.$g(t,"$m",n)},h.second=function(t){return this.$g(t,"$s",e)},h.millisecond=function(e){return this.$g(e,"$ms",t)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(t,a){var l=this,c=!!w.u(a)||a,d=w.p(t),h=function(t,e){var n=w.w(l.$u?Date.UTC(l.$y,e,t):new Date(l.$y,e,t),l);return c?n:n.endOf(i)},f=function(t,e){return w.w(l.toDate()[t].apply(l.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(e)),l)},m=this.$W,v=this.$M,_=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case r:return c?h(1,0):h(31,11);case u:return c?h(1,v):h(0,v+1);case s:var g=this.$locale().weekStart||0,C=(m<g?m+7:m)-g;return h(c?_-C:_+(6-C),v);case i:case"date":return f(y+"Hours",0);case o:return f(y+"Minutes",1);case n:return f(y+"Seconds",2);case e:return f(y+"Milliseconds",3);default:return this.clone()}},h.endOf=function(t){return this.startOf(t,!1)},h.$set=function(s,a){var l,c=w.p(s),d="set"+(this.$u?"UTC":""),h=(l={},l.day=d+"Date",l.date=d+"Date",l[u]=d+"Month",l[r]=d+"FullYear",l[o]=d+"Hours",l[n]=d+"Minutes",l[e]=d+"Seconds",l[t]=d+"Milliseconds",l)[c],f=c===i?this.$D+(a-this.$W):a;if(c===u||c===r){var m=this.clone().set("date",1);m.$d[h](f),m.init(),this.$d=m.set("date",Math.min(this.$D,m.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},h.set=function(t,e){return this.clone().$set(t,e)},h.get=function(t){return this[w.p(t)]()},h.add=function(t,a){var l,c=this;t=Number(t);var d=w.p(a),h=function(e){var n=g(c);return w.w(n.date(n.date()+Math.round(e*t)),c)};if(d===u)return this.set(u,this.$M+t);if(d===r)return this.set(r,this.$y+t);if(d===i)return h(1);if(d===s)return h(7);var f=(l={},l[n]=6e4,l[o]=36e5,l[e]=1e3,l)[d]||1,m=this.$d.getTime()+t*f;return w.w(m,this)},h.subtract=function(t,e){return this.add(-1*t,e)},h.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=w.z(this),i=this.$locale(),s=this.$H,u=this.$m,a=this.$M,r=i.weekdays,l=i.months,d=function(t,o,i,s){return t&&(t[o]||t(e,n))||i[o].substr(0,s)},h=function(t){return w.s(s%12||12,t,"0")},f=i.meridiem||function(t,e,n){var o=t<12?"AM":"PM";return n?o.toLowerCase():o},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:w.s(a+1,2,"0"),MMM:d(i.monthsShort,a,l,3),MMMM:d(l,a),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:d(i.weekdaysMin,this.$W,r,2),ddd:d(i.weekdaysShort,this.$W,r,3),dddd:r[this.$W],H:String(s),HH:w.s(s,2,"0"),h:h(1),hh:h(2),a:f(s,u,!0),A:f(s,u,!1),m:String(u),mm:w.s(u,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:o};return n.replace(c,(function(t,e){return e||m[t]||o.replace(":","")}))},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(t,l,c){var d,h=w.p(l),f=g(t),m=6e4*(f.utcOffset()-this.utcOffset()),v=this-f,_=w.m(this,f);return _=(d={},d[r]=_/12,d[u]=_,d[a]=_/3,d[s]=(v-m)/6048e5,d.day=(v-m)/864e5,d[o]=v/36e5,d[n]=v/6e4,d[e]=v/1e3,d)[h]||v,c?_:w.a(_)},h.daysInMonth=function(){return this.endOf(u).$D},h.$locale=function(){return v[this.$L]},h.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),o=y(t,e,!0);return o&&(n.$L=o),n},h.clone=function(){return w.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},d}();return g.prototype=C.prototype,g.extend=function(t,e){return t(e,C,g),g},g.locale=y,g.isDayjs=_,g.unix=function(t){return g(1e3*t)},g.en=v[m],g.Ls=v,g}()},842:function(t,e,n){"use strict";n.r(e);n(267);var o={name:"Loading",props:{loading:{type:Boolean,default:!1},fontSize:{type:Number,default:32}}},r=(n(843),n(12)),component=Object(r.a)(o,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"loading-container"},[this._v("\n  "+this._s(this.$t("discuzq.list.loading"))+"...\n")])}),[],!1,null,"88032c6c",null);e.default=component.exports},843:function(t,e,n){"use strict";var o=n(789);n.n(o).a},844:function(t,e,n){"use strict";var o=n(790);n.n(o).a},858:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(27),n(841)),l=n.n(r),c=n(732),d={name:"ChatBox",mixins:[n.n(c).a],props:{dialog:{type:Object,default:function(){}}},data:function(){return{recordList:[],recordTotal:0,pageLimit:10,pollId:"",loading:!1,onChatPublish:!1,chatContent:{text:"",imageList:[],attachedList:[]},chatType:{type:10,textLimit:450,showPayment:!1,showTitle:!1,showImage:!1,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!1,placeholder:"请输入 ..."},loadMoreMessage:!1}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")},noMore:function(){return this.recordList.length===this.recordTotal}},watch:{dialog:{handler:function(t){var e=this;this.loading=!0,t.id&&t.name?this.getChatRecord(t.id).then((function(){e.loading=!1,e.$nextTick((function(){e.$refs.chatContent.scrollTop=e.$refs.chatContent.scrollHeight}))})):this.loading=!1},deep:!0,immediate:!0}},mounted:function(){this.activePolling(),this.scrollListener()},beforeDestroy:function(){window.clearInterval(this.pollId)},methods:{scrollListener:function(){var t=this;this.$refs.chatContent.addEventListener("scroll",(function(e){if(0===e.target.scrollTop){if(t.loadMoreMessage)return;t.loadMoreMessage=!0,t.pageLimit+=10,t.getChatRecord(t.dialog.id)}}))},activePolling:function(){var t=this;this.pollId=window.setInterval((function(){t.dialog.id&&t.getChatRecord(t.dialog.id)}),1500)},getChatRecord:function(t){var e=this,n={"filter[dialog_id]":t,include:"user,user.groups","page[number]":1,"page[limit]":this.pageLimit,sort:"-createdAt"};return this.$store.dispatch("jv/get",["dialog/message",{params:n}]).then((function(t){var n=t._jv.json.meta.total;e.recordList=Object(o.a)(t).reverse(),e.onChatPublish=!1,e.recordTotal===n||e.loadMoreMessage||e.$nextTick((function(){e.$refs.chatContent.scrollTop=e.$refs.chatContent.scrollHeight})),e.loadMoreMessage=!1,e.recordTotal=n}),(function(t){return e.handleError(t)}))},formatDate:function(t){return l()(new Date(t)).format("YYYY-MM-DD HH:mm")},postMessage:function(){var t=this,e={_jv:{type:"dialog/message"},dialog_id:this.dialog.id,message_text:this.chatContent.text};this.$store.dispatch("jv/post",e).then((function(){t.getChatRecord(t.dialog.id),t.chatContent.text=""}),(function(e){t.onChatPublish=!1,t.handleError(e)}))},createDialogAndPost:function(){var t=this,e={_jv:{type:"dialog"},recipient_username:this.dialog.name,message_text:this.chatContent.text};this.$store.dispatch("jv/post",e).then((function(e){t.getChatRecord(e._jv.id),t.chatContent.text=""}),(function(e){t.onChatPublish=!1,t.handleError(e)}))},chatPublish:function(){return this.chatContent.text?this.chatContent.text.length>450?this.$message.warning(this.$t("chat.messageLengthCannotOver")):void(this.onChatPublish||(this.onChatPublish=!0,this.dialog.id?this.postMessage():this.createDialogAndPost())):this.$message.warning(this.$t("chat.messageCannotBeBlack"))}}},h=(n(844),n(12)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-box"},[n("div",{staticClass:"header"},[n("span",{staticClass:"name"},[t._v(t._s(t.dialog.name))]),t._v(" "),n("span",[t._v(t._s(t.$t("chat.chatWithYou")))]),t._v(" "),n("svg-icon",{staticClass:"icon-close",staticStyle:{"font-size":"16px",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"chatContent",staticClass:"chat-content",attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[t.loadMoreMessage?n("div",{staticClass:"load-tip"},[t._v("\n      "+t._s(t.noMore?t.$t("chat.noMore"):t.$t("chat.loadRecord"))+"\n    ")]):t._e(),t._v(" "),t._l(t.recordList,(function(e,o){return n("div",{key:o,staticClass:"record"},[e.user_id===parseInt(t.userId)?n("div",{staticClass:"record-item mine"},[n("div",{staticClass:"message"},[n("div",{staticClass:"message-box",domProps:{innerHTML:t._s(t.$xss(e.message_text_html))}}),t._v(" "),n("div",{staticClass:"created-at"},[t._v(t._s(t.formatDate(e.updated_at)))])]),t._v(" "),n("Avatar",{attrs:{user:e.user,size:50}})],1):n("div",{staticClass:"record-item his"},[n("Avatar",{attrs:{user:e.user,size:50}}),t._v(" "),n("div",{staticClass:"message"},[n("div",{staticClass:"message-box"},[n("div",{staticClass:"message-box",domProps:{innerHTML:t._s(t.$xss(e.message_text_html))}})]),t._v(" "),n("div",{staticClass:"created-at"},[t._v(t._s(t.formatDate(e.updated_at)))])])],1)])}))],2),t._v(" "),n("editor",{staticClass:"chat-editor",attrs:{"editor-style":"chat",selector:"chat-editor","type-information":t.chatType,post:t.chatContent,"on-publish":t.onChatPublish},on:{"update:post":function(e){t.chatContent=e},publish:t.chatPublish}}),t._v(" "),n("Cover")],1)}),[],!1,null,"14e50ace",null);e.default=component.exports;installComponents(component,{SvgIcon:n(60).default,Avatar:n(268).default,Editor:n(799).default,Cover:n(737).default})},952:function(t,e,n){},953:function(t,e,n){},954:function(t,e,n){},955:function(t,e,n){},956:function(t,e,n){},957:function(t,e,n){}}]);